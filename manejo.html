<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>R para Ciencias Sociales</title>
  <meta name="description" content="Análisis de datos con R, con aplicación a las ciencias sociales">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="R para Ciencias Sociales" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Análisis de datos con R, con aplicación a las ciencias sociales" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R para Ciencias Sociales" />
  
  <meta name="twitter:description" content="Análisis de datos con R, con aplicación a las ciencias sociales" />
  

<meta name="author" content="Martín Paladino">


<meta name="date" content="2018-08-10">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="investigacion-reproducible-.html">
<link rel="next" href="graficos.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<script src="libs/d3-3.3.8/d3.min.js"></script>
<script src="libs/dagre-0.4.0/dagre-d3.min.js"></script>
<link href="libs/mermaid-0.3.0/dist/mermaid.css" rel="stylesheet" />
<script src="libs/mermaid-0.3.0/dist/mermaid.slim.min.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/chromatography-0.1/chromatography.js"></script>
<script src="libs/DiagrammeR-binding-1.0.0/DiagrammeR.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R para ciencias sociales</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preámbulo</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#para-quien-es-este-libro"><i class="fa fa-check"></i><b>0.1</b> ¿Para quién es este libro?</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#el-tidyverse"><i class="fa fa-check"></i><b>0.2</b> El <code>tidyverse</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="introduccion.html"><a href="introduccion.html"><i class="fa fa-check"></i>Introducción</a><ul>
<li class="chapter" data-level="0.3" data-path="introduccion.html"><a href="introduccion.html#que-es-r"><i class="fa fa-check"></i><b>0.3</b> ¿Qué es R?</a><ul>
<li class="chapter" data-level="0.3.1" data-path="introduccion.html"><a href="introduccion.html#el-lenguaje-de-programacion-r"><i class="fa fa-check"></i><b>0.3.1</b> El <em>lenguaje de programación R</em></a></li>
<li class="chapter" data-level="0.3.2" data-path="introduccion.html"><a href="introduccion.html#el-interprete"><i class="fa fa-check"></i><b>0.3.2</b> El <em>intérprete</em></a></li>
</ul></li>
<li class="chapter" data-level="0.4" data-path="introduccion.html"><a href="introduccion.html#instalacion-de-r-y-rstudio-en-windows."><i class="fa fa-check"></i><b>0.4</b> Instalación de R y Rstudio en Windows.</a></li>
<li class="chapter" data-level="0.5" data-path="introduccion.html"><a href="introduccion.html#interface-de-rstudio."><i class="fa fa-check"></i><b>0.5</b> Interface de Rstudio.</a><ul>
<li class="chapter" data-level="0.5.1" data-path="introduccion.html"><a href="introduccion.html#consola."><i class="fa fa-check"></i><b>0.5.1</b> Consola.</a></li>
<li class="chapter" data-level="0.5.2" data-path="introduccion.html"><a href="introduccion.html#editor-de-archivos."><i class="fa fa-check"></i><b>0.5.2</b> Editor de Archivos.</a></li>
<li class="chapter" data-level="0.5.3" data-path="introduccion.html"><a href="introduccion.html#entorno-de-trabajo."><i class="fa fa-check"></i><b>0.5.3</b> Entorno de trabajo.</a></li>
<li class="chapter" data-level="0.5.4" data-path="introduccion.html"><a href="introduccion.html#graficos."><i class="fa fa-check"></i><b>0.5.4</b> Gráficos.</a></li>
<li class="chapter" data-level="0.5.5" data-path="introduccion.html"><a href="introduccion.html#ayuda."><i class="fa fa-check"></i><b>0.5.5</b> Ayuda.</a></li>
<li class="chapter" data-level="0.5.6" data-path="introduccion.html"><a href="introduccion.html#paquetes-de-extension."><i class="fa fa-check"></i><b>0.5.6</b> Paquetes de extensión.</a></li>
</ul></li>
<li class="chapter" data-level="0.6" data-path="introduccion.html"><a href="introduccion.html#tipos-y-estructuras-de-datos"><i class="fa fa-check"></i><b>0.6</b> Tipos y estructuras de datos</a><ul>
<li class="chapter" data-level="0.6.1" data-path="introduccion.html"><a href="introduccion.html#tipos-de-datos"><i class="fa fa-check"></i><b>0.6.1</b> Tipos de datos</a></li>
<li class="chapter" data-level="0.6.2" data-path="introduccion.html"><a href="introduccion.html#estructuras-de-datos."><i class="fa fa-check"></i><b>0.6.2</b> Estructuras de datos.</a></li>
</ul></li>
<li class="chapter" data-level="0.7" data-path="introduccion.html"><a href="introduccion.html#orientacion-a-objetos."><i class="fa fa-check"></i><b>0.7</b> Orientación a objetos.</a></li>
<li class="chapter" data-level="0.8" data-path="introduccion.html"><a href="introduccion.html#programacion-funcional."><i class="fa fa-check"></i><b>0.8</b> Programación funcional.</a></li>
<li class="chapter" data-level="0.9" data-path="introduccion.html"><a href="introduccion.html#vocabulario."><i class="fa fa-check"></i><b>0.9</b> Vocabulario.</a></li>
<li class="chapter" data-level="0.10" data-path="introduccion.html"><a href="introduccion.html#funciones-y-librerias-de-funciones."><i class="fa fa-check"></i><b>0.10</b> Funciones y librerías de funciones.</a></li>
<li class="chapter" data-level="0.11" data-path="introduccion.html"><a href="introduccion.html#convenciones-de-estilo-de-este-documento."><i class="fa fa-check"></i><b>0.11</b> Convenciones de estilo de este documento.</a></li>
<li class="chapter" data-level="0.12" data-path="introduccion.html"><a href="introduccion.html#bloques-de-codigo-y-comentarios."><i class="fa fa-check"></i><b>0.12</b> Bloques de código y comentarios.</a></li>
<li class="chapter" data-level="0.13" data-path="introduccion.html"><a href="introduccion.html#uso-de-mayusculas."><i class="fa fa-check"></i><b>0.13</b> Uso de mayúsculas.</a></li>
<li class="chapter" data-level="0.14" data-path="introduccion.html"><a href="introduccion.html#sobre-el-estilo-de-programacion-en-r."><i class="fa fa-check"></i><b>0.14</b> Sobre el estilo de programación en R.</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="primeros.html"><a href="primeros.html"><i class="fa fa-check"></i><b>1</b> Primeros pasos en R</a><ul>
<li class="chapter" data-level="1.1" data-path="primeros.html"><a href="primeros.html#crear-un-proyecto."><i class="fa fa-check"></i><b>1.1</b> Crear un proyecto.</a></li>
<li class="chapter" data-level="1.2" data-path="primeros.html"><a href="primeros.html#sintaxis-de-r-operadores-y-operandos."><i class="fa fa-check"></i><b>1.2</b> Sintaxis de R: operadores y operandos.</a></li>
<li class="chapter" data-level="1.3" data-path="primeros.html"><a href="primeros.html#sintaxis-de-r-funciones-y-argumentos."><i class="fa fa-check"></i><b>1.3</b> Sintaxis de R: funciones y argumentos.</a></li>
<li class="chapter" data-level="1.4" data-path="primeros.html"><a href="primeros.html#vectores-y-atributos-de-los-vectores."><i class="fa fa-check"></i><b>1.4</b> Vectores y atributos de los vectores.</a></li>
<li class="chapter" data-level="1.5" data-path="primeros.html"><a href="primeros.html#manipulacion-de-datos."><i class="fa fa-check"></i><b>1.5</b> Manipulación de datos.</a></li>
<li class="chapter" data-level="1.6" data-path="primeros.html"><a href="primeros.html#funcion-para-calcular-una-mediana-con-funciones-primitivas-de-r."><i class="fa fa-check"></i><b>1.6</b> Función para calcular una mediana con funciones primitivas de R.</a></li>
<li class="chapter" data-level="1.7" data-path="primeros.html"><a href="primeros.html#manipulacion-de-estructuras-de-datos."><i class="fa fa-check"></i><b>1.7</b> Manipulación de estructuras de datos.</a><ul>
<li class="chapter" data-level="1.7.1" data-path="primeros.html"><a href="primeros.html#magia"><i class="fa fa-check"></i><b>1.7.1</b> Magia</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="primeros.html"><a href="primeros.html#sobre-los-archivos-de-sintaxis."><i class="fa fa-check"></i><b>1.8</b> Sobre los archivos de sintaxis.</a></li>
<li class="chapter" data-level="1.9" data-path="primeros.html"><a href="primeros.html#anexo"><i class="fa fa-check"></i><b>1.9</b> Anexo</a><ul>
<li class="chapter" data-level="1.9.1" data-path="primeros.html"><a href="primeros.html#operadores-binarios-de-r"><i class="fa fa-check"></i><b>1.9.1</b> Operadores binarios de R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="investigacion-reproducible-.html"><a href="investigacion-reproducible-.html"><i class="fa fa-check"></i><b>2</b> Investigación reproducible.</a><ul>
<li class="chapter" data-level="2.1" data-path="investigacion-reproducible-.html"><a href="investigacion-reproducible-.html#introduccion-alcances-del-problema."><i class="fa fa-check"></i><b>2.1</b> Introducción: alcances del problema.</a></li>
<li class="chapter" data-level="2.2" data-path="investigacion-reproducible-.html"><a href="investigacion-reproducible-.html#investigacion-reproducible.-1"><i class="fa fa-check"></i><b>2.2</b> Investigación reproducible.</a><ul>
<li class="chapter" data-level="2.2.1" data-path="investigacion-reproducible-.html"><a href="investigacion-reproducible-.html#ventajas-de-la-investigacion-reproducible."><i class="fa fa-check"></i><b>2.2.1</b> Ventajas de la investigación reproducible.</a></li>
<li class="chapter" data-level="2.2.2" data-path="investigacion-reproducible-.html"><a href="investigacion-reproducible-.html#desafios-de-la-investigacion-reproducible."><i class="fa fa-check"></i><b>2.2.2</b> Desafíos de la investigación reproducible.</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="investigacion-reproducible-.html"><a href="investigacion-reproducible-.html#filosofia-programacion-funcional-con-inmutabilidad-de-datos-transparencia-referencial-y-funciones-puras."><i class="fa fa-check"></i><b>2.3</b> Filosofía: programación funcional con inmutabilidad de datos, transparencia referencial y funciones puras.</a></li>
<li class="chapter" data-level="2.4" data-path="investigacion-reproducible-.html"><a href="investigacion-reproducible-.html#hagamos-pizza-en-r."><i class="fa fa-check"></i><b>2.4</b> Hagamos pizza en R.</a><ul>
<li class="chapter" data-level="2.4.1" data-path="investigacion-reproducible-.html"><a href="investigacion-reproducible-.html#pizzeria-el-asignador.-pizzas-de-hoy-y-de-ayer."><i class="fa fa-check"></i><b>2.4.1</b> Pizzería “El asignador”. Pizzas de hoy y de ayer.</a></li>
<li class="chapter" data-level="2.4.2" data-path="investigacion-reproducible-.html"><a href="investigacion-reproducible-.html#pizzeria-la-funcional-clasica.-el-cambio-se-lo-da-en-parentesis."><i class="fa fa-check"></i><b>2.4.2</b> Pizzería La funcional clásica. El cambio se lo da en paréntesis.</a></li>
<li class="chapter" data-level="2.4.3" data-path="investigacion-reproducible-.html"><a href="investigacion-reproducible-.html#pizzeria-magrittr-la-mas-del-rumbo"><i class="fa fa-check"></i><b>2.4.3</b> Pizzería magrittr ¡La más %&gt;% del rumbo!</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="manejo.html"><a href="manejo.html"><i class="fa fa-check"></i><b>3</b> Manejo da datos</a><ul>
<li class="chapter" data-level="3.1" data-path="manejo.html"><a href="manejo.html#el-objeto-de-este-documento."><i class="fa fa-check"></i><b>3.1</b> El objeto de este documento.</a></li>
<li class="chapter" data-level="3.2" data-path="manejo.html"><a href="manejo.html#manipulacion-de-datos-con-tidyverse"><i class="fa fa-check"></i><b>3.2</b> Manipulación de datos con <code>tidyverse::</code></a></li>
<li class="chapter" data-level="3.3" data-path="manejo.html"><a href="manejo.html#la-forma-de-los-datos."><i class="fa fa-check"></i><b>3.3</b> La forma de los datos.</a><ul>
<li class="chapter" data-level="3.3.1" data-path="manejo.html"><a href="manejo.html#sumarios-de-datos-o-base-de-datos"><i class="fa fa-check"></i><b>3.3.1</b> ¿Sumarios de datos o base de datos?</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="manejo.html"><a href="manejo.html#datos-rectangulares."><i class="fa fa-check"></i><b>3.4</b> Datos rectangulares.</a><ul>
<li class="chapter" data-level="3.4.1" data-path="manejo.html"><a href="manejo.html#datos-prolijos-tidy-data"><i class="fa fa-check"></i><b>3.4.1</b> Datos prolijos (tidy data)</a></li>
<li class="chapter" data-level="3.4.2" data-path="manejo.html"><a href="manejo.html#reformateo-de-datos."><i class="fa fa-check"></i><b>3.4.2</b> Reformateo de datos.</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="manejo.html"><a href="manejo.html#manejo-de-datos-con-dplyr"><i class="fa fa-check"></i><b>3.5</b> Manejo de datos con <code>dplyr::</code></a><ul>
<li class="chapter" data-level="3.5.1" data-path="manejo.html"><a href="manejo.html#verbos-basicos-de-dplyr"><i class="fa fa-check"></i><b>3.5.1</b> Verbos básicos de <code>dplyr::</code></a></li>
<li class="chapter" data-level="3.5.2" data-path="manejo.html"><a href="manejo.html#uso-de-la-de-sintaxis-de-dplyr"><i class="fa fa-check"></i><b>3.5.2</b> Uso de la de sintaxis de <code>dplyr::</code></a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="manejo.html"><a href="manejo.html#uso-avanzado-de-dplyr"><i class="fa fa-check"></i><b>3.6</b> Uso avanzado de <code>dplyr::</code></a><ul>
<li class="chapter" data-level="3.6.1" data-path="manejo.html"><a href="manejo.html#alternar-entre-formato-largo-y-ancho."><i class="fa fa-check"></i><b>3.6.1</b> Alternar entre formato largo y ancho.</a></li>
<li class="chapter" data-level="3.6.2" data-path="manejo.html"><a href="manejo.html#seleccionar-las-columnas-que-cumplen-determinada-condicion."><i class="fa fa-check"></i><b>3.6.2</b> Seleccionar las columnas que cumplen determinada condición.</a></li>
<li class="chapter" data-level="3.6.3" data-path="manejo.html"><a href="manejo.html#filtrar-por-mas-de-una-condicion-o-dentro-de-un-conjunto."><i class="fa fa-check"></i><b>3.6.3</b> Filtrar por más de una condición o dentro de un conjunto.</a></li>
<li class="chapter" data-level="3.6.4" data-path="manejo.html"><a href="manejo.html#transformacion-avanzada-de-datos."><i class="fa fa-check"></i><b>3.6.4</b> Transformacion avanzada de datos.</a></li>
<li class="chapter" data-level="3.6.5" data-path="manejo.html"><a href="manejo.html#sumarios-avanzados."><i class="fa fa-check"></i><b>3.6.5</b> Sumarios avanzados.</a></li>
<li class="chapter" data-level="3.6.6" data-path="manejo.html"><a href="manejo.html#funciones-avanzadas-de-combinacion-de-bases-de-datos."><i class="fa fa-check"></i><b>3.6.6</b> Funciones avanzadas de combinación de bases de datos.</a></li>
<li class="chapter" data-level="3.6.7" data-path="manejo.html"><a href="manejo.html#operadores-avanzados-de-magrittr"><i class="fa fa-check"></i><b>3.6.7</b> Operadores avanzados de <code>magrittr::</code></a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="manejo.html"><a href="manejo.html#limites-de-dplyr"><i class="fa fa-check"></i><b>3.7</b> Límites de <code>dplyr::</code></a></li>
<li class="chapter" data-level="3.8" data-path="manejo.html"><a href="manejo.html#manipulacion-con-dplyren-la-practica.-flujo-de-trabajo."><i class="fa fa-check"></i><b>3.8</b> Manipulación con <code>dplyr::</code>en la práctica. Flujo de trabajo.</a><ul>
<li class="chapter" data-level="3.8.1" data-path="manejo.html"><a href="manejo.html#implementacion-en-dplyr-de-un-analisis-exploratorio-de-la-base-de-datos-indice-de-marginacion-del-conapo."><i class="fa fa-check"></i><b>3.8.1</b> Implementación en dplyr:: de un análisis exploratorio de la base de datos Índice de marginación del CONAPO.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="graficos.html"><a href="graficos.html"><i class="fa fa-check"></i><b>4</b> Gráficos con R y ggplot</a><ul>
<li class="chapter" data-level="4.1" data-path="graficos.html"><a href="graficos.html#acerca-de-este-documento."><i class="fa fa-check"></i><b>4.1</b> Acerca de este documento.</a></li>
<li class="chapter" data-level="4.2" data-path="graficos.html"><a href="graficos.html#la-gramatica-de-los-graficos."><i class="fa fa-check"></i><b>4.2</b> La gramática de los gráficos.</a><ul>
<li class="chapter" data-level="4.2.1" data-path="graficos.html"><a href="graficos.html#filosofia."><i class="fa fa-check"></i><b>4.2.1</b> Filosofía.</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="graficos.html"><a href="graficos.html#la-gramatica-de-los-graficos-aplicada-en-ggplot."><i class="fa fa-check"></i><b>4.3</b> La gramática de los gráficos aplicada en <code>ggplot()</code>.</a></li>
<li class="chapter" data-level="4.4" data-path="graficos.html"><a href="graficos.html#la-base-de-datos."><i class="fa fa-check"></i><b>4.4</b> La base de datos.</a><ul>
<li class="chapter" data-level="4.4.1" data-path="graficos.html"><a href="graficos.html#indice-de-marginacion-por-municipios-1990-2015."><i class="fa fa-check"></i><b>4.4.1</b> Índice de marginación por municipios 1990-2015.</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="graficos.html"><a href="graficos.html#descripcion-rapida-de-la-base-de-datos."><i class="fa fa-check"></i><b>4.5</b> Descripción rápida de la base de datos.</a><ul>
<li class="chapter" data-level="4.5.1" data-path="graficos.html"><a href="graficos.html#nombres-cortos-y-largos."><i class="fa fa-check"></i><b>4.5.1</b> Nombres cortos y largos.</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="graficos.html"><a href="graficos.html#grafico-basico."><i class="fa fa-check"></i><b>4.6</b> Gráfico básico.</a><ul>
<li class="chapter" data-level="4.6.1" data-path="graficos.html"><a href="graficos.html#construccion-de-un-grafico-de-barras-paso-a-paso."><i class="fa fa-check"></i><b>4.6.1</b> Construcción de un gráfico de barras paso a paso.</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="graficos.html"><a href="graficos.html#personalizacion-de-grafico."><i class="fa fa-check"></i><b>4.7</b> Personalización de gráfico.</a><ul>
<li class="chapter" data-level="4.7.1" data-path="graficos.html"><a href="graficos.html#orden-manual-de-las-categorias."><i class="fa fa-check"></i><b>4.7.1</b> Orden manual de las categorías.</a></li>
<li class="chapter" data-level="4.7.2" data-path="graficos.html"><a href="graficos.html#orden-automatico-de-categorias."><i class="fa fa-check"></i><b>4.7.2</b> Orden automático de categorías.</a></li>
<li class="chapter" data-level="4.7.3" data-path="graficos.html"><a href="graficos.html#titulo-subtitulo-titulos-de-ejes-vineta"><i class="fa fa-check"></i><b>4.7.3</b> Título, subtítulo, títulos de ejes, viñeta</a></li>
<li class="chapter" data-level="4.7.4" data-path="graficos.html"><a href="graficos.html#estilos-visuales."><i class="fa fa-check"></i><b>4.7.4</b> Estilos visuales.</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="graficos.html"><a href="graficos.html#graficos-intermedios-mas-de-una-serie-de-datos"><i class="fa fa-check"></i><b>4.8</b> Gráficos intermedios (más de una serie de datos)</a><ul>
<li class="chapter" data-level="4.8.1" data-path="graficos.html"><a href="graficos.html#datos-formato-de-datos-largo-y-ancho."><i class="fa fa-check"></i><b>4.8.1</b> Datos Formato de datos largo y ancho.</a></li>
<li class="chapter" data-level="4.8.2" data-path="graficos.html"><a href="graficos.html#grafico-de-barras-lado-a-lado."><i class="fa fa-check"></i><b>4.8.2</b> Gráfico de barras lado a lado.</a></li>
<li class="chapter" data-level="4.8.3" data-path="graficos.html"><a href="graficos.html#graficos-multipanel."><i class="fa fa-check"></i><b>4.8.3</b> Gráficos multipanel.</a></li>
<li class="chapter" data-level="4.8.4" data-path="graficos.html"><a href="graficos.html#grafico-de-punto."><i class="fa fa-check"></i><b>4.8.4</b> Gráfico de punto.</a></li>
<li class="chapter" data-level="4.8.5" data-path="graficos.html"><a href="graficos.html#grafico-de-punto-y-linea."><i class="fa fa-check"></i><b>4.8.5</b> Gráfico de punto y línea.</a></li>
<li class="chapter" data-level="4.8.6" data-path="graficos.html"><a href="graficos.html#grafico-de-dispersion."><i class="fa fa-check"></i><b>4.8.6</b> Gráfico de dispersión.</a></li>
<li class="chapter" data-level="4.8.7" data-path="graficos.html"><a href="graficos.html#grafico-de-dispersion-en-paneles."><i class="fa fa-check"></i><b>4.8.7</b> Gráfico de dispersión en paneles.</a></li>
<li class="chapter" data-level="4.8.8" data-path="graficos.html"><a href="graficos.html#grafico-de-caja."><i class="fa fa-check"></i><b>4.8.8</b> Gráfico de caja.</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="graficos.html"><a href="graficos.html#personalizacion-avanzada-de-graficos."><i class="fa fa-check"></i><b>4.9</b> Personalización avanzada de gráficos.</a><ul>
<li class="chapter" data-level="4.9.1" data-path="graficos.html"><a href="graficos.html#etiquetas-y-elementos-de-texto."><i class="fa fa-check"></i><b>4.9.1</b> Etiquetas y elementos de texto.</a></li>
<li class="chapter" data-level="4.9.2" data-path="graficos.html"><a href="graficos.html#ajuste-del-elemento-texto."><i class="fa fa-check"></i><b>4.9.2</b> Ajuste del elemento texto.</a></li>
<li class="chapter" data-level="4.9.3" data-path="graficos.html"><a href="graficos.html#posicion-de-las-leyendas."><i class="fa fa-check"></i><b>4.9.3</b> Posición de las leyendas.</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="graficos.html"><a href="graficos.html#escalas."><i class="fa fa-check"></i><b>4.10</b> Escalas.</a><ul>
<li class="chapter" data-level="4.10.1" data-path="graficos.html"><a href="graficos.html#escalas-y-sistemas-de-coordenadas"><i class="fa fa-check"></i><b>4.10.1</b> Escalas y sistemas de coordenadas</a></li>
<li class="chapter" data-level="4.10.2" data-path="graficos.html"><a href="graficos.html#ajuste-manual-de-intervalos-de-escala."><i class="fa fa-check"></i><b>4.10.2</b> Ajuste manual de intervalos de escala.</a></li>
<li class="chapter" data-level="4.10.3" data-path="graficos.html"><a href="graficos.html#transformacion-de-escalas"><i class="fa fa-check"></i><b>4.10.3</b> Transformación de escalas</a></li>
</ul></li>
<li class="chapter" data-level="4.11" data-path="graficos.html"><a href="graficos.html#sistemas-de-coordenadas."><i class="fa fa-check"></i><b>4.11</b> Sistemas de coordenadas.</a><ul>
<li class="chapter" data-level="4.11.1" data-path="graficos.html"><a href="graficos.html#coordenadas-polares."><i class="fa fa-check"></i><b>4.11.1</b> Coordenadas polares.</a></li>
</ul></li>
<li class="chapter" data-level="4.12" data-path="graficos.html"><a href="graficos.html#fortificar-nuestros-graficos-con-datos-de-un-modelo"><i class="fa fa-check"></i><b>4.12</b> Fortificar nuestros gráficos con datos de un modelo</a><ul>
<li class="chapter" data-level="4.12.1" data-path="graficos.html"><a href="graficos.html#rectas-de-ajuste"><i class="fa fa-check"></i><b>4.12.1</b> Rectas de ajuste</a></li>
<li class="chapter" data-level="4.12.2" data-path="graficos.html"><a href="graficos.html#intervalos-de-confianza-y-barras-de-error."><i class="fa fa-check"></i><b>4.12.2</b> Intervalos de confianza y barras de error.</a></li>
<li class="chapter" data-level="4.12.3" data-path="graficos.html"><a href="graficos.html#etiquetado-de-casos."><i class="fa fa-check"></i><b>4.12.3</b> Etiquetado de casos.</a></li>
</ul></li>
<li class="chapter" data-level="4.13" data-path="graficos.html"><a href="graficos.html#extensiones-a-ggplot2"><i class="fa fa-check"></i><b>4.13</b> Extensiones a <code>ggplot2::</code></a></li>
<li class="chapter" data-level="4.14" data-path="graficos.html"><a href="graficos.html#etiquetas"><i class="fa fa-check"></i><b>4.14</b> Etiquetas</a><ul>
<li class="chapter" data-level="4.14.1" data-path="graficos.html"><a href="graficos.html#grafico-de-dispersion-con-histogramas-marginales."><i class="fa fa-check"></i><b>4.14.1</b> Gráfico de dispersión con histogramas marginales.</a></li>
<li class="chapter" data-level="4.14.2" data-path="graficos.html"><a href="graficos.html#graficos-de-proporciones-jerarquicas."><i class="fa fa-check"></i><b>4.14.2</b> Gráficos de proporciones jerárquicas.</a></li>
<li class="chapter" data-level="4.14.3" data-path="graficos.html"><a href="graficos.html#im-feeling-lucky"><i class="fa fa-check"></i><b>4.14.3</b> I’m feeling lucky…</a></li>
<li class="chapter" data-level="4.14.4" data-path="graficos.html"><a href="graficos.html#relaciones-multivariadas."><i class="fa fa-check"></i><b>4.14.4</b> Relaciones multivariadas.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html"><i class="fa fa-check"></i><b>5</b> Análisis de datos categóricos</a><ul>
<li class="chapter" data-level="5.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#introduccion-1"><i class="fa fa-check"></i><b>5.1</b> Introducción</a><ul>
<li class="chapter" data-level="5.1.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#datos-categoricos"><i class="fa fa-check"></i><b>5.1.1</b> Datos categóricos</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#tablas"><i class="fa fa-check"></i><b>5.2</b> Tablas</a><ul>
<li class="chapter" data-level="5.2.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#tablas-de-contingencia-de-dos-dimensiones."><i class="fa fa-check"></i><b>5.2.1</b> Tablas de contingencia de dos dimensiones.</a></li>
<li class="chapter" data-level="5.2.2" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#tablas-de-contingencia-en-r."><i class="fa fa-check"></i><b>5.2.2</b> Tablas de contingencia en R.</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#prueba-de-hipotesis-de-independencia-estadistica-para-tablas-de-contingencia."><i class="fa fa-check"></i><b>5.3</b> Prueba de hipótesis de independencia estadística para tablas de contingencia.</a><ul>
<li class="chapter" data-level="5.3.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#el-modelo-de-independencia."><i class="fa fa-check"></i><b>5.3.1</b> El modelo de independencia.</a></li>
<li class="chapter" data-level="5.3.2" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#prueba-de-independencia-para-una-tabla-bidimensional."><i class="fa fa-check"></i><b>5.3.2</b> Prueba de independencia para una tabla bidimensional.</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#analisis-de-los-residuos."><i class="fa fa-check"></i><b>5.4</b> Análisis de los residuos.</a><ul>
<li class="chapter" data-level="5.4.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#prueba-chi2-en-r."><i class="fa fa-check"></i><b>5.4.1</b> Prueba <span class="math inline">\(\chi\)</span><sup>2</sup> en R.</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#metodos-graficos-para-tablas-de-contingencia."><i class="fa fa-check"></i><b>5.5</b> Métodos gráficos para tablas de contingencia.</a><ul>
<li class="chapter" data-level="5.5.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#modelos-loglineales-para-datos-categoricos."><i class="fa fa-check"></i><b>5.5.1</b> Modelos loglineales para datos categóricos.</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#analisis-practico-de-datos-categoricos."><i class="fa fa-check"></i><b>5.6</b> Análisis práctico de datos categóricos.</a><ul>
<li class="chapter" data-level="5.6.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#la-base-de-datos.-1"><i class="fa fa-check"></i><b>5.6.1</b> La base de datos.</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#genero-y-partido-politico."><i class="fa fa-check"></i><b>5.7</b> Género y partido político.</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="lineales.html"><a href="lineales.html"><i class="fa fa-check"></i><b>6</b> Modelos lineales</a><ul>
<li class="chapter" data-level="6.1" data-path="lineales.html"><a href="lineales.html#introduccion-2"><i class="fa fa-check"></i><b>6.1</b> Introducción</a></li>
<li class="chapter" data-level="6.2" data-path="lineales.html"><a href="lineales.html#ajuste-de-modelo-lineales-con-lm"><i class="fa fa-check"></i><b>6.2</b> Ajuste de modelo lineales con <code>lm()</code></a><ul>
<li class="chapter" data-level="6.2.1" data-path="lineales.html"><a href="lineales.html#sumario-de-un-modelo."><i class="fa fa-check"></i><b>6.2.1</b> Sumario de un modelo.</a></li>
<li class="chapter" data-level="6.2.2" data-path="lineales.html"><a href="lineales.html#interpretacion-basica-del-sumario-de-un-modelo."><i class="fa fa-check"></i><b>6.2.2</b> Interpretación básica del sumario de un modelo.</a></li>
<li class="chapter" data-level="6.2.3" data-path="lineales.html"><a href="lineales.html#intervalos-de-confianza."><i class="fa fa-check"></i><b>6.2.3</b> Intervalos de confianza.</a></li>
<li class="chapter" data-level="6.2.4" data-path="lineales.html"><a href="lineales.html#valores-estimados-y-residuos."><i class="fa fa-check"></i><b>6.2.4</b> Valores estimados y residuos.</a></li>
<li class="chapter" data-level="6.2.5" data-path="lineales.html"><a href="lineales.html#prediccion-del-modelo."><i class="fa fa-check"></i><b>6.2.5</b> Predicción del modelo.</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="lineales.html"><a href="lineales.html#modelos-lineales-con-mas-de-una-variable-independiente."><i class="fa fa-check"></i><b>6.3</b> Modelos lineales con más de una variable independiente.</a><ul>
<li class="chapter" data-level="6.3.1" data-path="lineales.html"><a href="lineales.html#exploracion-de-datos-multivariados."><i class="fa fa-check"></i><b>6.3.1</b> Exploración de datos multivariados.</a></li>
<li class="chapter" data-level="6.3.2" data-path="lineales.html"><a href="lineales.html#especificacion-de-modelos-con-multiples-variables-independientes."><i class="fa fa-check"></i><b>6.3.2</b> Especificación de modelos con múltiples variables independientes.</a></li>
<li class="chapter" data-level="6.3.3" data-path="lineales.html"><a href="lineales.html#comparar-modelos-lineales-multiples."><i class="fa fa-check"></i><b>6.3.3</b> Comparar modelos lineales múltiples.</a></li>
<li class="chapter" data-level="6.3.4" data-path="lineales.html"><a href="lineales.html#imprimir-un-sumario-de-varios-modelos."><i class="fa fa-check"></i><b>6.3.4</b> Imprimir un sumario de varios modelos.</a></li>
<li class="chapter" data-level="6.3.5" data-path="lineales.html"><a href="lineales.html#imprimir-un-sumario-formateado-de-varios-modelos."><i class="fa fa-check"></i><b>6.3.5</b> Imprimir un sumario formateado de varios modelos.</a></li>
<li class="chapter" data-level="6.3.6" data-path="lineales.html"><a href="lineales.html#anova-de-varios-modelos."><i class="fa fa-check"></i><b>6.3.6</b> ANOVA de varios modelos.</a></li>
<li class="chapter" data-level="6.3.7" data-path="lineales.html"><a href="lineales.html#criterio-de-informacion-de-akaike."><i class="fa fa-check"></i><b>6.3.7</b> Criterio de información de Akaike.</a></li>
<li class="chapter" data-level="6.3.8" data-path="lineales.html"><a href="lineales.html#modelos-lineales-con-variables-independientes-categoricas."><i class="fa fa-check"></i><b>6.3.8</b> Modelos lineales con variables independientes categóricas.</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="lineales.html"><a href="lineales.html#supuestos-de-un-modelo-lineal."><i class="fa fa-check"></i><b>6.4</b> Supuestos de un modelo lineal.</a><ul>
<li class="chapter" data-level="6.4.1" data-path="lineales.html"><a href="lineales.html#normalidad."><i class="fa fa-check"></i><b>6.4.1</b> Normalidad.</a></li>
<li class="chapter" data-level="6.4.2" data-path="lineales.html"><a href="lineales.html#independencia."><i class="fa fa-check"></i><b>6.4.2</b> Independencia.</a></li>
<li class="chapter" data-level="6.4.3" data-path="lineales.html"><a href="lineales.html#linealidad."><i class="fa fa-check"></i><b>6.4.3</b> Linealidad.</a></li>
<li class="chapter" data-level="6.4.4" data-path="lineales.html"><a href="lineales.html#homocedasticidad."><i class="fa fa-check"></i><b>6.4.4</b> Homocedasticidad.</a></li>
<li class="chapter" data-level="6.4.5" data-path="lineales.html"><a href="lineales.html#casos-atipicos."><i class="fa fa-check"></i><b>6.4.5</b> Casos atípicos.</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="lineales.html"><a href="lineales.html#regresion-robusta."><i class="fa fa-check"></i><b>6.5</b> Regresión robusta.</a></li>
<li class="chapter" data-level="6.6" data-path="lineales.html"><a href="lineales.html#supuestos-de-los-modelos-lineales-problemas-y-soluciones."><i class="fa fa-check"></i><b>6.6</b> Supuestos de los modelos lineales: problemas y soluciones.</a></li>
<li class="chapter" data-level="6.7" data-path="lineales.html"><a href="lineales.html#funciones-adicionales-para-modelos-lineales."><i class="fa fa-check"></i><b>6.7</b> Funciones adicionales para modelos lineales.</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="generalizados.html"><a href="generalizados.html"><i class="fa fa-check"></i><b>7</b> Modelos lineales generalizados</a><ul>
<li class="chapter" data-level="7.1" data-path="generalizados.html"><a href="generalizados.html#introduccion."><i class="fa fa-check"></i><b>7.1</b> Introducción.</a></li>
<li class="chapter" data-level="7.2" data-path="generalizados.html"><a href="generalizados.html#ajuste-de-modelos-logit-con-glm"><i class="fa fa-check"></i><b>7.2</b> Ajuste de modelos logit con <code>glm()</code></a><ul>
<li class="chapter" data-level="7.2.1" data-path="generalizados.html"><a href="generalizados.html#presentacion-de-los-datos."><i class="fa fa-check"></i><b>7.2.1</b> Presentación de los datos.</a></li>
<li class="chapter" data-level="7.2.2" data-path="generalizados.html"><a href="generalizados.html#un-modelo-lineal-con-glm"><i class="fa fa-check"></i><b>7.2.2</b> Un modelo lineal con <code>glm()</code></a></li>
<li class="chapter" data-level="7.2.3" data-path="generalizados.html"><a href="generalizados.html#la-ordenada-al-origen-de-un-modelo-logit."><i class="fa fa-check"></i><b>7.2.3</b> La ordenada al origen de un modelo logit.</a></li>
<li class="chapter" data-level="7.2.4" data-path="generalizados.html"><a href="generalizados.html#estimacion-de-beta_1"><i class="fa fa-check"></i><b>7.2.4</b> Estimación de <span class="math inline">\(\beta_1\)</span></a></li>
<li class="chapter" data-level="7.2.5" data-path="generalizados.html"><a href="generalizados.html#modelo-logit-con-dos-variables-independientes."><i class="fa fa-check"></i><b>7.2.5</b> Modelo logit con dos variables independientes.</a></li>
<li class="chapter" data-level="7.2.6" data-path="generalizados.html"><a href="generalizados.html#modelo-logit-con-multiples-variables-dependientes."><i class="fa fa-check"></i><b>7.2.6</b> Modelo logit con múltiples variables dependientes.</a></li>
<li class="chapter" data-level="7.2.7" data-path="generalizados.html"><a href="generalizados.html#pruebas-de-significancia."><i class="fa fa-check"></i><b>7.2.7</b> Pruebas de significancia.</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="generalizados.html"><a href="generalizados.html#presentacion-de-resultados."><i class="fa fa-check"></i><b>7.3</b> Presentación de resultados.</a><ul>
<li class="chapter" data-level="7.3.1" data-path="generalizados.html"><a href="generalizados.html#intervalos-de-confianza.-1"><i class="fa fa-check"></i><b>7.3.1</b> Intervalos de confianza.</a></li>
<li class="chapter" data-level="7.3.2" data-path="generalizados.html"><a href="generalizados.html#grafico-de-coeficientes."><i class="fa fa-check"></i><b>7.3.2</b> Gráfico de coeficientes.</a></li>
<li class="chapter" data-level="7.3.3" data-path="generalizados.html"><a href="generalizados.html#tabla-y-grafico-de-efectos-totales-promedio."><i class="fa fa-check"></i><b>7.3.3</b> Tabla y gráfico de efectos totales promedio.</a></li>
<li class="chapter" data-level="7.3.4" data-path="generalizados.html"><a href="generalizados.html#sumario-de-efectos-marginales."><i class="fa fa-check"></i><b>7.3.4</b> Sumario de efectos marginales.</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="generalizados.html"><a href="generalizados.html#modelos-ligit-multinomiales."><i class="fa fa-check"></i><b>7.4</b> Modelos ligit multinomiales.</a><ul>
<li class="chapter" data-level="7.4.1" data-path="generalizados.html"><a href="generalizados.html#ajuste-de-modelos-logit-multinomiales-com-multinom"><i class="fa fa-check"></i><b>7.4.1</b> Ajuste de modelos logit multinomiales com <code>multinom()</code></a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="generalizados.html"><a href="generalizados.html#anexo-i.-probabilidades-y-razones-de-probabilidad."><i class="fa fa-check"></i><b>7.5</b> Anexo I. Probabilidades y razones de probabilidad.</a></li>
<li class="chapter" data-level="7.6" data-path="generalizados.html"><a href="generalizados.html#anexo-ii.-asterisco-sobre-los-asteriscos."><i class="fa fa-check"></i><b>7.6</b> Anexo II. Asterisco sobre los asteriscos.</a></li>
<li class="chapter" data-level="7.7" data-path="generalizados.html"><a href="generalizados.html#anexo-iii.-tipos-de-variables-independiente-y-modelo-lineal-apropiado."><i class="fa fa-check"></i><b>7.7</b> Anexo III. Tipos de variables independiente y modelo lineal apropiado.</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="martinpaladino.github.com" target="blank">Martín Paladino</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R para Ciencias Sociales</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="manejo" class="section level1">
<h1><span class="header-section-number">Capítulo 3</span> Manejo da datos</h1>
<blockquote>
<p>Functional programming combines the flexibility and power of abstract mathematics with the intuitive clarity of abstract mathematics. <a href="https://xkcd.com/1270/">Randall Munroe</a></p>
</blockquote>
<div id="el-objeto-de-este-documento." class="section level2">
<h2><span class="header-section-number">3.1</span> El objeto de este documento.</h2>
<p>La manipulación de datos es una de las actividades que más tiempo insumen en la investigación cuantitiva. Manipular datos implica darles la forma necesaria o aplicarles las transformaciones que nos permiten analizarlos del modo en queremos. Este documento se limita a un sólo ámbito de la manipulación que podríamos dar el nombre de transformación. Otros dos ámbitos deben ser tenidos en cuenta: la adquisición de datos y su limpieza, que serán cubiertos en sendas guías. La <em>adquisición</em> es forzozamente previa a cualquier manipulación, sin algún tipo de datos no tenemos nada que manipular. En R podemos adquirir datos de diversas formas: capturándolos directamente en nuestra consola, importándolos desde archivos en diversos formatos o extrayéndolos desde fuentes en línea.<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a> La limpieza de datos puede hacerse de manera simultanea con la manipulación, pero hacerlo previamente facilita muchísimo la manipulación.<br />
Para analizar datos es necesario disponer de ellos en nuestro entorno de trabajo R y dotarlos de una estructura que comprendamos tanto nosotros como las funciones de R que utilizaremos. Como veremos, en términos técnicos esto significa que trataremos siempre manejarlos como una estructura de la clase <code>data.frame</code> y en formato tidy o <em>prolijo</em>. Esos también deben estar limpios, es decir, estar claramente especificados en su tipo, codificados de manera consistente y libre ambigüedades. En términos prácticos eso significa que las columnas tendrán nombres claros y comprensibles<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a> y especificado el tipo de datos que contienen –numérico, factor, caracter, fecha, etc-; que el conjunto de datos estará libre de ambigüedades de codificación y errores, incluídos los ortográficos y que los casos perdidos estarán explícitamente señalados como valores <code>NA</code>. La tranformación de datos será mucho más fluida si trabajamos con conjunto de datos limpio, en este sentido de la palabra.
Transformar los datos no significa en modo alguno alterarlos, significa estrictamente cambiarles <em>la forma</em>: modificar su estructura, pero no la información que contienen. Es muy probable que una transformación implique también pérdida de información, pero a cambio obtendremos beneficios de inteligibilidad.</p>
<p>En apretada síntesis la manipulación de datos se resume en cuatro operaciones:</p>
<ul>
<li>Extraer subconjuntos de datos. Ya sea subconjuntos de filas o columnas. En los casos prácticos nunca haremos un análisis sobre la totalidad de los datos.</li>
<li>Transformarlos. Realizar operaciones aritméticas o lógicas sobre los datos. En general cuando una variable es contínua realizamos operaciones aritméticas, cuando es categórica, lógicas.</li>
<li>Obtener sumarios del conjunto de los datos o por grupos. Con frecuencia el análisis no se hace sobre todos los datos sino sobre medidas sumarias: conteos, medias, desviaciones estandar.
-Unirlos con otros datos. La proliferación de bases de datos hace cada vez más útil combinar múltiples fuentes para enriquecer el análisis.</li>
</ul>
<p>Este documento se basea en un paradigma de trabajo –la programación funcional basada en la inmutabilidad de los datos y la transparencia referencial–, un conjunto de herramientas disponibles en R –reunidas en las librerías <code>tidyr::</code> y <code>dplyr::</code> entre otras– y un formato preferido para datos –tidy data– compatible con ese paradigma y herramientas. Con estos tres pilares podermos llevar a cabo las operaciones resumidas previamente.</p>
</div>
<div id="manipulacion-de-datos-con-tidyverse" class="section level2">
<h2><span class="header-section-number">3.2</span> Manipulación de datos con <code>tidyverse::</code></h2>
<p>Las tareas de operaciones de manipulación de datos que hemos mencionado pueden llevarse a cabo de distintas maneras. La librería <code>base::</code> de R contiene operadores y funciones para hacerlo, por ejemplo <code>[,]</code> para extraer subconjuntos, <code>subset()</code> para operaciones agrupadas, <code>merge()</code>, <code>cbind()</code> o <code>rbind()</code> para combinar múltiples fuentes de datos. A pesar de ser funciones sumamente flexibles y aplicables a múltiples estructuras de datos no son las más convenientes. Están pensadas para usarlas en en un paradigma procedimental, más que con uno funcional, además generan un código dificil de leer y nos obligan a repetir los nombres de las estructuras de datos en cada llamada.
La librería <code>dplyr::</code> ofrece un conjunto unificado de herramientas de manipulación de datos que induce a la programación funcional, produce código legible cuya comprensión es intuitiva y, al estar implementada en lenguaje C, ofrece tiempos de ejecución muy cortos.
El conjunto de herramientas de <code>dplyr::</code> funciona exclusivamente con la estructura de datos <code>data.frame</code>. Esta estrutcuta no es tan rápida como una matríz para operaciones aritméticas ni tan flexibles como una lista, pero es mucho más fácil de manejar: las columnas son las variables y las filas las observaciones. Una ventaja aún mayor es que un data.frame siempre es un data.frame. Es mucho más fácil organizar los procesos si sabemos exactamente qué entra y qué sale. Las funciones de <code>dplyr::</code> sólo admiten como imput un data.frame y siempre producen como output un data.frame o un mensaje de error. Esta estabilidad de estructura hace que nuestro código se comporte de una forma predecible y los datos nunca pierdan sus atributos. El output de las funciones es completamente predecible y podemos pasarlo con confianza como input de la siguiente, sin tener que registrarle un nombre en el entorno.
Las capacidades de <code>dplyr::</code> están ampliadas por algunas librerías cómplices. Una importante es <code>magrittr::</code>, que introduce a R el operador binario <code>%&gt;%</code>,<a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a> una tubería a la que leemos en voz alta como “después”. Con <code>%&gt;%</code> enlazamos los pasos de la manipulación de datos de las funciones de <code>dplyr::</code> en el orden natural de ejecución. Con <code>%&gt;%</code> organizamos una secuencia de análisis que culminará en un gráfico así: <code>importar_datos %&gt;% recodificar %&gt;% hacer_conteos %&gt;% hacer_grafico</code>. Es decir, leer datos de un archivo, después recodificar esos datos, después hacer conteos sobre los datos recodificados y después graficar esos conteos.<br />
<code>dplyr::</code> importa el operador <code>%&gt;%</code> de <code>magrittr::</code>, así que lo tendremos siempre disponible. Si queremos usar los restantes operadores deberemos cargar la librería.<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a><br />
Otra librería hermana de <code>dplyr::</code> es <code>tidyr::</code>, que incluye funciones para corregir algunos errores frecuentes en bases de datos y cambiarles la estrctura. <code>tidyr::</code> además introduce el concepto <em>datos prolijos</em> o <em>tidy data</em>, una manera consistente de organizar la información contenida en estructura de la clase <code>data.frame</code> que facilita su manipulación. Ya veremos de qué se trata y por qué son importantes. Dado que <code>dplyr::</code> funciona mejor con datos que tienen cierto formato el primer paso será identificar cuál es ese formato de datos.</p>
</div>
<div id="la-forma-de-los-datos." class="section level2">
<h2><span class="header-section-number">3.3</span> La forma de los datos.</h2>
<div id="sumarios-de-datos-o-base-de-datos" class="section level3">
<h3><span class="header-section-number">3.3.1</span> ¿Sumarios de datos o base de datos?</h3>
<p>Con frecuencia los datos que encotramos en internet no son bases de datos en sentido estricto, sino sumarios o informes que condensan información. Una tabla en la que se registran cada una de las ventas de una frutería, con montos, cantidades, fecha y hora de la transacción, es una base de datos en bruto. Una tabla que resume las ventas mensuales es un sumario. Es muy probable que ese sumario se haya originado en una base de datos, pero esta o no es de acceso público o debemos seguir buscando para encontrarla.
Siempre que resulte posible trabajaremos con bases de datos tan desagregadas como nos resulte posible conseguir, ya que tienen mayor cantidad de información. Si es necesario un sumario podemos realizarlo, pero no a la inversa. Es decir, a partir de una base de datos podemos crear los sumarios, pero desde los sumarios no podemos recrear la base de datos.</p>
<table>
<caption><span id="tab:sumario">Table 3.1: </span>Base datos cruda</caption>
<thead>
<tr class="header">
<th align="left">Fecha</th>
<th align="left">Producto</th>
<th align="right">Precio</th>
<th align="right">Cantidad</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">20/02/2017</td>
<td align="left">Manzana</td>
<td align="right">10</td>
<td align="right">1.0</td>
</tr>
<tr class="even">
<td align="left">20/02/2017</td>
<td align="left">Pera</td>
<td align="right">15</td>
<td align="right">2.0</td>
</tr>
<tr class="odd">
<td align="left">21/03/2017</td>
<td align="left">Ciruela</td>
<td align="right">13</td>
<td align="right">0.5</td>
</tr>
<tr class="even">
<td align="left">22/03/2017</td>
<td align="left">Naranja</td>
<td align="right">9</td>
<td align="right">3.0</td>
</tr>
</tbody>
</table>
<table>
<caption><span id="tab:sumario">Table 3.1: </span>Sumario de datos</caption>
<thead>
<tr class="header">
<th align="left">Mes</th>
<th align="right">Ventas</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Febrero</td>
<td align="right">40.0</td>
</tr>
<tr class="even">
<td align="left">Marzo</td>
<td align="right">33.5</td>
</tr>
</tbody>
</table>
<p>En R y con <code>dplyr::</code> podemos manejar información en versión sumario, cosa que haremos cuando no podemos acceder a los datos crudos. Sin embargo como <code>dplyr::</code> funciona solamente con data.frames es necesario que esos datos tengan una estructura rectangular.</p>
</div>
</div>
<div id="datos-rectangulares." class="section level2">
<h2><span class="header-section-number">3.4</span> Datos rectangulares.</h2>
<p>Con <code>dplyr::</code> podemos manipular datos provenientes importados desde casi cualquier formato de archivo, pero si como trabajamos con la estructura data.frame es necesario que cumplan una condición: los datos deben ser rectangulares. Por <strong>rectangulares</strong> se entiende que están organizados en filas y columnas contíguas y que cada filas tiene el mismo largo que las demás, así como todas las columnas.<a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a> Cuando la intersección de una fila y una columna no tiene un dato válido debe codificarse como <code>NA</code>, not available o información perdida.</p>
<p>Es frecuente que cuando descargamos datos capturados o procesados con Excel los datos no sean rectangulares. Es un práctica tan mala como ampliamente difundida entre los usuarios de Excel usar la misma hoja para alojar los datos y el procesamiento de datos.<a href="#fn12" class="footnote-ref" id="fnref12"><sup>12</sup></a> o aprovechar la flexibilidad de esa aplicación para poner datos que corresponden a diferentes temáticas o indicadores en la misma columna. El proceso de importar esos datos mal formateados a R es penoso.</p>
<p>Veamos un ejemplo de datos no rectangulares y rectangulares.</p>
<table>
<caption><span id="tab:unnamed-chunk-45">Table 3.2: </span>Datos no rectangulares</caption>
<thead>
<tr class="header">
<th align="left">Ventas</th>
<th align="right">X__1</th>
<th align="right">X__2</th>
<th align="left">X__3</th>
<th align="right">X__4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Frutería “La desprolija”</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">Primer Trimestre</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">Manzanas</td>
<td align="right">100</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">Peras</td>
<td align="right">120</td>
<td align="right">NA</td>
<td align="left">Ventas de fruta de carozo:</td>
<td align="right">614</td>
</tr>
<tr class="odd">
<td align="left">Ciruelas</td>
<td align="right">85</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">Segundo Trimestre</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">Ventas de frutas de pepita:</td>
<td align="right">166</td>
</tr>
<tr class="odd">
<td align="left">Manzanas</td>
<td align="right">110</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">Peras</td>
<td align="right">40</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">Ciruelas</td>
<td align="right">25</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">Tercer Trimestre</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">Manzanas</td>
<td align="right">60</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">Peras</td>
<td align="right">45</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">Ciruelas</td>
<td align="right">22</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">Cuatro Trimestre</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">Manzanas</td>
<td align="right">48</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">Peras</td>
<td align="right">91</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">Ciruelas</td>
<td align="right">34</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">Ventas totales en el año:</td>
<td align="right">NA</td>
<td align="right">780</td>
<td align="left">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<table>
<caption><span id="tab:unnamed-chunk-45">Table 3.2: </span>Datos rectangulares</caption>
<thead>
<tr class="header">
<th align="left">Fruta</th>
<th align="right">Primer trimestre</th>
<th align="right">Segundo Trimestre</th>
<th align="right">Tercer Trimestre</th>
<th align="right">Cuatro Trimestre</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Manzanas</td>
<td align="right">100</td>
<td align="right">110</td>
<td align="right">60</td>
<td align="right">48</td>
</tr>
<tr class="even">
<td align="left">Peras</td>
<td align="right">120</td>
<td align="right">40</td>
<td align="right">45</td>
<td align="right">91</td>
</tr>
<tr class="odd">
<td align="left">Ciruelas</td>
<td align="right">85</td>
<td align="right">25</td>
<td align="right">22</td>
<td align="right">34</td>
</tr>
</tbody>
</table>
<p>Los datos no rectangulares fueron creados en Excel y R los fuerza a formato rectangular agregando <code>NA</code> allí donde es necesario. Sería muy dificultoso manipular esos datos desde R. Como en cada columna puede haber más de un tipo de dato (ejp. la columna 1 tiene información sobre frutas y sobre trimestres) o ninguno no hay forma de llamarlas por nombre. Si eso fuera poco un sumario de datos (ventas de frutas de carozo y pepita) comparte el espacio con datos en bruto.</p>
<p>En la estructura rectangular están solamente los datos y podemos manipularlos con facilidad. La sumatoria de la columna 2 nos da las ventas totales del primer trimestre. La sumatoria de la fila 1 las ventas anuales de Manzanas. No tiene sumarios, pero podríamos generarlos con mucha gran facilidad.</p>
<p>Si importamos datos desde Excel debemos prestar mucha atención a que estén en formato rectangular. Si el formato fuera irregular la mejor alternativa es pasarlos a formato rectangular usando el mismo Excel, antes de imporarlos a R. Cargue todos los datos, si es necesario en varias estructuras pequeñas, cada una de las cuales deberá ser rectangular. No se preocupe por los sumarios que dependan únicamente de los datos incluídos en la base o bases, con datos bien estructurados reconstruirlos lleva segundos.</p>
<p>Guarde su información en formato rectangular siempre, aún cuando no tenga planeado usar R. Antes de ingresar datos a una planilla de cálculos piense primero: ¿Qué operaciones voy a realizar sobre estos datos? ¿Cuál es la mejor forma de organizarlos?</p>
<div id="datos-prolijos-tidy-data" class="section level3">
<h3><span class="header-section-number">3.4.1</span> Datos prolijos (tidy data)</h3>
<p>Los datos prolijos son aquellos en los que se cumplen simultaneamente dos condiciones: cada columna es una variable y cada fila una observación. Quizás un ejemplo nos aclare el problema. Veamos primero un conjunto de datos que parece muy razonalbe, pero que de acuerdo con nuestra definición no está en un formato prolijo:</p>
<table>
<caption><span id="tab:messy">Table 3.3: </span>Datos desprolijos</caption>
<thead>
<tr class="header">
<th align="left">Fruta</th>
<th align="left">Indicador</th>
<th align="right">2015</th>
<th align="right">2016</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Mandarina</td>
<td align="left">Precio</td>
<td align="right">10</td>
<td align="right">12</td>
</tr>
<tr class="even">
<td align="left">Toronja</td>
<td align="left">Precio</td>
<td align="right">14</td>
<td align="right">15</td>
</tr>
</tbody>
</table>
<p>¿Por qué son desprolijos estos datos? Porque Precio no es una observación sino una variable y los años no son variables, son puntos de datos u observaciones. En formato prolijo deberíamos tener las columnas Fruta, Año y Precio, con una observación por cada año y fruta.<a href="#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a></p>
<p>En versión prolija sería así:</p>
<table>
<caption><span id="tab:tiddy">Table 3.4: </span>Datos prolijos</caption>
<thead>
<tr class="header">
<th align="left">Fruta</th>
<th align="left">Año</th>
<th align="right">Precio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Mandarina</td>
<td align="left">2015</td>
<td align="right">10</td>
</tr>
<tr class="even">
<td align="left">Mandarina</td>
<td align="left">2016</td>
<td align="right">12</td>
</tr>
<tr class="odd">
<td align="left">Toronja</td>
<td align="left">2016</td>
<td align="right">14</td>
</tr>
<tr class="even">
<td align="left">Toronja</td>
<td align="left">2016</td>
<td align="right">15</td>
</tr>
</tbody>
</table>
<p>Siempre que generemos datos –o estemos en condiciones de especificar el formato que tendrán– elegiremos datos prolijos. Si no podemos obtenerles en ese formato entonces los reformatearemos hasta llevarlos a datos prolijos. La librería <code>tidyr::</code> incluye funciones que solucionan muchos de los problemas frecuentes para pasar datos desprolijos a prolijos.</p>
</div>
<div id="reformateo-de-datos." class="section level3">
<h3><span class="header-section-number">3.4.2</span> Reformateo de datos.</h3>
<p>De ningún modo vamos a hacer ese reformateado de datos manualmente, un proceso tedioso y propenso a errores. <code>tidyr::</code> tiene la función <code>gather()</code> que se especializa en solucionar este problema.<a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a> <code>gather()</code> toma un conjunto de datos con las observaciones en las colunas, convierte a cada una de esas columnas en una clave y crea otra nueva que registra el valor correspondiente a cada. Es decir, nos regresa la versión prolija de nuestros datos.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb169-1" data-line-number="1"><span class="kw">tribble</span>(</a>
<a class="sourceLine" id="cb169-2" data-line-number="2">        <span class="op">~</span>Fruta,      <span class="op">~</span>Indicador,  <span class="op">~</span><span class="st">`</span><span class="dt">2015</span><span class="st">`</span>, <span class="op">~</span><span class="st">`</span><span class="dt">2016</span><span class="st">`</span>, </a>
<a class="sourceLine" id="cb169-3" data-line-number="3">        <span class="st">&quot;Mandarina&quot;</span>, <span class="st">&quot;Precio&quot;</span>,     <span class="dv">10</span>,     <span class="dv">12</span>,</a>
<a class="sourceLine" id="cb169-4" data-line-number="4">        <span class="st">&quot;Toronja&quot;</span>,   <span class="st">&quot;Precio&quot;</span>,     <span class="dv">14</span>,     <span class="dv">15</span> </a>
<a class="sourceLine" id="cb169-5" data-line-number="5">       ) -&gt;desprolijo      <span class="co">#Asigno el nombre desprolijo a este data.frame. </span></a>
<a class="sourceLine" id="cb169-6" data-line-number="6"><span class="kw">print</span>(desprolijo)          <span class="co">#Y lo paso a la consola con print.</span></a></code></pre></div>
<pre><code>## # A tibble: 2 x 4
##   Fruta     Indicador `2015` `2016`
##   &lt;chr&gt;     &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;
## 1 Mandarina Precio        10     12
## 2 Toronja   Precio        14     15</code></pre>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb171-1" data-line-number="1"><span class="co">#Reformateado de datos I</span></a>
<a class="sourceLine" id="cb171-2" data-line-number="2"><span class="co">#=======================</span></a>
<a class="sourceLine" id="cb171-3" data-line-number="3"></a>
<a class="sourceLine" id="cb171-4" data-line-number="4">desprolijo <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb171-5" data-line-number="5"><span class="st">  </span><span class="kw">gather</span> () <span class="co">#Paso desprolijo a gather() sin argumentos.</span></a></code></pre></div>
<pre><code>## # A tibble: 8 x 2
##   key       value    
##   &lt;chr&gt;     &lt;chr&gt;    
## 1 Fruta     Mandarina
## 2 Fruta     Toronja  
## 3 Indicador Precio   
## 4 Indicador Precio   
## 5 2015      10       
## 6 2015      14       
## 7 2016      12       
## 8 2016      15</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb173-1" data-line-number="1"><span class="co">#El resultado que obtuve no es el que busco, gather() pasó todas las columnas anterioes a filas, pero lo que buscamos es que sólo algunas columnas pasen a filas. </span></a>
<a class="sourceLine" id="cb173-2" data-line-number="2"></a>
<a class="sourceLine" id="cb173-3" data-line-number="3"><span class="co">#Reformateado de datos II</span></a>
<a class="sourceLine" id="cb173-4" data-line-number="4"><span class="co">#========================</span></a>
<a class="sourceLine" id="cb173-5" data-line-number="5"></a>
<a class="sourceLine" id="cb173-6" data-line-number="6">desprolijo <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb173-7" data-line-number="7"><span class="st">  </span><span class="kw">gather</span>(key, value,    <span class="co">#Los dos primeros argumentos son los nombres de las columnas que se crerán.</span></a>
<a class="sourceLine" id="cb173-8" data-line-number="8">         <span class="st">`</span><span class="dt">2015</span><span class="st">`</span>, <span class="st">`</span><span class="dt">2016</span><span class="st">`</span>) <span class="co">#Los siguientes las columnas que pasaremos a filas. Estos nombres de columna se repetirán en key y las filas llenarán value.  </span></a></code></pre></div>
<pre><code>## # A tibble: 4 x 4
##   Fruta     Indicador key   value
##   &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt; &lt;dbl&gt;
## 1 Mandarina Precio    2015     10
## 2 Toronja   Precio    2015     14
## 3 Mandarina Precio    2016     12
## 4 Toronja   Precio    2016     15</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb175-1" data-line-number="1"><span class="co">#Reformateado de datos III</span></a>
<a class="sourceLine" id="cb175-2" data-line-number="2"><span class="co">#=========================</span></a>
<a class="sourceLine" id="cb175-3" data-line-number="3"></a>
<a class="sourceLine" id="cb175-4" data-line-number="4">desprolijo <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb175-5" data-line-number="5"><span class="st">  </span><span class="kw">gather</span>(Año, Precio,            <span class="co">#Doy nombres útiles a key y value: quiero los años y los precios. </span></a>
<a class="sourceLine" id="cb175-6" data-line-number="6">         <span class="op">-</span>Fruta, <span class="op">-</span>Indicador) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#Especifico que columnas NO voy a pasar a filas usando &quot;-&quot;.</span></a>
<a class="sourceLine" id="cb175-7" data-line-number="7"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>Indicador)             <span class="co">#Quito la columna redundante.  </span></a></code></pre></div>
<pre><code>## # A tibble: 4 x 3
##   Fruta     Año   Precio
##   &lt;chr&gt;     &lt;chr&gt;  &lt;dbl&gt;
## 1 Mandarina 2015      10
## 2 Toronja   2015      14
## 3 Mandarina 2016      12
## 4 Toronja   2016      15</code></pre>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb177-1" data-line-number="1"><span class="co">#Crear una función ad hoc (Avanzado, no es necesario, es recomendable)</span></a>
<a class="sourceLine" id="cb177-2" data-line-number="2"><span class="co">#=====================================================================</span></a>
<a class="sourceLine" id="cb177-3" data-line-number="3"></a>
<a class="sourceLine" id="cb177-4" data-line-number="4">arreglar &lt;-<span class="st"> </span><span class="cf">function</span>(datos) {   <span class="co">#Asigno nombre a la función.</span></a>
<a class="sourceLine" id="cb177-5" data-line-number="5">  <span class="kw">select</span>(<span class="kw">gather</span>(datos, Año, Precio, <span class="op">-</span>Fruta, <span class="op">-</span>Indicador), <span class="op">-</span>Indicador)  <span class="co">#Código en ejecución.</span></a>
<a class="sourceLine" id="cb177-6" data-line-number="6">}      <span class="co">#Cierro llave de función. </span></a>
<a class="sourceLine" id="cb177-7" data-line-number="7"></a>
<a class="sourceLine" id="cb177-8" data-line-number="8"><span class="co">#Esta función ad hoc sólo sirve para estos datos u otros una estructura idéntica. Pero nos ayuda a ahorrar tiempo tipeando si tenemos que arreglar una y otra vez el mismo error. </span></a>
<a class="sourceLine" id="cb177-9" data-line-number="9"></a>
<a class="sourceLine" id="cb177-10" data-line-number="10">desprolijo <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb177-11" data-line-number="11"><span class="st">  </span><span class="kw">arreglar</span>() <span class="co">#Menos código, no me repito y expongo a errores de dedazo.</span></a></code></pre></div>
<pre><code>## # A tibble: 4 x 3
##   Fruta     Año   Precio
##   &lt;chr&gt;     &lt;chr&gt;  &lt;dbl&gt;
## 1 Mandarina 2015      10
## 2 Toronja   2015      14
## 3 Mandarina 2016      12
## 4 Toronja   2016      15</code></pre>
</div>
</div>
<div id="manejo-de-datos-con-dplyr" class="section level2">
<h2><span class="header-section-number">3.5</span> Manejo de datos con <code>dplyr::</code></h2>
<p>Con los datos cargados y en formato prolijo manipularlos con <code>dplyr()</code> es muy fácil. Quizás lo más dificil sea figurarnos el estado de los datos al que queremos llegar. Una vez que tenemos una idea clara del punto de partida y el punto de llegada debemos dividir el trayecto en pasos simples, tan simples como para ser comprensibles por R y menlazar esos pasos con el operador <code>%&gt;%</code>. Si partimos de los datos en la tabla “Datos prolijos” y queremos obtener un promedio de ventas anuales de los dos productos primero deberíamos cargar los datos, luego agruparlos por año y obtener la media por grupos e imprimirla para hacerla visible. Con dplyr lo haríamos así: <code>datos_prolijos %&gt;% group_by(Año) %&gt;% summarise(mean(Precio))</code>. Con esta simple estructura de sintaxis podemos hacer prácticamente cualquier manipulación de datos.</p>
<div id="verbos-basicos-de-dplyr" class="section level3">
<h3><span class="header-section-number">3.5.1</span> Verbos básicos de <code>dplyr::</code></h3>
<p>La manipulación de datos con <code>dplyr::</code> se basa en 5 verbos básicos.</p>
<ul>
<li><code>select()</code>, para seleccionar columnas. Si el formato es prolijo columna y variables son equivalentes.</li>
<li><code>filter()</code>, para filtrar filas de acuerdo a una o más condiciones.</li>
<li><code>group_by()</code>, para generar grupos. Admite más de un nivel de agrupamiento.</li>
<li><code>mutate()</code>, para hacer transformaciones y recodificación de variables. Regresa un resultado por fila.</li>
<li><code>summarise()</code>, para generar sumarios de variables. Regresa un resultado por variable o por cada grupo previamente definido con <code>group_by()</code>.</li>
<li>El operador <code>%&gt;%</code> nos permite encadenar operaciones. <code>%&gt;%</code> pasa el output de una función como primer argumento de la siguiente. Normalmente el primer argumento de una función son los datos, con lo que nos ahorraremos tipear una y otra vez a que datos nos referimos.</li>
</ul>
<p>A estos verbos básicos se agregan otros de uso menos frecuente, pero de gran utilidad en ciertas ocasiones.</p>
<ul>
<li><code>arrange()</code>, para ordenar resultados en orden numérico o alfabético.<br />
</li>
<li><code>recode()</code>, para recodificar variables. Se lleva muy bien con <code>mutate()</code>.</li>
<li><code>mutate_all()</code>, <code>mutate_if()</code> y <code>mutate_at()</code>, para hacer transformaciones a varias columnas de una vez. Técnicamente vectoriza una función de transformación.</li>
<li><code>spread()</code> y <code>gather()</code> para reformatear nuestra estructura de datos y pasar de formato largo a ancho y de ancho a largo. Pertenecen a <code>tidyr()</code>, una librería hermana de <code>dplyr::</code></li>
<li><code>rename()</code> para cambiar nombres de columna.</li>
<li>La familia de funciones <code>_join</code> para combinar diferentes datos en una misma estuctura. La sintaxis es algo compleja, pero tiene muchísima flexibilidad.</li>
</ul>
</div>
<div id="uso-de-la-de-sintaxis-de-dplyr" class="section level3">
<h3><span class="header-section-number">3.5.2</span> Uso de la de sintaxis de <code>dplyr::</code></h3>
<p>Repasaremos algunas funciones básicas de <code>dplyr::</code>. Produciremos intencionalmente algunos errores que aclararán el proceso.
Se presenta la sintaxis paso por paso, con la salida en consola correspondiente a cada paso. Buena parte del código es redundante, sin embargo se lo incluye como ejemplo del flujo de trabajo típico con <code>dplyr::</code> y <code>magrittr::</code>: hacemos una operación, verificamos el resultado, luego encadenamos la siguiente, verificamos y así hasta obtener el resultado esperado.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb179-1" data-line-number="1"><span class="kw">library</span>(tidyverse)               <span class="co">#Carga varias librerías, entre ellas dplyr y tidyr.</span></a>
<a class="sourceLine" id="cb179-2" data-line-number="2"><span class="co">#Crear un data.frame</span></a>
<a class="sourceLine" id="cb179-3" data-line-number="3"><span class="co">#===================</span></a>
<a class="sourceLine" id="cb179-4" data-line-number="4"><span class="kw">tribble</span>(                         <span class="co">#Creo los datos con la función tribble, muy útil por su legibilidad al organizar la entrada en columnas. </span></a>
<a class="sourceLine" id="cb179-5" data-line-number="5">  <span class="op">~</span>Col1,    <span class="op">~</span>Col2,        <span class="op">~</span>Col3, <span class="co">#Nombres de columna, se antepone ~</span></a>
<a class="sourceLine" id="cb179-6" data-line-number="6">  <span class="st">&quot;Pepita&quot;</span>, <span class="st">&quot;Manzana&quot;</span>,    <span class="dv">48</span>,    <span class="co">#Llenamos las columnas una a una. Mucha atención a las comas!!</span></a>
<a class="sourceLine" id="cb179-7" data-line-number="7">  <span class="st">&quot;Pepita&quot;</span>, <span class="st">&quot;Pera&quot;</span>   ,    <span class="dv">52</span>,</a>
<a class="sourceLine" id="cb179-8" data-line-number="8">  <span class="st">&quot;Cítrico&quot;</span>, <span class="st">&quot;Naranja&quot;</span>,   <span class="dv">12</span>, </a>
<a class="sourceLine" id="cb179-9" data-line-number="9">  <span class="st">&quot;Cítrico&quot;</span>, <span class="st">&quot;Mandarina&quot;</span>, <span class="dv">8</span>,</a>
<a class="sourceLine" id="cb179-10" data-line-number="10">  <span class="st">&quot;Carozo&quot;</span>,  <span class="st">&quot;Durazno&quot;</span>,   <span class="dv">60</span>,</a>
<a class="sourceLine" id="cb179-11" data-line-number="11">  <span class="st">&quot;Carozo&quot;</span>,  <span class="st">&quot;Ciruela&quot;</span>,   <span class="dv">55</span>     <span class="co">#En la última columna NO usamos la coma. </span></a>
<a class="sourceLine" id="cb179-12" data-line-number="12">        )                        <span class="co">#Cierro el paréntesis de la función tribble. Se genera el data.frame. Silenciosamente invoca a la función print() y saca el resultado en consola. </span></a></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   Col1    Col2       Col3
##   &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt;
## 1 Pepita  Manzana      48
## 2 Pepita  Pera         52
## 3 Cítrico Naranja      12
## 4 Cítrico Mandarina     8
## 5 Carozo  Durazno      60
## 6 Carozo  Ciruela      55</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb181-1" data-line-number="1"><span class="co">#Renombrar columnas</span></a>
<a class="sourceLine" id="cb181-2" data-line-number="2"><span class="co">#==================</span></a>
<a class="sourceLine" id="cb181-3" data-line-number="3"></a>
<a class="sourceLine" id="cb181-4" data-line-number="4"><span class="kw">tribble</span>(</a>
<a class="sourceLine" id="cb181-5" data-line-number="5">  <span class="op">~</span>Col1,    <span class="op">~</span>Col2,        <span class="op">~</span>Col3, </a>
<a class="sourceLine" id="cb181-6" data-line-number="6">  <span class="st">&quot;Pepita&quot;</span>, <span class="st">&quot;Manzana&quot;</span>,    <span class="dv">48</span>,     </a>
<a class="sourceLine" id="cb181-7" data-line-number="7">  <span class="st">&quot;Pepita&quot;</span>, <span class="st">&quot;Pera&quot;</span>   ,    <span class="dv">52</span>,</a>
<a class="sourceLine" id="cb181-8" data-line-number="8">  <span class="st">&quot;Cítrico&quot;</span>, <span class="st">&quot;Naranja&quot;</span>,   <span class="dv">12</span>, </a>
<a class="sourceLine" id="cb181-9" data-line-number="9">  <span class="st">&quot;Cítrico&quot;</span>, <span class="st">&quot;Mandarina&quot;</span>, <span class="dv">8</span>,</a>
<a class="sourceLine" id="cb181-10" data-line-number="10">  <span class="st">&quot;Carozo&quot;</span>,  <span class="st">&quot;Durazno&quot;</span>,   <span class="dv">60</span>,</a>
<a class="sourceLine" id="cb181-11" data-line-number="11">  <span class="st">&quot;Carozo&quot;</span>,  <span class="st">&quot;Ciruela&quot;</span>,   <span class="dv">55</span></a>
<a class="sourceLine" id="cb181-12" data-line-number="12">        )  <span class="op">%&gt;%</span><span class="st">                   </span><span class="co">#Paso el data.frame a la siguiente función.</span></a>
<a class="sourceLine" id="cb181-13" data-line-number="13"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">Tipo=</span>Col1,              <span class="co">#Cambio los nombres a unos más fáciles de recordar.</span></a>
<a class="sourceLine" id="cb181-14" data-line-number="14">         <span class="dt">Fruta=</span>Col2,             <span class="co">#Hago un cambio en cada línea para facilitar la legibilidad. </span></a>
<a class="sourceLine" id="cb181-15" data-line-number="15">         <span class="dt">Precio=</span>Col3) </a></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   Tipo    Fruta     Precio
##   &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt;
## 1 Pepita  Manzana       48
## 2 Pepita  Pera          52
## 3 Cítrico Naranja       12
## 4 Cítrico Mandarina      8
## 5 Carozo  Durazno       60
## 6 Carozo  Ciruela       55</code></pre>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb183-1" data-line-number="1"><span class="co">#Filtrar filas (error)</span></a>
<a class="sourceLine" id="cb183-2" data-line-number="2"><span class="co">#============================</span></a>
<a class="sourceLine" id="cb183-3" data-line-number="3"></a>
<a class="sourceLine" id="cb183-4" data-line-number="4"><span class="kw">tribble</span>(</a>
<a class="sourceLine" id="cb183-5" data-line-number="5">  <span class="op">~</span>Col1,    <span class="op">~</span>Col2,        <span class="op">~</span>Col3, </a>
<a class="sourceLine" id="cb183-6" data-line-number="6">  <span class="st">&quot;Pepita&quot;</span>, <span class="st">&quot;Manzana&quot;</span>,    <span class="dv">48</span>,     </a>
<a class="sourceLine" id="cb183-7" data-line-number="7">  <span class="st">&quot;Pepita&quot;</span>, <span class="st">&quot;Pera&quot;</span>   ,    <span class="dv">52</span>,</a>
<a class="sourceLine" id="cb183-8" data-line-number="8">  <span class="st">&quot;Cítrico&quot;</span>, <span class="st">&quot;Naranja&quot;</span>,   <span class="dv">12</span>, </a>
<a class="sourceLine" id="cb183-9" data-line-number="9">  <span class="st">&quot;Cítrico&quot;</span>, <span class="st">&quot;Mandarina&quot;</span>, <span class="dv">8</span>,</a>
<a class="sourceLine" id="cb183-10" data-line-number="10">  <span class="st">&quot;Carozo&quot;</span>,  <span class="st">&quot;Durazno&quot;</span>,   <span class="dv">60</span>,</a>
<a class="sourceLine" id="cb183-11" data-line-number="11">  <span class="st">&quot;Carozo&quot;</span>,  <span class="st">&quot;Ciruela&quot;</span>,   <span class="dv">55</span></a>
<a class="sourceLine" id="cb183-12" data-line-number="12">        )  <span class="op">%&gt;%</span><span class="st">                   </span></a>
<a class="sourceLine" id="cb183-13" data-line-number="13"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">Tipo=</span>Col1,              </a>
<a class="sourceLine" id="cb183-14" data-line-number="14">         <span class="dt">Fruta=</span>Col2,             </a>
<a class="sourceLine" id="cb183-15" data-line-number="15">         <span class="dt">Precio=</span>Col3) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb183-16" data-line-number="16"><span class="st">  </span><span class="kw">filter</span>(Col2<span class="op">==</span><span class="st">&quot;Cítrico&quot;</span>)        <span class="co">#filter() regresa un error: Col2 no existe. ¿Por qué? Porque la renombramos en el paso anterior </span></a></code></pre></div>
<pre><code>## Error in filter_impl(.data, quo): Evaluation error: objeto &#39;Col2&#39; no encontrado.</code></pre>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb185-1" data-line-number="1"><span class="co">#Filtrar filas</span></a>
<a class="sourceLine" id="cb185-2" data-line-number="2"><span class="co">#=============</span></a>
<a class="sourceLine" id="cb185-3" data-line-number="3"><span class="kw">tribble</span>(</a>
<a class="sourceLine" id="cb185-4" data-line-number="4">  <span class="op">~</span>Col1,    <span class="op">~</span>Col2,        <span class="op">~</span>Col3, </a>
<a class="sourceLine" id="cb185-5" data-line-number="5">  <span class="st">&quot;Pepita&quot;</span>, <span class="st">&quot;Manzana&quot;</span>,    <span class="dv">48</span>,     </a>
<a class="sourceLine" id="cb185-6" data-line-number="6">  <span class="st">&quot;Pepita&quot;</span>, <span class="st">&quot;Pera&quot;</span>   ,    <span class="dv">52</span>,</a>
<a class="sourceLine" id="cb185-7" data-line-number="7">  <span class="st">&quot;Cítrico&quot;</span>, <span class="st">&quot;Naranja&quot;</span>,   <span class="dv">12</span>, </a>
<a class="sourceLine" id="cb185-8" data-line-number="8">  <span class="st">&quot;Cítrico&quot;</span>, <span class="st">&quot;Mandarina&quot;</span>, <span class="dv">8</span>,</a>
<a class="sourceLine" id="cb185-9" data-line-number="9">  <span class="st">&quot;Carozo&quot;</span>,  <span class="st">&quot;Durazno&quot;</span>,   <span class="dv">60</span>,</a>
<a class="sourceLine" id="cb185-10" data-line-number="10">  <span class="st">&quot;Carozo&quot;</span>,  <span class="st">&quot;Ciruela&quot;</span>,   <span class="dv">55</span></a>
<a class="sourceLine" id="cb185-11" data-line-number="11">        )  <span class="op">%&gt;%</span><span class="st">                   </span></a>
<a class="sourceLine" id="cb185-12" data-line-number="12"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">Tipo=</span>Col1,              </a>
<a class="sourceLine" id="cb185-13" data-line-number="13">         <span class="dt">Fruta=</span>Col2,             </a>
<a class="sourceLine" id="cb185-14" data-line-number="14">         <span class="dt">Precio=</span>Col3) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb185-15" data-line-number="15"><span class="st">  </span><span class="kw">filter</span>(Tipo<span class="op">==</span><span class="st">&quot;Cítrico&quot;</span>)        <span class="co">#Conserva solamente las filas en las que Tipo es igual a &quot;Cítrico&quot; </span></a></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   Tipo    Fruta     Precio
##   &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt;
## 1 Cítrico Naranja       12
## 2 Cítrico Mandarina      8</code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb187-1" data-line-number="1"><span class="co">#Filtrado negativo.</span></a>
<a class="sourceLine" id="cb187-2" data-line-number="2"><span class="co">#==================</span></a>
<a class="sourceLine" id="cb187-3" data-line-number="3"><span class="kw">tribble</span>(</a>
<a class="sourceLine" id="cb187-4" data-line-number="4">  <span class="op">~</span>Col1,    <span class="op">~</span>Col2,        <span class="op">~</span>Col3, </a>
<a class="sourceLine" id="cb187-5" data-line-number="5">  <span class="st">&quot;Pepita&quot;</span>, <span class="st">&quot;Manzana&quot;</span>,    <span class="dv">48</span>,     </a>
<a class="sourceLine" id="cb187-6" data-line-number="6">  <span class="st">&quot;Pepita&quot;</span>, <span class="st">&quot;Pera&quot;</span>   ,    <span class="dv">52</span>,</a>
<a class="sourceLine" id="cb187-7" data-line-number="7">  <span class="st">&quot;Cítrico&quot;</span>, <span class="st">&quot;Naranja&quot;</span>,   <span class="dv">12</span>, </a>
<a class="sourceLine" id="cb187-8" data-line-number="8">  <span class="st">&quot;Cítrico&quot;</span>, <span class="st">&quot;Mandarina&quot;</span>, <span class="dv">8</span>,</a>
<a class="sourceLine" id="cb187-9" data-line-number="9">  <span class="st">&quot;Carozo&quot;</span>,  <span class="st">&quot;Durazno&quot;</span>,   <span class="dv">60</span>,</a>
<a class="sourceLine" id="cb187-10" data-line-number="10">  <span class="st">&quot;Carozo&quot;</span>,  <span class="st">&quot;Ciruela&quot;</span>,   <span class="dv">55</span></a>
<a class="sourceLine" id="cb187-11" data-line-number="11">        )  <span class="op">%&gt;%</span><span class="st">                   </span></a>
<a class="sourceLine" id="cb187-12" data-line-number="12"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">Tipo=</span>Col1,              </a>
<a class="sourceLine" id="cb187-13" data-line-number="13">         <span class="dt">Fruta=</span>Col2,             </a>
<a class="sourceLine" id="cb187-14" data-line-number="14">         <span class="dt">Precio=</span>Col3) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb187-15" data-line-number="15"><span class="st">  </span><span class="kw">filter</span>(Tipo<span class="op">!=</span><span class="st">&quot;Cítrico&quot;</span>)    <span class="co">#Usando != conserva solamente las filas en las que Tipo NO es igual a &quot;Cítrico&quot;</span></a></code></pre></div>
<pre><code>## # A tibble: 4 x 3
##   Tipo   Fruta   Precio
##   &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt;
## 1 Pepita Manzana     48
## 2 Pepita Pera        52
## 3 Carozo Durazno     60
## 4 Carozo Ciruela     55</code></pre>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb189-1" data-line-number="1"><span class="co">#Filtrado para datos númericos.</span></a>
<a class="sourceLine" id="cb189-2" data-line-number="2"><span class="co">#==============================</span></a>
<a class="sourceLine" id="cb189-3" data-line-number="3"></a>
<a class="sourceLine" id="cb189-4" data-line-number="4"><span class="kw">tribble</span>(</a>
<a class="sourceLine" id="cb189-5" data-line-number="5">  <span class="op">~</span>Col1,    <span class="op">~</span>Col2,        <span class="op">~</span>Col3, </a>
<a class="sourceLine" id="cb189-6" data-line-number="6">  <span class="st">&quot;Pepita&quot;</span>, <span class="st">&quot;Manzana&quot;</span>,    <span class="dv">48</span>,     </a>
<a class="sourceLine" id="cb189-7" data-line-number="7">  <span class="st">&quot;Pepita&quot;</span>, <span class="st">&quot;Pera&quot;</span>   ,    <span class="dv">52</span>,</a>
<a class="sourceLine" id="cb189-8" data-line-number="8">  <span class="st">&quot;Cítrico&quot;</span>, <span class="st">&quot;Naranja&quot;</span>,   <span class="dv">12</span>, </a>
<a class="sourceLine" id="cb189-9" data-line-number="9">  <span class="st">&quot;Cítrico&quot;</span>, <span class="st">&quot;Mandarina&quot;</span>, <span class="dv">8</span>,</a>
<a class="sourceLine" id="cb189-10" data-line-number="10">  <span class="st">&quot;Carozo&quot;</span>,  <span class="st">&quot;Durazno&quot;</span>,   <span class="dv">60</span>,</a>
<a class="sourceLine" id="cb189-11" data-line-number="11">  <span class="st">&quot;Carozo&quot;</span>,  <span class="st">&quot;Ciruela&quot;</span>,   <span class="dv">55</span></a>
<a class="sourceLine" id="cb189-12" data-line-number="12">        )  <span class="op">%&gt;%</span><span class="st">                   </span></a>
<a class="sourceLine" id="cb189-13" data-line-number="13"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">Tipo=</span>Col1,              </a>
<a class="sourceLine" id="cb189-14" data-line-number="14">         <span class="dt">Fruta=</span>Col2,             </a>
<a class="sourceLine" id="cb189-15" data-line-number="15">         <span class="dt">Precio=</span>Col3) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb189-16" data-line-number="16"><span class="st">  </span><span class="kw">filter</span>(Precio<span class="op">&gt;=</span><span class="dv">12</span>)    <span class="co">#Usando &gt;= conservo solamente las filas en las que el precio es mayor a igual a 12. &lt;, &gt;, y &lt;= también son válidos.</span></a></code></pre></div>
<pre><code>## # A tibble: 5 x 3
##   Tipo    Fruta   Precio
##   &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;
## 1 Pepita  Manzana     48
## 2 Pepita  Pera        52
## 3 Cítrico Naranja     12
## 4 Carozo  Durazno     60
## 5 Carozo  Ciruela     55</code></pre>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb191-1" data-line-number="1"><span class="co">#Seleccionar columnas</span></a>
<a class="sourceLine" id="cb191-2" data-line-number="2"><span class="co">#====================</span></a>
<a class="sourceLine" id="cb191-3" data-line-number="3"></a>
<a class="sourceLine" id="cb191-4" data-line-number="4"><span class="kw">tribble</span>(</a>
<a class="sourceLine" id="cb191-5" data-line-number="5">  <span class="op">~</span>Col1,    <span class="op">~</span>Col2,       <span class="op">~</span>Col3, </a>
<a class="sourceLine" id="cb191-6" data-line-number="6">  <span class="st">&quot;Pepita&quot;</span>, <span class="st">&quot;Manzana&quot;</span>,   <span class="dv">48</span>,     </a>
<a class="sourceLine" id="cb191-7" data-line-number="7">  <span class="st">&quot;Pepita&quot;</span>, <span class="st">&quot;Pera&quot;</span>   ,   <span class="dv">52</span>,</a>
<a class="sourceLine" id="cb191-8" data-line-number="8">  <span class="st">&quot;Cítrico&quot;</span>,<span class="st">&quot;Naranja&quot;</span>,   <span class="dv">12</span>, </a>
<a class="sourceLine" id="cb191-9" data-line-number="9">  <span class="st">&quot;Cítrico&quot;</span>,<span class="st">&quot;Mandarina&quot;</span>, <span class="dv">8</span>,</a>
<a class="sourceLine" id="cb191-10" data-line-number="10">  <span class="st">&quot;Carozo&quot;</span>, <span class="st">&quot;Durazno&quot;</span>,   <span class="dv">60</span>,</a>
<a class="sourceLine" id="cb191-11" data-line-number="11">  <span class="st">&quot;Carozo&quot;</span>, <span class="st">&quot;Ciruela&quot;</span>,   <span class="dv">55</span></a>
<a class="sourceLine" id="cb191-12" data-line-number="12">        )  <span class="op">%&gt;%</span><span class="st">                   </span></a>
<a class="sourceLine" id="cb191-13" data-line-number="13"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">Tipo=</span>Col1,              </a>
<a class="sourceLine" id="cb191-14" data-line-number="14">         <span class="dt">Fruta=</span>Col2,             </a>
<a class="sourceLine" id="cb191-15" data-line-number="15">         <span class="dt">Precio=</span>Col3) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb191-16" data-line-number="16"><span class="st">  </span><span class="kw">filter</span>(Tipo<span class="op">!=</span><span class="st">&quot;Cítrico&quot;</span>)  <span class="op">%&gt;%</span><span class="st">   </span><span class="co">#Filtro los que NO son cítricos usando != en lugar de ==</span></a>
<a class="sourceLine" id="cb191-17" data-line-number="17"><span class="st">  </span><span class="kw">select</span>(Precio, Fruta)          <span class="co">#Selecciono las columnas Precio y Fruta, saldrán en ese orden. Nótese que cada función opera sobre el output de la anterior. </span></a></code></pre></div>
<pre><code>## # A tibble: 4 x 2
##   Precio Fruta  
##    &lt;dbl&gt; &lt;chr&gt;  
## 1     48 Manzana
## 2     52 Pera   
## 3     60 Durazno
## 4     55 Ciruela</code></pre>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb193-1" data-line-number="1"><span class="co">#Cálculos agrupados </span></a>
<a class="sourceLine" id="cb193-2" data-line-number="2"><span class="co">#==================</span></a>
<a class="sourceLine" id="cb193-3" data-line-number="3"></a>
<a class="sourceLine" id="cb193-4" data-line-number="4"><span class="kw">tribble</span>(</a>
<a class="sourceLine" id="cb193-5" data-line-number="5">  <span class="op">~</span>Col1,    <span class="op">~</span>Col2,        <span class="op">~</span>Col3, </a>
<a class="sourceLine" id="cb193-6" data-line-number="6">  <span class="st">&quot;Pepita&quot;</span>, <span class="st">&quot;Manzana&quot;</span>,    <span class="dv">48</span>,     </a>
<a class="sourceLine" id="cb193-7" data-line-number="7">  <span class="st">&quot;Pepita&quot;</span>, <span class="st">&quot;Pera&quot;</span>   ,    <span class="dv">52</span>,</a>
<a class="sourceLine" id="cb193-8" data-line-number="8">  <span class="st">&quot;Cítrico&quot;</span>, <span class="st">&quot;Naranja&quot;</span>,   <span class="dv">12</span>, </a>
<a class="sourceLine" id="cb193-9" data-line-number="9">  <span class="st">&quot;Cítrico&quot;</span>, <span class="st">&quot;Mandarina&quot;</span>, <span class="dv">8</span>,</a>
<a class="sourceLine" id="cb193-10" data-line-number="10">  <span class="st">&quot;Carozo&quot;</span>,  <span class="st">&quot;Durazno&quot;</span>,   <span class="dv">60</span>,</a>
<a class="sourceLine" id="cb193-11" data-line-number="11">  <span class="st">&quot;Carozo&quot;</span>,  <span class="st">&quot;Ciruela&quot;</span>,   <span class="dv">55</span></a>
<a class="sourceLine" id="cb193-12" data-line-number="12">        )  <span class="op">%&gt;%</span><span class="st">                   </span></a>
<a class="sourceLine" id="cb193-13" data-line-number="13"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">Tipo=</span>Col1,              </a>
<a class="sourceLine" id="cb193-14" data-line-number="14">         <span class="dt">Fruta=</span>Col2,             </a>
<a class="sourceLine" id="cb193-15" data-line-number="15">         <span class="dt">Precio=</span>Col3) <span class="op">%&gt;%</span><span class="st">        </span><span class="co">#Retomo los datos originales, renombradas las columnas. </span></a>
<a class="sourceLine" id="cb193-16" data-line-number="16"><span class="st">  </span><span class="kw">group_by</span>(Tipo) <span class="op">%&gt;%</span><span class="st">             </span><span class="co">#Agrupo por tipo. Las siguientes operaciones se harán por este grupo.</span></a>
<a class="sourceLine" id="cb193-17" data-line-number="17"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">promedio=</span>            <span class="co">#Nombre de la columna que se creará con el sumario. Opcional, pero recomendable. </span></a>
<a class="sourceLine" id="cb193-18" data-line-number="18">              <span class="kw">mean</span>(              <span class="co">#Función que utilizaremos. mean regresa la media. </span></a>
<a class="sourceLine" id="cb193-19" data-line-number="19">                Precio)          <span class="co">#Columna sobre la que opera la función.</span></a>
<a class="sourceLine" id="cb193-20" data-line-number="20">            )  <span class="op">%&gt;%</span><span class="st">               </span><span class="co">#Cierro el paréntesis que abrí en summarise()</span></a>
<a class="sourceLine" id="cb193-21" data-line-number="21"><span class="st">  </span><span class="kw">arrange</span>(promedio)              <span class="co">#Ordeno de menor a mayor.  </span></a></code></pre></div>
<pre><code>## # A tibble: 3 x 2
##   Tipo    promedio
##   &lt;chr&gt;      &lt;dbl&gt;
## 1 Cítrico     10  
## 2 Pepita      50  
## 3 Carozo      57.5</code></pre>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb195-1" data-line-number="1"><span class="co">#Transformaciones de columnas </span></a>
<a class="sourceLine" id="cb195-2" data-line-number="2"><span class="co">#============================</span></a>
<a class="sourceLine" id="cb195-3" data-line-number="3"><span class="kw">tribble</span>(</a>
<a class="sourceLine" id="cb195-4" data-line-number="4">  <span class="op">~</span>Col1,    <span class="op">~</span>Col2,        <span class="op">~</span>Col3, <span class="op">~</span>Col4, <span class="co">#Creé una nuevo columna. </span></a>
<a class="sourceLine" id="cb195-5" data-line-number="5">  <span class="st">&quot;Pepita&quot;</span>, <span class="st">&quot;Manzana&quot;</span>,    <span class="dv">48</span>,     <span class="dv">12</span>,   </a>
<a class="sourceLine" id="cb195-6" data-line-number="6">  <span class="st">&quot;Pepita&quot;</span>, <span class="st">&quot;Pera&quot;</span>   ,    <span class="dv">52</span>,     <span class="dv">7</span>, </a>
<a class="sourceLine" id="cb195-7" data-line-number="7">  <span class="st">&quot;Cítrico&quot;</span>, <span class="st">&quot;Naranja&quot;</span>,   <span class="dv">12</span>,     <span class="dv">50</span>,</a>
<a class="sourceLine" id="cb195-8" data-line-number="8">  <span class="st">&quot;Cítrico&quot;</span>, <span class="st">&quot;Mandarina&quot;</span>, <span class="dv">8</span>,      <span class="dv">40</span>,</a>
<a class="sourceLine" id="cb195-9" data-line-number="9">  <span class="st">&quot;Carozo&quot;</span>,  <span class="st">&quot;Durazno&quot;</span>,   <span class="dv">60</span>,     <span class="dv">3</span>, </a>
<a class="sourceLine" id="cb195-10" data-line-number="10">  <span class="st">&quot;Carozo&quot;</span>,  <span class="st">&quot;Ciruela&quot;</span>,   <span class="dv">55</span>,     <span class="dv">10</span></a>
<a class="sourceLine" id="cb195-11" data-line-number="11">        )  <span class="op">%&gt;%</span><span class="st">                  </span></a>
<a class="sourceLine" id="cb195-12" data-line-number="12"><span class="kw">rename</span>(<span class="dt">Tipo=</span>Col1,             </a>
<a class="sourceLine" id="cb195-13" data-line-number="13">         <span class="dt">Fruta=</span>Col2,            </a>
<a class="sourceLine" id="cb195-14" data-line-number="14">         <span class="dt">Precio=</span>Col3,</a>
<a class="sourceLine" id="cb195-15" data-line-number="15">         <span class="dt">Kilos=</span>Col4) <span class="op">%&gt;%</span><span class="st">            </span><span class="co">#La nueva columna son los kilos en el inventario.</span></a>
<a class="sourceLine" id="cb195-16" data-line-number="16"><span class="kw">mutate</span>(<span class="dt">Fruta=</span><span class="kw">recode</span>(Fruta,          <span class="co">#Recodifico una variable categórica. </span></a>
<a class="sourceLine" id="cb195-17" data-line-number="17">  <span class="dt">Manzana=</span><span class="st">&quot;Manzana Verde&quot;</span>)) <span class="op">%&gt;%</span><span class="st">     </span><span class="co">#categoría_vieja=&quot;categoría_nueva&quot;. ¡Atención a las comillas!</span></a>
<a class="sourceLine" id="cb195-18" data-line-number="18"><span class="kw">mutate</span>(<span class="dt">Capital=</span>Precio<span class="op">*</span>Kilos)        <span class="co">#Creo una nueva columna numérica a partir de otras dos.Uso * para multiplicación. También podria usar +, -, / y ^ para potecia.</span></a></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##   Tipo    Fruta         Precio Kilos Capital
##   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
## 1 Pepita  Manzana Verde     48    12     576
## 2 Pepita  Pera              52     7     364
## 3 Cítrico Naranja           12    50     600
## 4 Cítrico Mandarina          8    40     320
## 5 Carozo  Durazno           60     3     180
## 6 Carozo  Ciruela           55    10     550</code></pre>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb197-1" data-line-number="1"><span class="co">#Asigno nombre al resultado de una función</span></a>
<a class="sourceLine" id="cb197-2" data-line-number="2"><span class="co">#=========================================</span></a>
<a class="sourceLine" id="cb197-3" data-line-number="3"></a>
<a class="sourceLine" id="cb197-4" data-line-number="4"><span class="kw">tribble</span>(</a>
<a class="sourceLine" id="cb197-5" data-line-number="5">  <span class="op">~</span>Tipo,    <span class="op">~</span>Fruta,      <span class="op">~</span>Precio, <span class="op">~</span>Kilos, <span class="co">#Creé una nuevo columna. </span></a>
<a class="sourceLine" id="cb197-6" data-line-number="6">  <span class="st">&quot;Pepita&quot;</span>, <span class="st">&quot;Manzana&quot;</span>,    <span class="dv">48</span>,      <span class="dv">12</span>,   </a>
<a class="sourceLine" id="cb197-7" data-line-number="7">  <span class="st">&quot;Pepita&quot;</span>,  <span class="st">&quot;Pera&quot;</span>,      <span class="dv">52</span>,      <span class="dv">7</span>, </a>
<a class="sourceLine" id="cb197-8" data-line-number="8">  <span class="st">&quot;Cítrico&quot;</span>, <span class="st">&quot;Naranja&quot;</span>,   <span class="dv">12</span>,      <span class="dv">50</span>,</a>
<a class="sourceLine" id="cb197-9" data-line-number="9">  <span class="st">&quot;Cítrico&quot;</span>, <span class="st">&quot;Mandarina&quot;</span>, <span class="dv">8</span>,       <span class="dv">40</span>,    <span class="co">#Mandarina no está en frutería2.</span></a>
<a class="sourceLine" id="cb197-10" data-line-number="10">  <span class="st">&quot;Carozo&quot;</span>,  <span class="st">&quot;Durazno&quot;</span>,   <span class="dv">60</span>,      <span class="dv">3</span>, </a>
<a class="sourceLine" id="cb197-11" data-line-number="11">  <span class="st">&quot;Carozo&quot;</span>,  <span class="st">&quot;Ciruela&quot;</span>,   <span class="dv">55</span>,      <span class="dv">10</span></a>
<a class="sourceLine" id="cb197-12" data-line-number="12">        ) -&gt;<span class="st"> </span>frutería1                    <span class="co">#Asigno el nombre frutería1 al final de la cadena con -&gt; ¡El resultado no saldrá en la consola pero quedará disponible!</span></a>
<a class="sourceLine" id="cb197-13" data-line-number="13"></a>
<a class="sourceLine" id="cb197-14" data-line-number="14">frutería2 &lt;-<span class="st"> </span><span class="kw">tribble</span>(</a>
<a class="sourceLine" id="cb197-15" data-line-number="15">                     <span class="op">~</span>Fruta,      <span class="op">~</span>precio_futuro,  <span class="co">#Alternativamente asigno al principio de la cadena con &lt;-. De todos modos se asignará el resultado final de la cadena.</span></a>
<a class="sourceLine" id="cb197-16" data-line-number="16">                     <span class="st">&quot;Naranja&quot;</span>,   <span class="dv">12</span>,    </a>
<a class="sourceLine" id="cb197-17" data-line-number="17">                     <span class="st">&quot;Manzana&quot;</span>,   <span class="dv">48</span>,    </a>
<a class="sourceLine" id="cb197-18" data-line-number="18">                     <span class="st">&quot;Pera&quot;</span>   ,   <span class="dv">52</span>,    </a>
<a class="sourceLine" id="cb197-19" data-line-number="19">                     <span class="st">&quot;Durazno&quot;</span>,   <span class="dv">60</span>,    </a>
<a class="sourceLine" id="cb197-20" data-line-number="20">                     <span class="st">&quot;Toronja&quot;</span>,   <span class="dv">8</span>,               <span class="co">#Toronja no está en frutería1    </span></a>
<a class="sourceLine" id="cb197-21" data-line-number="21">                     <span class="st">&quot;Ciruela&quot;</span>,   <span class="dv">55</span>    </a>
<a class="sourceLine" id="cb197-22" data-line-number="22">                             )</a></code></pre></div>
</div>
</div>
<div id="uso-avanzado-de-dplyr" class="section level2">
<h2><span class="header-section-number">3.6</span> Uso avanzado de <code>dplyr::</code></h2>
<div id="alternar-entre-formato-largo-y-ancho." class="section level3">
<h3><span class="header-section-number">3.6.1</span> Alternar entre formato largo y ancho.</h3>
<p>El formato de datos largo es el que llamamos prolijo. Sin embargo en ocasiones puede ser necesario hacer el proceso inverso y pasar datos de formato largo a formato ancho. Por ejemplo, para hacer operaciones matemáticas entre columnas. Siempre es mejor partir del formato largo y prolijo y pasar a formato ancho allí donde es necesario.
La función <code>spread()</code> hace este cambio.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb198-1" data-line-number="1"><span class="co">#Formato largo a formato ancho</span></a>
<a class="sourceLine" id="cb198-2" data-line-number="2"><span class="co">#=============================</span></a>
<a class="sourceLine" id="cb198-3" data-line-number="3">desprolijo <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb198-4" data-line-number="4"><span class="st">  </span>arreglar <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb198-5" data-line-number="5"><span class="st">  </span><span class="kw">spread</span>(Año, Precio)  <span class="co">#Año será nombre de columna, Precio los valores de cada año.  </span></a></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   Fruta     `2015` `2016`
##   &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;
## 1 Mandarina     10     12
## 2 Toronja       14     15</code></pre>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb200-1" data-line-number="1">desprolijo <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb200-2" data-line-number="2"><span class="st">  </span>arreglar <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb200-3" data-line-number="3"><span class="st">  </span><span class="kw">spread</span>(Año, Precio) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb200-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(variación_<span class="dt">precio=</span><span class="st">`</span><span class="dt">2016</span><span class="st">`</span><span class="op">-</span><span class="st">`</span><span class="dt">2015</span><span class="st">`</span>) <span class="co">#Puedo hacer el cálculo. </span></a></code></pre></div>
<pre><code>## # A tibble: 2 x 4
##   Fruta     `2015` `2016` variación_precio
##   &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;            &lt;dbl&gt;
## 1 Mandarina     10     12                2
## 2 Toronja       14     15                1</code></pre>
</div>
<div id="seleccionar-las-columnas-que-cumplen-determinada-condicion." class="section level3">
<h3><span class="header-section-number">3.6.2</span> Seleccionar las columnas que cumplen determinada condición.</h3>
<p>Hasta ahora hemos visto como seleccionar columnas escribiendo sus nombres separados por comas o usando <code>-</code> para señalar cuales no queremos que permanezcan. <code>select()</code> tiene algunas funciones ayudantes que permiten seleccionar columnas de acuerdo con alguna condición lógica y pueden ser de gran ayuda cuando trabajamos con bases de datos con gran número de columna.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb202-1" data-line-number="1"><span class="kw">tribble</span>(<span class="op">~</span>frutamanzana, <span class="op">~</span>frutamandarina, <span class="op">~</span>vegetalcalabacin, <span class="op">~</span>vegetalzanahoria, </a>
<a class="sourceLine" id="cb202-2" data-line-number="2">        <span class="dv">10</span>,             <span class="dv">8</span>,                <span class="dv">15</span>,                 <span class="dv">10</span>) -&gt;<span class="st"> </span>fruteria_verdulería</a>
<a class="sourceLine" id="cb202-3" data-line-number="3"></a>
<a class="sourceLine" id="cb202-4" data-line-number="4"><span class="kw">select</span>(fruteria_verdulería, <span class="kw">starts_with</span>(<span class="st">&quot;vegetal&quot;</span>))       <span class="co">#Selecciona todas las columnas cuyo nombre comienza con la cadena &quot;vegetal&quot;</span></a></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   vegetalcalabacin vegetalzanahoria
##              &lt;dbl&gt;            &lt;dbl&gt;
## 1               15               10</code></pre>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb204-1" data-line-number="1"><span class="kw">select</span>(fruteria_verdulería, <span class="kw">ends_with</span>(<span class="st">&quot;na&quot;</span>))              <span class="co">#Selecciona todas las columnas cuyo nombre termina con la cadena &quot;na&quot;</span></a></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   frutamanzana frutamandarina
##          &lt;dbl&gt;          &lt;dbl&gt;
## 1           10              8</code></pre>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb206-1" data-line-number="1"><span class="kw">select</span>(fruteria_verdulería, <span class="kw">contains</span>(<span class="st">&quot;na&quot;</span>))               <span class="co">#Selecciona todas las columnas cuyo nombres contiene la cadena &quot;na&quot;</span></a></code></pre></div>
<pre><code>## # A tibble: 1 x 3
##   frutamanzana frutamandarina vegetalzanahoria
##          &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt;
## 1           10              8               10</code></pre>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb208-1" data-line-number="1"><span class="kw">select</span>(fruteria_verdulería, <span class="dv">2</span><span class="op">:</span><span class="dv">4</span>)                          <span class="co">#Selecciona las columnas con las ubicaciones 2 a la 4.</span></a></code></pre></div>
<pre><code>## # A tibble: 1 x 3
##   frutamandarina vegetalcalabacin vegetalzanahoria
##            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;
## 1              8               15               10</code></pre>
</div>
<div id="filtrar-por-mas-de-una-condicion-o-dentro-de-un-conjunto." class="section level3">
<h3><span class="header-section-number">3.6.3</span> Filtrar por más de una condición o dentro de un conjunto.</h3>
<p>Filter es una herramienta muy potente para hacer subconjuntos de datos. Para sacar el mayor provecho vale la pena reflexionar sobre la forma en que opera y la sintaxis de la función nos da una pista. Entre los paréntesis posteriores a filter ubicamos una condición lógica que especificamos a través de operadores binarios. Los operadores binarios más conocidos son los que usamos frecuentemente para definir operaciones aritméticas: <code>+</code> para sumar o <code>-</code> para restar. Se los llama binarios porque se ubican entre dos expresiones y establecen una relación entre ellas, de lo contrario sería operadores unarios, otra clase también definida por R. Consiguientemente si no ubicamos al operador binario entre dos expresiones R nos regresará un error. A las dos expresiones que envuelven a un operador binario las llamados <em>lado derecho</em> y <em>lado izquierdo</em>. Esto es de la mayor importancia, ya que la ubicación en cada uno de los lados hace que la operación sea diferente. La aritmética nos ayuda una vez más a comprenderlo, si queremos hacer una resta entre los números 10 y 2 no obtenemos el mismo resultado alternando el lado en que los ubicamos. <code>10-2</code> no es lo mismo que <code>2-10</code>. <code>a %in% x</code>, que se lee en voz alta como ‘a pertenece a x’ no es lo mismo que ‘x pertenece a a’. Filter utiliza todos los operadores binarios de R, que se detallan en tabla a continuación. Con esta especificación R evalúa el cumplimiento de una condición y regresa <code>TRUE</code> cuando se cumple y <code>FALSE</code> cuando no. Dado que R opera por defecto de manera vectorizada, cuando especificamos un vector evalúa todo el vector y regresa un vector de <code>TRUE</code>y <code>FALSE</code> del mismo largo del que introduducimos. Posteriormente filter() conseva solamente aquellas filas en las que el resultado de la evaluación fue <code>TRUE</code>. Esta evaluación aplica tanto para cadenas de caracteres como para datos del tipo numérico. En el caso de las cadenas de caracteres algunos operadores utilizarán el orden alfabético, así <code>&quot;pera&quot;&gt;&quot;manzana&quot;</code> regresa <code>TRUE</code>, porque <code>p</code> ocupa el lugar 16 en el alfabeto y <code>m</code> el 13. En caso de empate R evaluará la segunda letra y así hasta desempatar.<br />
Table: Operadores binarios de R disponibles para <code>filter()</code></p>
<table>
<colgroup>
<col width="19%" />
<col width="80%" />
</colgroup>
<thead>
<tr class="header">
<th>Operador</th>
<th>Uso</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>==</code></td>
<td>Igual que</td>
</tr>
<tr class="even">
<td><code>&gt;</code></td>
<td>Mayor que</td>
</tr>
<tr class="odd">
<td><code>&gt;=</code></td>
<td>Mayor o igual que</td>
</tr>
<tr class="even">
<td><code>&lt;</code></td>
<td>Menor que</td>
</tr>
<tr class="odd">
<td><code>&lt;=</code></td>
<td>Menor o igual que</td>
</tr>
<tr class="even">
<td><code>%in%     | Pertenece a un vector|Vectores numéricos o de caracteres</code>&amp;<code>| Y lógica, para especificar una segunda condición a cumplirse | Entre dos expresiones binarias</code></td>
<td><code>| Ó lógica, para especificar una condición alternativa | Entre dos expresiones binarias</code>!<code>| No, invierte el sentido de cada operador, regresa TRUE cuando *no* se cumple la condición | Detrás de cualquiera de los operadores</code>%like%`</td>
</tr>
</tbody>
</table>
<p>Usando estos operadores y sus combinaciones podemos hacer prácticamente cualquier operación de filtrado de filas, empleando información de una o más columnas, siempre que estén dentro del data.frame al que estamos manipulando. Si bien es posible hacer filtrados sucesivos encadenando operaciones de <code>filter()</code> por cuestiones de desempeño –sobre todo en bases de datos muy grandes– y compacitud del código es preferible cargar tantas condiciones como es posible en la misma cadena. Recuerde que cada vez que invocamos la función R debe recorrer todo el vector evaluando, es mejor que lo haga sólo una vez para un conjunto de condiciones complejas que muchas veces para condiciones simples.</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb210-1" data-line-number="1"><span class="kw">library</span>(data.table)                                                      <span class="co">#Importa el operador %like%</span></a></code></pre></div>
<pre><code>## 
## Attaching package: &#39;data.table&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     between, first, last</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     transpose</code></pre>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb214-1" data-line-number="1"><span class="co">#Datos</span></a>
<a class="sourceLine" id="cb214-2" data-line-number="2"><span class="co">#=====</span></a>
<a class="sourceLine" id="cb214-3" data-line-number="3">         </a>
<a class="sourceLine" id="cb214-4" data-line-number="4"><span class="kw">tribble</span>(<span class="op">~</span>Estado,            <span class="op">~</span>Municipio,          <span class="op">~</span>Población,</a>
<a class="sourceLine" id="cb214-5" data-line-number="5">        <span class="st">&quot;Chihuahua&quot;</span>,        <span class="st">&quot;Juárez&quot;</span>,            <span class="dv">1391180</span>,</a>
<a class="sourceLine" id="cb214-6" data-line-number="6">        <span class="st">&quot;Nuevo León&quot;,       &quot;</span>Juárez<span class="st">&quot;,            333481,</span></a>
<a class="sourceLine" id="cb214-7" data-line-number="7"><span class="st">        &quot;</span>Chiapas<span class="st">&quot;,          &quot;</span>Juárez<span class="st">&quot;,            21222, </span></a>
<a class="sourceLine" id="cb214-8" data-line-number="8"><span class="st">        &quot;</span>Chiapas<span class="st">&quot;,          &quot;</span>Unión Juárez<span class="st">&quot;,      15350, </span></a>
<a class="sourceLine" id="cb214-9" data-line-number="9"><span class="st">        &quot;</span>Guerrero<span class="st">&quot;,         &quot;</span>Acapulco de Juárez<span class="st">&quot;,810669, </span></a>
<a class="sourceLine" id="cb214-10" data-line-number="10"><span class="st">        &quot;</span>Ciudad de México<span class="st">&quot;, &quot;</span>Milpa Alta<span class="st">&quot;,        137927, </span></a>
<a class="sourceLine" id="cb214-11" data-line-number="11"><span class="st">        &quot;</span>Chihuahua<span class="st">&quot;,        &quot;</span>Batopilas<span class="st">&quot;,         9751, </span></a>
<a class="sourceLine" id="cb214-12" data-line-number="12"><span class="st">        &quot;</span>Nuevo León&quot;,       <span class="st">&quot;Apodaca&quot;</span>,           <span class="dv">115913</span>,</a>
<a class="sourceLine" id="cb214-13" data-line-number="13">        <span class="st">&quot;Nuevo León&quot;,       &quot;</span>Carmen<span class="st">&quot;,            4906 </span></a>
<a class="sourceLine" id="cb214-14" data-line-number="14"><span class="st">        ) -&gt; municipios</span></a>
<a class="sourceLine" id="cb214-15" data-line-number="15"></a>
<a class="sourceLine" id="cb214-16" data-line-number="16"><span class="st">#Dos condiciones. </span></a>
<a class="sourceLine" id="cb214-17" data-line-number="17"><span class="st">filter(municipios, Municipio==&quot;</span>Juárez<span class="st">&quot; &amp; Población &lt;400000)              #Municipios llamados Juárez con población menor a 400000.</span></a></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   Estado     Municipio Población
##   &lt;chr&gt;      &lt;chr&gt;         &lt;dbl&gt;
## 1 Nuevo León Juárez       333481
## 2 Chiapas    Juárez        21222</code></pre>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb216-1" data-line-number="1"><span class="co">#Cadenas similares</span></a>
<a class="sourceLine" id="cb216-2" data-line-number="2"><span class="kw">filter</span>(municipios, Municipio <span class="op">%like%</span><span class="st"> &quot;Juárez&quot;</span> <span class="op">&amp;</span><span class="st"> </span>Población <span class="op">&lt;</span><span class="dv">400000</span>)        <span class="co">#Incluye Unión Juárez, similar a &quot;Juárez&quot;, no Acapulco o CD Juáres por la 2da condición. </span></a></code></pre></div>
<pre><code>## # A tibble: 3 x 3
##   Estado     Municipio    Población
##   &lt;chr&gt;      &lt;chr&gt;            &lt;dbl&gt;
## 1 Nuevo León Juárez          333481
## 2 Chiapas    Juárez           21222
## 3 Chiapas    Unión Juárez     15350</code></pre>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb218-1" data-line-number="1"><span class="co">#Una u otra condición.</span></a>
<a class="sourceLine" id="cb218-2" data-line-number="2"><span class="kw">filter</span>(municipios, Municipio <span class="op">==</span><span class="st">&quot;Juárez&quot;</span> <span class="op">|</span><span class="st"> </span>Población==<span class="dv">137927</span>)             <span class="co">#Municipios llamados Juárez o con una población de 137927 (Milpa Alta)</span></a></code></pre></div>
<pre><code>## # A tibble: 4 x 3
##   Estado           Municipio  Población
##   &lt;chr&gt;            &lt;chr&gt;          &lt;dbl&gt;
## 1 Chihuahua        Juárez       1391180
## 2 Nuevo León       Juárez        333481
## 3 Chiapas          Juárez         21222
## 4 Ciudad de México Milpa Alta    137927</code></pre>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb220-1" data-line-number="1"><span class="co">#No es igual.</span></a>
<a class="sourceLine" id="cb220-2" data-line-number="2"><span class="kw">filter</span>(municipios, Estado<span class="op">!=</span><span class="st">&quot;Chihuahua&quot;</span> <span class="op">&amp;</span><span class="st"> </span>Población&gt;<span class="dv">400000</span>)               <span class="co">#Población superir a 40000 habitantes, NO en Chihuahua. </span></a></code></pre></div>
<pre><code>## # A tibble: 1 x 3
##   Estado   Municipio          Población
##   &lt;chr&gt;    &lt;chr&gt;                  &lt;dbl&gt;
## 1 Guerrero Acapulco de Juárez    810669</code></pre>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb222-1" data-line-number="1"><span class="co">#Pertenencia a un conjunto.</span></a>
<a class="sourceLine" id="cb222-2" data-line-number="2">filtro &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Acapulco de Juárez&quot;</span>, <span class="st">&quot;Milpa Alta&quot;</span>)                          <span class="co">#Defino el conjunto como un vector. </span></a>
<a class="sourceLine" id="cb222-3" data-line-number="3"><span class="kw">filter</span>(municipios, Municipio <span class="op">%in%</span><span class="st"> </span>filtro)                                <span class="co">#Pertenece a un vector.</span></a></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   Estado           Municipio          Población
##   &lt;chr&gt;            &lt;chr&gt;                  &lt;dbl&gt;
## 1 Guerrero         Acapulco de Juárez    810669
## 2 Ciudad de México Milpa Alta            137927</code></pre>
</div>
<div id="transformacion-avanzada-de-datos." class="section level3">
<h3><span class="header-section-number">3.6.4</span> Transformacion avanzada de datos.</h3>
<p>Usándolo con cuidado <code>mutate()</code> es una herramienta muy potente para hacer transformaciones de datos. En términos muy prácticos <code>mutate()</code> une un vector resultado de una función al data.frame con el que estamos trabajando. Es decir, cualquier función que tome uno o más vectores y nos regrese otro puede utilizarse dentro de <code>mutate()</code>, incluyendo algunas básicas como <code>ifelse()</code> para operaciones condicionales vectoriales, <code>cumsum()</code> para sumas acumuladas. <code>lag()</code> y <code>lead()</code> para mover un vector una línea abajo o hacia arriba respectivamente, permitiéndonos computar la diferencia entre una fila y la anterior o posterior. También es posible pasar varias transformaciones al mismo tiempo separándolas con comas.
La familia ampliada de <code>mutate()</code> incluye <code>mutate_all()</code>, para aplicar la misma transformación a todas las variables, <code>mutate_if()</code> que aplica una transformación a las variables que cumplen con una condición.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb224-1" data-line-number="1"><span class="co">#Dicotomiza una variable continua. ifelse()</span></a>
<a class="sourceLine" id="cb224-2" data-line-number="2">municipios <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb224-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span> (tamañ<span class="dt">o=</span> <span class="kw">ifelse</span>(Población <span class="op">&gt;</span><span class="dv">400000</span>, <span class="st">&quot;Muy poblado&quot;</span>, <span class="st">&quot;Poco poblado&quot;</span>))</a></code></pre></div>
<pre><code>## # A tibble: 9 x 4
##   Estado           Municipio          Población tamaño      
##   &lt;chr&gt;            &lt;chr&gt;                  &lt;dbl&gt; &lt;chr&gt;       
## 1 Chihuahua        Juárez               1391180 Muy poblado 
## 2 Nuevo León       Juárez                333481 Poco poblado
## 3 Chiapas          Juárez                 21222 Poco poblado
## 4 Chiapas          Unión Juárez           15350 Poco poblado
## 5 Guerrero         Acapulco de Juárez    810669 Muy poblado 
## 6 Ciudad de México Milpa Alta            137927 Poco poblado
## 7 Chihuahua        Batopilas               9751 Poco poblado
## 8 Nuevo León       Apodaca               115913 Poco poblado
## 9 Nuevo León       Carmen                  4906 Poco poblado</code></pre>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb226-1" data-line-number="1"><span class="co">#Calcular la diferencia entre filas con lag()</span></a>
<a class="sourceLine" id="cb226-2" data-line-number="2">municipios <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb226-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span> (<span class="dt">acumulado =</span> <span class="kw">cumsum</span>(Población), <span class="dt">diferencia=</span>Población-<span class="kw">lag</span>(Población)) </a></code></pre></div>
<pre><code>## # A tibble: 9 x 5
##   Estado           Municipio          Población acumulado diferencia
##   &lt;chr&gt;            &lt;chr&gt;                  &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
## 1 Chihuahua        Juárez               1391180   1391180         NA
## 2 Nuevo León       Juárez                333481   1724661   -1057699
## 3 Chiapas          Juárez                 21222   1745883    -312259
## 4 Chiapas          Unión Juárez           15350   1761233      -5872
## 5 Guerrero         Acapulco de Juárez    810669   2571902     795319
## 6 Ciudad de México Milpa Alta            137927   2709829    -672742
## 7 Chihuahua        Batopilas               9751   2719580    -128176
## 8 Nuevo León       Apodaca               115913   2835493     106162
## 9 Nuevo León       Carmen                  4906   2840399    -111007</code></pre>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb228-1" data-line-number="1"><span class="co">#Aplicae la misma transformación a todas las variables numéricas con mutate_if()</span></a>
<a class="sourceLine" id="cb228-2" data-line-number="2">municipios <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb228-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span> (<span class="dt">acumulado =</span> <span class="kw">cumsum</span>(Población), <span class="dt">diferencia=</span>Población-<span class="kw">lag</span>(Población)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb228-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate_if</span>(is.numeric, <span class="kw">funs</span>(<span class="kw">paste</span>(<span class="st">&quot;Son&quot;</span>, . , <span class="st">&quot;personas&quot;</span>)))                        </a></code></pre></div>
<pre><code>## # A tibble: 9 x 5
##   Estado           Municipio          Población   acumulado   diferencia  
##   &lt;chr&gt;            &lt;chr&gt;              &lt;chr&gt;       &lt;chr&gt;       &lt;chr&gt;       
## 1 Chihuahua        Juárez             Son 139118… Son 139118… Son NA pers…
## 2 Nuevo León       Juárez             Son 333481… Son 172466… Son -105769…
## 3 Chiapas          Juárez             Son 21222 … Son 174588… Son -312259…
## 4 Chiapas          Unión Juárez       Son 15350 … Son 176123… Son -5872 p…
## 5 Guerrero         Acapulco de Juárez Son 810669… Son 257190… Son 795319 …
## 6 Ciudad de México Milpa Alta         Son 137927… Son 270982… Son -672742…
## 7 Chihuahua        Batopilas          Son 9751 p… Son 271958… Son -128176…
## 8 Nuevo León       Apodaca            Son 115913… Son 283549… Son 106162 …
## 9 Nuevo León       Carmen             Son 4906 p… Son 284039… Son -111007…</code></pre>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb230-1" data-line-number="1"><span class="co">#Transformae a todas las colunas al tipo caracter con mutate_all()</span></a>
<a class="sourceLine" id="cb230-2" data-line-number="2">municipios <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate_all</span>(as.character)                                            </a></code></pre></div>
<pre><code>## # A tibble: 9 x 3
##   Estado           Municipio          Población
##   &lt;chr&gt;            &lt;chr&gt;              &lt;chr&gt;    
## 1 Chihuahua        Juárez             1391180  
## 2 Nuevo León       Juárez             333481   
## 3 Chiapas          Juárez             21222    
## 4 Chiapas          Unión Juárez       15350    
## 5 Guerrero         Acapulco de Juárez 810669   
## 6 Ciudad de México Milpa Alta         137927   
## 7 Chihuahua        Batopilas          9751     
## 8 Nuevo León       Apodaca            115913   
## 9 Nuevo León       Carmen             4906</code></pre>
</div>
<div id="sumarios-avanzados." class="section level3">
<h3><span class="header-section-number">3.6.5</span> Sumarios avanzados.</h3>
<p><code>summarise()</code> nos permite crear sumarios y es especialmente útil con datos agrupados. Sin embargo es posible que no exista una función que produzca el sumario que necesitamos. En ese caso podemos pasar a <code>summarise()</code> una función personalizada, ya sea una función que hemos definido previamente y hemos asignado nombre o una función anónima o función lambda. En este caso estimaremos la media de población para nuestra muestra, el desvío estandar y el error estandar de la media. Crearemos una función para calcular el error estándar traduciendo a R la notación matemática del error estándar: <span class="math inline">\(SE\hat{x}=\frac{\sigma}{\sqrt{n}}\)</span>, el error estándar de la media es igual al desvío estándar entre la raíz cuadrada de n.</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb232-1" data-line-number="1"><span class="co">#Con una función ad hoc, creada en la misma sintaxis.</span></a>
<a class="sourceLine" id="cb232-2" data-line-number="2"><span class="kw">summarise</span>(municipios, <span class="dt">n=</span><span class="kw">n</span>(), <span class="dt">media=</span><span class="kw">mean</span>(Población), <span class="dt">desvio=</span><span class="kw">sd</span>(Población), <span class="dt">error_estandar=</span><span class="kw">sd</span>(Población)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">n</span>()))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 4
##       n   media  desvio error_estandar
##   &lt;int&gt;   &lt;dbl&gt;   &lt;dbl&gt;          &lt;dbl&gt;
## 1     9 315600. 479663.        159888.</code></pre>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb234-1" data-line-number="1"><span class="co">#Con una función predefinida. </span></a>
<a class="sourceLine" id="cb234-2" data-line-number="2"><span class="co">#Defino de una función para calcular el error estandar de la media. La llamo es_media</span></a>
<a class="sourceLine" id="cb234-3" data-line-number="3">es_media &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb234-4" data-line-number="4">  <span class="kw">sd</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">length</span>(x))</a>
<a class="sourceLine" id="cb234-5" data-line-number="5">}</a>
<a class="sourceLine" id="cb234-6" data-line-number="6"></a>
<a class="sourceLine" id="cb234-7" data-line-number="7"><span class="co">#La utilizo como cualquier otra función de R. </span></a>
<a class="sourceLine" id="cb234-8" data-line-number="8"><span class="kw">summarise</span>(municipios, <span class="dt">n=</span><span class="kw">n</span>(), <span class="dt">media=</span><span class="kw">mean</span>(Población), <span class="dt">desvio=</span><span class="kw">sd</span>(Población), <span class="dt">error_estandar=</span><span class="kw">es_media</span>(Población))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 4
##       n   media  desvio error_estandar
##   &lt;int&gt;   &lt;dbl&gt;   &lt;dbl&gt;          &lt;dbl&gt;
## 1     9 315600. 479663.        159888.</code></pre>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb236-1" data-line-number="1"><span class="co">#Versión robusta de la función es_media: si n=1 regresa NaN, Not a Number. No se puede estimar el error estandar con n=1</span></a>
<a class="sourceLine" id="cb236-2" data-line-number="2"><span class="co">#Sobreescribe la función anterior. </span></a>
<a class="sourceLine" id="cb236-3" data-line-number="3"></a>
<a class="sourceLine" id="cb236-4" data-line-number="4">es_media &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb236-5" data-line-number="5">  <span class="kw">ifelse</span>(<span class="kw">length</span>(x)<span class="op">==</span><span class="dv">1</span>, <span class="ot">NaN</span>, <span class="kw">sd</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">length</span>(x)))}</a>
<a class="sourceLine" id="cb236-6" data-line-number="6"></a>
<a class="sourceLine" id="cb236-7" data-line-number="7">municipios <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb236-8" data-line-number="8"><span class="st">  </span><span class="kw">group_by</span>(Estado) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb236-9" data-line-number="9"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n=</span><span class="kw">n</span>(), </a>
<a class="sourceLine" id="cb236-10" data-line-number="10">            <span class="dt">media=</span><span class="kw">mean</span>(Población), </a>
<a class="sourceLine" id="cb236-11" data-line-number="11">            <span class="dt">desvio=</span><span class="kw">sd</span>(Población), </a>
<a class="sourceLine" id="cb236-12" data-line-number="12">            <span class="dt">error_estandar=</span><span class="kw">es_media</span>(Población))  </a></code></pre></div>
<pre><code>## # A tibble: 5 x 5
##   Estado               n   media  desvio error_estandar
##   &lt;chr&gt;            &lt;int&gt;   &lt;dbl&gt;   &lt;dbl&gt;          &lt;dbl&gt;
## 1 Chiapas              2  18286    4152.          2936.
## 2 Chihuahua            2 700466. 976818.        690714.
## 3 Ciudad de México     1 137927      NA            NaN 
## 4 Guerrero             1 810669      NA            NaN 
## 5 Nuevo León           3 151433. 167143.         96500.</code></pre>
</div>
<div id="funciones-avanzadas-de-combinacion-de-bases-de-datos." class="section level3">
<h3><span class="header-section-number">3.6.6</span> Funciones avanzadas de combinación de bases de datos.</h3>
<p><code>dplyr::</code> nos permite tiene algunos verbos muy usuales en el software de manejo de bases de datos que sirven para combinar múltiples fuentes de datos: los joins o uniones. Sin la sintaxis complicada de un lengujae como SQL podemos combinar bases de datos de manera flexible y aprovechar múltiples fuentes de datos, siempre que tengan al menos una columna que coincida. Podríamos usarlo para unir dos bases de datos con la misma unidad de análisis territorial o para combinar estructuras de datos asimétricas en cuanto al largo.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb238-1" data-line-number="1"><span class="co">#Unir varias estructuras de datos </span></a>
<a class="sourceLine" id="cb238-2" data-line-number="2"><span class="co">#================================</span></a>
<a class="sourceLine" id="cb238-3" data-line-number="3"></a>
<a class="sourceLine" id="cb238-4" data-line-number="4"><span class="co">#Une las filas en las que coinicen frutería1 y frutería2, usando Fruta como clave. Sólo conserva las coincidencias, mandarina desaparece porque no tiene precio futuro.</span></a>
<a class="sourceLine" id="cb238-5" data-line-number="5"><span class="kw">inner_join</span>(frutería1, frutería2, <span class="dt">by =</span> <span class="st">&quot;Fruta&quot;</span>)  </a></code></pre></div>
<pre><code>## # A tibble: 5 x 5
##   Tipo    Fruta   Precio Kilos precio_futuro
##   &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt;
## 1 Pepita  Manzana     48    12            48
## 2 Pepita  Pera        52     7            52
## 3 Cítrico Naranja     12    50            12
## 4 Carozo  Durazno     60     3            60
## 5 Carozo  Ciruela     55    10            55</code></pre>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb240-1" data-line-number="1"><span class="co">#Une todas las filas, imputa NA cuando hay información faltante. No precio futuro para Mandarina y falta información para Toronja.</span></a>
<a class="sourceLine" id="cb240-2" data-line-number="2"><span class="kw">full_join</span>(frutería1, frutería2, <span class="dt">by =</span> <span class="st">&quot;Fruta&quot;</span>)   </a></code></pre></div>
<pre><code>## # A tibble: 7 x 5
##   Tipo    Fruta     Precio Kilos precio_futuro
##   &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt;
## 1 Pepita  Manzana       48    12            48
## 2 Pepita  Pera          52     7            52
## 3 Cítrico Naranja       12    50            12
## 4 Cítrico Mandarina      8    40            NA
## 5 Carozo  Durazno       60     3            60
## 6 Carozo  Ciruela       55    10            55
## 7 &lt;NA&gt;    Toronja       NA    NA             8</code></pre>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb242-1" data-line-number="1"><span class="co">#Conserva sólamente las filas frutería1 que no coinciden con frutería2. </span></a>
<a class="sourceLine" id="cb242-2" data-line-number="2"><span class="kw">anti_join</span>(frutería1, frutería2, <span class="dt">by =</span> <span class="st">&quot;Fruta&quot;</span>)   </a></code></pre></div>
<pre><code>## # A tibble: 1 x 4
##   Tipo    Fruta     Precio Kilos
##   &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;
## 1 Cítrico Mandarina      8    40</code></pre>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb244-1" data-line-number="1"><span class="co">#Conserva las filas de frutería2 que no cinciden con frutería1.</span></a>
<a class="sourceLine" id="cb244-2" data-line-number="2"><span class="kw">anti_join</span>(frutería2, frutería1, <span class="dt">by =</span> <span class="st">&quot;Fruta&quot;</span>)  </a></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   Fruta   precio_futuro
##   &lt;chr&gt;           &lt;dbl&gt;
## 1 Toronja             8</code></pre>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb246-1" data-line-number="1"><span class="co">#Conserva sólo las filas de frutería1 y agregas las columnas de frutería2, imputa NA si no hay coincidencia. Hay mandarina, pero no toronja...</span></a>
<a class="sourceLine" id="cb246-2" data-line-number="2"><span class="kw">left_join</span>(frutería1, frutería2, <span class="dt">by =</span> <span class="st">&quot;Fruta&quot;</span>)   </a></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##   Tipo    Fruta     Precio Kilos precio_futuro
##   &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt;
## 1 Pepita  Manzana       48    12            48
## 2 Pepita  Pera          52     7            52
## 3 Cítrico Naranja       12    50            12
## 4 Cítrico Mandarina      8    40            NA
## 5 Carozo  Durazno       60     3            60
## 6 Carozo  Ciruela       55    10            55</code></pre>
</div>
<div id="operadores-avanzados-de-magrittr" class="section level3">
<h3><span class="header-section-number">3.6.7</span> Operadores avanzados de <code>magrittr::</code></h3>
<p>Ya hemos utilizado el principal operador de <code>magrittr::</code>, la tubería <code>%&gt;%</code> que estádisponible directamente en <code>dplyr::</code>. Entender el funcionamiento de <code>%&gt;%</code> puede ayudarnos a conocer sus límites y buscar alternativas para solucionar algunos problemas. <code>%&gt;%</code> es un operador binario, es decir, relaciona un lado izquierdo y un lado derecho. La expresión que está del lado derecho pasa su output a la del lado izquierdo. R no contempla un método específico para pasar los datos de una función a la siguiente, pero el autor de <code>magrittr::</code> encontró una manera ingeniosa. Dado que la mayoría de las funciones toma a los datos como primera argumento <code>%&gt;%</code> se encarga de “reescribir” la función del lado izquierdo, de manera el primer argumento sean los datos que produjo el lado derecho de la formula. Esto funciona en la mayoría de los casos, pero podemos tener problemas de la función que estamos utilizando en el lado izquierdo espera algo diferente a los datos como primer argumento. Asi con los modelos lineales que especificamos con <code>lm()</code>, esperan como primer argumento de la función la formula del modelo, no los datos. Para solucionar estos problemas <code>magrittr::</code> utiliza al signo <code>.</code> (un punto) como “comodín” para los datos y nos permite ubicarlos allí donde la sintaxis de la función del lado izquierdo los requiera.
Otro operador avanzado es <code>%T&gt;%</code>, que nos permite hacer una –breve– bifurcación. Cuando lo ubicamos detrás de una función <code>%T&gt;%%</code> hace que esta regrese el lado izquierdo y no el derecho. Así, si queremos hacer visible un resultado intermedio usanda la función <code>print()</code>, que luego pasará a la siguiente función no su output sino el que está a su izquierda. <code>%T&gt;%</code> funciona solamente para dar un salto, no más que eso. A veces no es suficiente, podríamos estar interesados en dar algo de formato a los datos intermedios que queremos imprimir y eso implicaría al menos dos saltos. En ese caso podemos envolver las funciones intermedias con <code>{}</code> y poner el operador unario <code>.</code> al final, de modo que pase los datos de la izquierda de <code>{}</code> a la función siguiente. Dentro de los límites de <code>{}</code> puedo hacer cualquier manipulación y generar cualquier outupt.</p>
<p>Por último el operador <code>%$%</code> pasa al lado derecho una serie de vectores en lugar de la estructura original de los datos –que con frecuencia es un data podría serlo un data.frame–. Esto es especialmente útil cuando del lado derecho tenemos una función que espera vectores, ya que nos ahorra la permanente llamada con <code>$</code> para especificar el data.frame del que tiene que extraer el vector.</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb248-1" data-line-number="1"><span class="kw">library</span>(magrittr)       <span class="co">#Para disponer de todos los operadores. </span></a></code></pre></div>
<pre><code>## 
## Attaching package: &#39;magrittr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     set_names</code></pre>
<pre><code>## The following object is masked from &#39;package:tidyr&#39;:
## 
##     extract</code></pre>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb252-1" data-line-number="1"><span class="co">#Bifurcación con %T&gt;%</span></a>
<a class="sourceLine" id="cb252-2" data-line-number="2">municipios <span class="op">%T&gt;%</span><span class="st">         </span><span class="co">#Marco la bifurcación</span></a>
<a class="sourceLine" id="cb252-3" data-line-number="3"><span class="st">  </span><span class="kw">print</span>() <span class="op">%&gt;%</span><span class="st">           </span><span class="co">#print() imprime los datos y pasa a la derecha los datos crudos, no su impresión.  </span></a>
<a class="sourceLine" id="cb252-4" data-line-number="4"><span class="st">  </span><span class="kw">group_by</span>(Estado) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb252-5" data-line-number="5"><span class="st">  </span><span class="kw">tally</span>() </a></code></pre></div>
<pre><code>## # A tibble: 9 x 3
##   Estado           Municipio          Población
##   &lt;chr&gt;            &lt;chr&gt;                  &lt;dbl&gt;
## 1 Chihuahua        Juárez               1391180
## 2 Nuevo León       Juárez                333481
## 3 Chiapas          Juárez                 21222
## 4 Chiapas          Unión Juárez           15350
## 5 Guerrero         Acapulco de Juárez    810669
## 6 Ciudad de México Milpa Alta            137927
## 7 Chihuahua        Batopilas               9751
## 8 Nuevo León       Apodaca               115913
## 9 Nuevo León       Carmen                  4906</code></pre>
<pre><code>## # A tibble: 5 x 2
##   Estado               n
##   &lt;chr&gt;            &lt;int&gt;
## 1 Chiapas              2
## 2 Chihuahua            2
## 3 Ciudad de México     1
## 4 Guerrero             1
## 5 Nuevo León           3</code></pre>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb255-1" data-line-number="1"><span class="co">#Uso de . en lugar de los datos.</span></a>
<a class="sourceLine" id="cb255-2" data-line-number="2">municipios <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb255-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Pob2 =</span> Población*<span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st">         </span><span class="co">#Creo una nueva variable numérica, el doble de la población. </span></a>
<a class="sourceLine" id="cb255-4" data-line-number="4"><span class="st">  </span><span class="kw">lm</span>(Pob2<span class="op">~</span>Población, <span class="dt">data=</span>.) <span class="op">%&gt;%</span><span class="st">         </span><span class="co">#Genero el modelo, en el argumento data= va el . Lo paso a la derecha.</span></a>
<a class="sourceLine" id="cb255-5" data-line-number="5"><span class="st">  </span><span class="kw">summary</span>()                              <span class="co">#Obtengo el sumario del modelo. R^2=1</span></a></code></pre></div>
<pre><code>## Warning in summary.lm(.): essentially perfect fit: summary may be
## unreliable</code></pre>
<pre><code>## 
## Call:
## lm(formula = Pob2 ~ Población, data = .)
## 
## Residuals:
##        Min         1Q     Median         3Q        Max 
## -9.832e-11 -2.564e-11  2.482e-11  2.540e-11  8.182e-11 
## 
## Coefficients:
##              Estimate Std. Error   t value Pr(&gt;|t|)    
## (Intercept) 1.552e-10  2.683e-11 5.786e+00 0.000673 ***
## Población   2.000e+00  4.865e-17 4.111e+16  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.6e-11 on 7 degrees of freedom
## Multiple R-squared:      1,  Adjusted R-squared:      1 
## F-statistic: 1.69e+33 on 1 and 7 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb258-1" data-line-number="1"><span class="co">#Bloque de código separado con {}.</span></a>
<a class="sourceLine" id="cb258-2" data-line-number="2">municipios <span class="op">%&gt;%</span><span class="st"> </span>{                                                   <span class="co">#Abro una llamada      </span></a>
<a class="sourceLine" id="cb258-3" data-line-number="3">  foo =<span class="st"> </span><span class="kw">rename</span>(., <span class="st">&quot;Est&quot;</span>=Estado, <span class="st">&quot;Mun&quot;</span>=Municipio, <span class="st">&quot;Pob&quot;</span>=Población)  <span class="co">#Cambios los nombres de colunma y los asigno a foo.</span></a>
<a class="sourceLine" id="cb258-4" data-line-number="4">  <span class="kw">print</span>(foo)                                                       <span class="co">#Imprimo foo</span></a>
<a class="sourceLine" id="cb258-5" data-line-number="5">  . <span class="er">}</span> <span class="op">%&gt;%</span><span class="st">                                                          </span><span class="co">#Regreso los datos originales &quot;.&quot; a la función de la derecha</span></a>
<a class="sourceLine" id="cb258-6" data-line-number="6"><span class="st">  </span><span class="kw">print</span>()                                                          <span class="co">#Imprimo los datos originales. </span></a></code></pre></div>
<pre><code>## # A tibble: 9 x 3
##   Est              Mun                    Pob
##   &lt;chr&gt;            &lt;chr&gt;                &lt;dbl&gt;
## 1 Chihuahua        Juárez             1391180
## 2 Nuevo León       Juárez              333481
## 3 Chiapas          Juárez               21222
## 4 Chiapas          Unión Juárez         15350
## 5 Guerrero         Acapulco de Juárez  810669
## 6 Ciudad de México Milpa Alta          137927
## 7 Chihuahua        Batopilas             9751
## 8 Nuevo León       Apodaca             115913
## 9 Nuevo León       Carmen                4906
## # A tibble: 9 x 3
##   Estado           Municipio          Población
##   &lt;chr&gt;            &lt;chr&gt;                  &lt;dbl&gt;
## 1 Chihuahua        Juárez               1391180
## 2 Nuevo León       Juárez                333481
## 3 Chiapas          Juárez                 21222
## 4 Chiapas          Unión Juárez           15350
## 5 Guerrero         Acapulco de Juárez    810669
## 6 Ciudad de México Milpa Alta            137927
## 7 Chihuahua        Batopilas               9751
## 8 Nuevo León       Apodaca               115913
## 9 Nuevo León       Carmen                  4906</code></pre>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb260-1" data-line-number="1"><span class="co">#Pasar vectores al lado derecho con %$%</span></a>
<a class="sourceLine" id="cb260-2" data-line-number="2">municipios <span class="op">%$%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb260-3" data-line-number="3"><span class="st">  </span><span class="kw">table</span> (Estado, Municipio)  <span class="op">%T&gt;%</span><span class="st">       </span><span class="co">#table se lleva mejor con vectores que con data.frame</span></a>
<a class="sourceLine" id="cb260-4" data-line-number="4"><span class="st">  </span><span class="kw">print</span>() <span class="op">%&gt;%</span><span class="st">                           </span><span class="co">#Imprimo la tabla</span></a>
<a class="sourceLine" id="cb260-5" data-line-number="5"><span class="st">  </span><span class="kw">chisq.test</span>()                          <span class="co">#Ajusto un modelo chi cuadrado y lo imprimo. </span></a></code></pre></div>
<pre><code>##                   Municipio
## Estado             Acapulco de Juárez Apodaca Batopilas Carmen Juárez
##   Chiapas                           0       0         0      0      1
##   Chihuahua                         0       0         1      0      1
##   Ciudad de México                  0       0         0      0      0
##   Guerrero                          1       0         0      0      0
##   Nuevo León                        0       1         0      1      1
##                   Municipio
## Estado             Milpa Alta Unión Juárez
##   Chiapas                   0            1
##   Chihuahua                 0            0
##   Ciudad de México          1            0
##   Guerrero                  0            0
##   Nuevo León                0            0</code></pre>
<pre><code>## Warning in chisq.test(.): Chi-squared approximation may be incorrect</code></pre>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  .
## X-squared = 28, df = 24, p-value = 0.26</code></pre>
</div>
</div>
<div id="limites-de-dplyr" class="section level2">
<h2><span class="header-section-number">3.7</span> Límites de <code>dplyr::</code></h2>
<p>La potencia y simplicidad del abordaje de <code>dplyr::</code> para la manipulación de datos no hace que esté excento de limitaciones.
El primer problema es conceptual: los datos aquí son una entidad abstracta. Lleva algún tiempo acotumbrarse a no tener un registro visual de nuestra materia de trabajo y todavía más a que ni siquiera tengan nombre. Sin embargo armando las cadenas paso a paso podremos ver en consola el output de cada función y tener claro que datos estamos pasando a la función siguiente. Y, en verdad, no tener que llevar registro de los múltiples nombres que nuestros datos pueden adquirir a lo largo del análisis es en realidad gran ventaja.
Otros problemas son tecnicos y demandan mucha flexibilidad y creatividad al momento de escribir código. Para mantenernos en el paradigma de programción funcional debemos buscar formas diferentes de lograr los mismo. La elegancia de <code>dplyr::</code> se debe en gran medida a que se concentra en una sola estructura de datos, el data.frame. Al hacerlo puede ocultar mucha de la complejidad de la manipulación de datos al usuario, conoce la estructura con la que trabaja y puede traducir los comandos simples que le introducimos a comandos mucho más complejos que son los que en realidad ejecuta. Con la elegancia viene una limitación: si necesitamos trabajar con una estructura de datos diferente al data.frame <code>dplyr::</code> fracasa completamente.
Valgan como ejemplo las dificultades para manejar dos versiones de los mismos datos en una misma cadena. <code>dplyr::</code> está pensado para trabajar con sólo con un conjunto de datos con estructura data.frame –cuando usamos un join estamos conviertiendo a dos conjuntos de datos en uno solo– en busca de un único resultado. Existen maneras de producir y generar el output de resultados intermedios, por ejemplo, usando la tubería %T&gt;% para salidas muy simples o generando una función lambda que encapsule el código de salida y regrese los datos al datos al final.</p>
<p>El mayor problema es lograr que las cadenas de <code>dplyr::</code> se lleven bien con algunas funciones más antiguas de R, sobre todo aquellas que reciben vectores atómicos como imput o producen listas como output. Esto es especialmente grave porque buena parte del atractivo de R es usar <em>esas</em> funciones específicas e irremplazables. ¿Le interesa el análisis de clases latentes multigrupos con ponderador muestral complejo? La librería LCA lo hace, pero el primer argumento de la función es un objeto de la clase fórmula y el resultado una lista de matrices de cuatro dimensiones, para las que <code>dplyr::</code> no será de ninugna ayuda. En este y otros casos <code>dplyr::</code> nos llevará hasta cierto punto, luego no habrá más opción que asignar un nombre al output de la cadena y seguir a pié<a href="#fn15" class="footnote-ref" id="fnref15"><sup>15</sup></a>. Si esto ocurriera solamente con funciones muy especializadas no sería un problema tan grande, pero ocurre en casos tan comunes como una prueba <span class="math inline">\(\chi\)</span><sup>2</sup>.<a href="#fn16" class="footnote-ref" id="fnref16"><sup>16</sup></a> Conocer estos límites será siempre de gran ayuda.</p>
<p>Otro potencial problema es que los métodos de <code>dplyr::</code> suelen fallar cuando la base de datos no está limpia y adecuadamente codificada, con los casos missing explícitamente señalados y sin errores de ortografía<a href="#fn17" class="footnote-ref" id="fnref17"><sup>17</sup></a>. Personalmente no creo que esto sea un problema, más bien es una virtud. Dar soluciones ad hoc a los errores de nuestros datos en el momento en el que lo necesitamos es una pésima práctica. Nos garantiza volveremos a encontrar con ese error u otro similar más abajo en el código. Es mejor arreglarlo desde un princio. Todavía mejor es generar una función personalizada que hace los arreglos necesarios e invocarla cada vez que es necesario. De este modo garantizamos la inmutabilidad de los datos. ¿Encontramos un nuevo error que había pasado inadvertido? Solo cambiamos esta función y cuando volvamos a ejecutar el código que la incluye realizará los cambios pertinentes. Un pilar del paradigma de programación funcional es que su entorno de trabajo debería estar poblado de funciones, no de estructuras de datos.</p>
</div>
<div id="manipulacion-con-dplyren-la-practica.-flujo-de-trabajo." class="section level2">
<h2><span class="header-section-number">3.8</span> Manipulación con <code>dplyr::</code>en la práctica. Flujo de trabajo.</h2>
<p>En términos muy estilizados el flujo de trabajo del análisis <strong>exploratorio</strong> de datos sería el siguiente.<a href="#fn18" class="footnote-ref" id="fnref18"><sup>18</sup></a></p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb264-1" data-line-number="1"><span class="kw">library</span>(DiagrammeR)</a>
<a class="sourceLine" id="cb264-2" data-line-number="2"><span class="kw">DiagrammeR</span>(<span class="st">&quot;</span></a>
<a class="sourceLine" id="cb264-3" data-line-number="3"><span class="st">  graph TB</span></a>
<a class="sourceLine" id="cb264-4" data-line-number="4"><span class="st">    Z(Desde .csv, Excel, SPSS, Stata, dBase, wescrapping, etc. &lt;br&gt; con readr)==&gt;A</span></a>
<a class="sourceLine" id="cb264-5" data-line-number="5"><span class="st">    A((Importar datos))--&gt;B((Limpiar la base &lt;br&gt; de errores))</span></a>
<a class="sourceLine" id="cb264-6" data-line-number="6"><span class="st">    N[Formato tidy &lt;br&gt; tidyr, dplyr] --- B</span></a>
<a class="sourceLine" id="cb264-7" data-line-number="7"><span class="st">    R[Nombres columna cortos&lt;br&gt;rename, colnames] ---B</span></a>
<a class="sourceLine" id="cb264-8" data-line-number="8"><span class="st">    B==&gt;C((Recodificar))</span></a>
<a class="sourceLine" id="cb264-9" data-line-number="9"><span class="st">    K[Casos perdidos explícitos&lt;br&gt;amelia, is.na]---C</span></a>
<a class="sourceLine" id="cb264-10" data-line-number="10"><span class="st">    M[Códigos homogéneos&lt;br&gt;recode, &lt;- ]---C</span></a>
<a class="sourceLine" id="cb264-11" data-line-number="11"><span class="st">    C==&gt;D((Explorar con &lt;br&gt;gráficos y sumarios))</span></a>
<a class="sourceLine" id="cb264-12" data-line-number="12"><span class="st">    O[Gráficos &lt;br&gt;base, ggplot]---D</span></a>
<a class="sourceLine" id="cb264-13" data-line-number="13"><span class="st">    P[Sumarios numéricos &lt;br&gt;skimr, summarise]---D</span></a>
<a class="sourceLine" id="cb264-14" data-line-number="14"><span class="st">    D==&gt;F((Modelar))</span></a>
<a class="sourceLine" id="cb264-15" data-line-number="15"><span class="st">    Q[Modelos lineales &lt;br&gt; lm, glm]---F</span></a>
<a class="sourceLine" id="cb264-16" data-line-number="16"><span class="st">    S[Clasificación&lt;br&gt;cluster, lca]---F</span></a>
<a class="sourceLine" id="cb264-17" data-line-number="17"><span class="st">T[Reducción de dimensionalidad&lt;br&gt;ca, mca, pca, fa]---F</span></a>
<a class="sourceLine" id="cb264-18" data-line-number="18"><span class="st">    D--&gt;G</span></a>
<a class="sourceLine" id="cb264-19" data-line-number="19"><span class="st">    F--Fortificar con modelos--&gt;G&gt;Salidas gráficas de alta calidad]</span></a>
<a class="sourceLine" id="cb264-20" data-line-number="20"><span class="st">    F==&gt;H&gt;Salidas en tablas formateadas]</span></a>
<a class="sourceLine" id="cb264-21" data-line-number="21"><span class="st">subgraph Integración con rmarkdown, knitr y pander</span></a>
<a class="sourceLine" id="cb264-22" data-line-number="22"><span class="st">    I&gt;Texto]--&gt; J[Reporte]</span></a>
<a class="sourceLine" id="cb264-23" data-line-number="23"><span class="st">    G--&gt;J</span></a>
<a class="sourceLine" id="cb264-24" data-line-number="24"><span class="st">    H--&gt;J</span></a>
<a class="sourceLine" id="cb264-25" data-line-number="25"><span class="st">end</span></a>
<a class="sourceLine" id="cb264-26" data-line-number="26"><span class="st">    style A fill:#00FF00</span></a>
<a class="sourceLine" id="cb264-27" data-line-number="27"><span class="st">    style B fill:#00FF00</span></a>
<a class="sourceLine" id="cb264-28" data-line-number="28"><span class="st">    style C fill:#00FF00</span></a>
<a class="sourceLine" id="cb264-29" data-line-number="29"><span class="st">    style D fill:#00FF00</span></a>
<a class="sourceLine" id="cb264-30" data-line-number="30"><span class="st">    style F fill:#00FF00</span></a>
<a class="sourceLine" id="cb264-31" data-line-number="31"><span class="st">    style J fill:#FF0000</span></a>
<a class="sourceLine" id="cb264-32" data-line-number="32"><span class="st">    style Z fill:#FF007C</span></a>
<a class="sourceLine" id="cb264-33" data-line-number="33"><span class="st">    style I fill:#EFFF00</span></a>
<a class="sourceLine" id="cb264-34" data-line-number="34"><span class="st">    style H fill:#EFFF00</span></a>
<a class="sourceLine" id="cb264-35" data-line-number="35"><span class="st">    style G fill:#EFFF00</span></a>
<a class="sourceLine" id="cb264-36" data-line-number="36"><span class="st">&quot;</span>)</a></code></pre></div>
<div id="htmlwidget-a88511907b1c2526008c" style="width:672px;height:480px;" class="DiagrammeR html-widget"></div>
<script type="application/json" data-for="htmlwidget-a88511907b1c2526008c">{"x":{"diagram":"\n  graph TB\n    Z(Desde .csv, Excel, SPSS, Stata, dBase, wescrapping, etc. <br> con readr)==>A\n    A((Importar datos))-->B((Limpiar la base <br> de errores))\n    N[Formato tidy <br> tidyr, dplyr] --- B\n    R[Nombres columna cortos<br>rename, colnames] ---B\n    B==>C((Recodificar))\n    K[Casos perdidos explícitos<br>amelia, is.na]---C\n    M[Códigos homogéneos<br>recode, <- ]---C\n    C==>D((Explorar con <br>gráficos y sumarios))\n    O[Gráficos <br>base, ggplot]---D\n    P[Sumarios numéricos <br>skimr, summarise]---D\n    D==>F((Modelar))\n    Q[Modelos lineales <br> lm, glm]---F\n    S[Clasificación<br>cluster, lca]---F\nT[Reducción de dimensionalidad<br>ca, mca, pca, fa]---F\n    D-->G\n    F--Fortificar con modelos-->G>Salidas gráficas de alta calidad]\n    F==>H>Salidas en tablas formateadas]\nsubgraph Integración con rmarkdown, knitr y pander\n    I>Texto]--> J[Reporte]\n    G-->J\n    H-->J\nend\n    style A fill:#00FF00\n    style B fill:#00FF00\n    style C fill:#00FF00\n    style D fill:#00FF00\n    style F fill:#00FF00\n    style J fill:#FF0000\n    style Z fill:#FF007C\n    style I fill:#EFFF00\n    style H fill:#EFFF00\n    style G fill:#EFFF00\n"},"evals":[],"jsHooks":[]}</script>
<div id="implementacion-en-dplyr-de-un-analisis-exploratorio-de-la-base-de-datos-indice-de-marginacion-del-conapo." class="section level3">
<h3><span class="header-section-number">3.8.1</span> Implementación en dplyr:: de un análisis exploratorio de la base de datos Índice de marginación del CONAPO.</h3>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb265-1" data-line-number="1"><span class="co">#Importación de datos.  </span></a>
<a class="sourceLine" id="cb265-2" data-line-number="2"><span class="co">#====================</span></a>
<a class="sourceLine" id="cb265-3" data-line-number="3"></a>
<a class="sourceLine" id="cb265-4" data-line-number="4"><span class="kw">library</span>(tidyverse)      <span class="co">#Carga varias librerías. </span></a>
<a class="sourceLine" id="cb265-5" data-line-number="5"><span class="kw">library</span>(readr)</a>
<a class="sourceLine" id="cb265-6" data-line-number="6">marginacion &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;datos/Base_Indice_de_marginacion_municipal_90-15.csv&quot;</span>, </a>
<a class="sourceLine" id="cb265-7" data-line-number="7">    <span class="dt">col_types =</span> <span class="kw">cols</span>(AÑ<span class="dt">O =</span> <span class="kw">col_character</span>(), </a>
<a class="sourceLine" id="cb265-8" data-line-number="8">                     <span class="dt">CVE_ENT =</span> <span class="kw">col_character</span>(), </a>
<a class="sourceLine" id="cb265-9" data-line-number="9">                     <span class="dt">CVE_MUN =</span> <span class="kw">col_character</span>(), </a>
<a class="sourceLine" id="cb265-10" data-line-number="10">                     <span class="dt">IM =</span> <span class="kw">col_double</span>(), </a>
<a class="sourceLine" id="cb265-11" data-line-number="11">                     <span class="dt">IND0A100 =</span> <span class="kw">col_double</span>(), </a>
<a class="sourceLine" id="cb265-12" data-line-number="12">                     <span class="dt">LUGAR_EST =</span> <span class="kw">col_integer</span>(), </a>
<a class="sourceLine" id="cb265-13" data-line-number="13">                     <span class="dt">LUG_NAC =</span> <span class="kw">col_integer</span>(), </a>
<a class="sourceLine" id="cb265-14" data-line-number="14">                     <span class="dt">OVPT =</span> <span class="kw">col_double</span>(), </a>
<a class="sourceLine" id="cb265-15" data-line-number="15">                     <span class="dt">OVSAE =</span> <span class="kw">col_double</span>(), </a>
<a class="sourceLine" id="cb265-16" data-line-number="16">                     <span class="dt">OVSD =</span> <span class="kw">col_double</span>(), </a>
<a class="sourceLine" id="cb265-17" data-line-number="17">                     <span class="dt">OVSDE =</span> <span class="kw">col_double</span>(), </a>
<a class="sourceLine" id="cb265-18" data-line-number="18">                     <span class="dt">OVSDSE =</span> <span class="kw">col_double</span>(),</a>
<a class="sourceLine" id="cb265-19" data-line-number="19">                     <span class="dt">OVSEE =</span> <span class="kw">col_double</span>(), </a>
<a class="sourceLine" id="cb265-20" data-line-number="20">                     <span class="st">`</span><span class="dt">PL&lt;5000</span><span class="st">`</span> =<span class="st"> </span><span class="kw">col_double</span>(), </a>
<a class="sourceLine" id="cb265-21" data-line-number="21">                     <span class="dt">PO2SM =</span> <span class="kw">col_double</span>(), </a>
<a class="sourceLine" id="cb265-22" data-line-number="22">                     <span class="dt">SPRIM =</span> <span class="kw">col_double</span>(), </a>
<a class="sourceLine" id="cb265-23" data-line-number="23">                     <span class="dt">VHAC =</span> <span class="kw">col_double</span>(), </a>
<a class="sourceLine" id="cb265-24" data-line-number="24">                     <span class="dt">VP =</span> <span class="kw">col_integer</span>()))</a>
<a class="sourceLine" id="cb265-25" data-line-number="25"></a>
<a class="sourceLine" id="cb265-26" data-line-number="26"><span class="co">#Sumario de datos. </span></a>
<a class="sourceLine" id="cb265-27" data-line-number="27"><span class="co">#==================</span></a>
<a class="sourceLine" id="cb265-28" data-line-number="28"></a>
<a class="sourceLine" id="cb265-29" data-line-number="29"><span class="co">#En tabla.</span></a>
<a class="sourceLine" id="cb265-30" data-line-number="30"></a>
<a class="sourceLine" id="cb265-31" data-line-number="31">marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb265-32" data-line-number="32"><span class="st">  </span><span class="kw">filter</span> (AÑO<span class="op">==</span><span class="st">&quot;2015&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb265-33" data-line-number="33"><span class="st">  </span><span class="kw">filter</span>(ENT <span class="op">!=</span><span class="st"> &quot;Nacional&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb265-34" data-line-number="34"><span class="st">  </span><span class="kw">select</span>(ENT, POB_TOT, ANALF, SPRIM, OVSDE, OVSEE, OVSAE, VHAC, OVPT, <span class="st">`</span><span class="dt">PL&lt;5000</span><span class="st">`</span>, IM) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb265-35" data-line-number="35"><span class="st">  </span><span class="kw">group_by</span>(ENT) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb265-36" data-line-number="36"><span class="st">  </span><span class="kw">summarise_if</span>(is.numeric, mean) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb265-37" data-line-number="37"><span class="st">  </span><span class="kw">kable</span>()</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">ENT</th>
<th align="right">POB_TOT</th>
<th align="right">ANALF</th>
<th align="right">SPRIM</th>
<th align="right">OVSDE</th>
<th align="right">OVSEE</th>
<th align="right">OVSAE</th>
<th align="right">VHAC</th>
<th align="right">OVPT</th>
<th align="right">PL&lt;5000</th>
<th align="right">IM</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Aguascalientes</td>
<td align="right">119322.182</td>
<td align="right">3.742727</td>
<td align="right">16.94182</td>
<td align="right">1.7936364</td>
<td align="right">0.7109091</td>
<td align="right">1.059091</td>
<td align="right">30.56545</td>
<td align="right">0.9800000</td>
<td align="right">64.14273</td>
<td align="right">-0.9220909</td>
</tr>
<tr class="even">
<td align="left">Baja California</td>
<td align="right">663153.200</td>
<td align="right">2.290000</td>
<td align="right">11.60800</td>
<td align="right">0.2840000</td>
<td align="right">0.7320000</td>
<td align="right">5.112000</td>
<td align="right">22.80600</td>
<td align="right">1.1980000</td>
<td align="right">17.95800</td>
<td align="right">-1.5100000</td>
</tr>
<tr class="odd">
<td align="left">Baja California Sur</td>
<td align="right">142405.800</td>
<td align="right">3.286000</td>
<td align="right">14.26400</td>
<td align="right">0.6220000</td>
<td align="right">1.7660000</td>
<td align="right">5.646000</td>
<td align="right">25.77200</td>
<td align="right">3.5420000</td>
<td align="right">20.50800</td>
<td align="right">-1.2734000</td>
</tr>
<tr class="even">
<td align="left">Campeche</td>
<td align="right">81811.909</td>
<td align="right">9.765455</td>
<td align="right">24.63182</td>
<td align="right">7.6072727</td>
<td align="right">2.4554545</td>
<td align="right">9.293636</td>
<td align="right">43.98727</td>
<td align="right">4.3109091</td>
<td align="right">51.22636</td>
<td align="right">-0.1338182</td>
</tr>
<tr class="odd">
<td align="left">Chiapas</td>
<td align="right">44219.559</td>
<td align="right">18.555000</td>
<td align="right">37.32525</td>
<td align="right">3.2210169</td>
<td align="right">2.5353390</td>
<td align="right">14.180254</td>
<td align="right">50.12686</td>
<td align="right">13.1866949</td>
<td align="right">77.97992</td>
<td align="right">0.8246441</td>
</tr>
<tr class="even">
<td align="left">Chihuahua</td>
<td align="right">53083.194</td>
<td align="right">7.732687</td>
<td align="right">28.63343</td>
<td align="right">5.5500000</td>
<td align="right">6.3325373</td>
<td align="right">6.109552</td>
<td align="right">24.84925</td>
<td align="right">4.2826866</td>
<td align="right">75.10388</td>
<td align="right">-0.3207761</td>
</tr>
<tr class="odd">
<td align="left">Coahuila de Zaragoza</td>
<td align="right">77760.921</td>
<td align="right">3.323947</td>
<td align="right">14.95868</td>
<td align="right">1.2457895</td>
<td align="right">0.5836842</td>
<td align="right">2.510000</td>
<td align="right">27.05868</td>
<td align="right">0.7865789</td>
<td align="right">50.04605</td>
<td align="right">-1.1691579</td>
</tr>
<tr class="even">
<td align="left">Colima</td>
<td align="right">71123.500</td>
<td align="right">5.338000</td>
<td align="right">19.42100</td>
<td align="right">0.8040000</td>
<td align="right">0.4560000</td>
<td align="right">1.325000</td>
<td align="right">28.11500</td>
<td align="right">2.8980000</td>
<td align="right">37.90100</td>
<td align="right">-1.0235000</td>
</tr>
<tr class="odd">
<td align="left">Distrito Federal</td>
<td align="right">557415.812</td>
<td align="right">1.484375</td>
<td align="right">6.54125</td>
<td align="right">0.0512500</td>
<td align="right">0.0587500</td>
<td align="right">1.699375</td>
<td align="right">19.61938</td>
<td align="right">0.5768750</td>
<td align="right">1.82750</td>
<td align="right">-1.7696875</td>
</tr>
<tr class="even">
<td align="left">Durango</td>
<td align="right">44993.692</td>
<td align="right">5.490513</td>
<td align="right">24.51410</td>
<td align="right">8.1528205</td>
<td align="right">4.3300000</td>
<td align="right">5.350256</td>
<td align="right">28.28538</td>
<td align="right">6.5307692</td>
<td align="right">77.56103</td>
<td align="right">-0.3135128</td>
</tr>
<tr class="odd">
<td align="left">Guanajuato</td>
<td align="right">127253.848</td>
<td align="right">9.311087</td>
<td align="right">25.26043</td>
<td align="right">6.1306522</td>
<td align="right">1.2017391</td>
<td align="right">5.195870</td>
<td align="right">28.34065</td>
<td align="right">2.5854348</td>
<td align="right">58.49174</td>
<td align="right">-0.5252609</td>
</tr>
<tr class="even">
<td align="left">Guerrero</td>
<td align="right">43620.383</td>
<td align="right">20.072346</td>
<td align="right">36.44296</td>
<td align="right">18.7496296</td>
<td align="right">3.5571605</td>
<td align="right">19.495432</td>
<td align="right">47.65679</td>
<td align="right">17.8380247</td>
<td align="right">76.35198</td>
<td align="right">1.1077284</td>
</tr>
<tr class="odd">
<td align="left">Hidalgo</td>
<td align="right">34028.083</td>
<td align="right">11.103571</td>
<td align="right">23.64464</td>
<td align="right">4.2801190</td>
<td align="right">1.6080952</td>
<td align="right">7.736667</td>
<td align="right">31.16429</td>
<td align="right">3.9871429</td>
<td align="right">76.37321</td>
<td align="right">-0.2994524</td>
</tr>
<tr class="even">
<td align="left">Jalisco</td>
<td align="right">62758.640</td>
<td align="right">6.836480</td>
<td align="right">25.36800</td>
<td align="right">3.4060800</td>
<td align="right">1.3576800</td>
<td align="right">2.905440</td>
<td align="right">26.87056</td>
<td align="right">3.0661600</td>
<td align="right">58.44288</td>
<td align="right">-0.7477440</td>
</tr>
<tr class="odd">
<td align="left">México</td>
<td align="right">129500.864</td>
<td align="right">5.687920</td>
<td align="right">17.20704</td>
<td align="right">4.4409600</td>
<td align="right">0.8722400</td>
<td align="right">5.760800</td>
<td align="right">33.22464</td>
<td align="right">3.2542400</td>
<td align="right">51.59408</td>
<td align="right">-0.7597600</td>
</tr>
<tr class="even">
<td align="left">Michoacán de Ocampo</td>
<td align="right">40570.540</td>
<td align="right">11.181416</td>
<td align="right">32.40504</td>
<td align="right">3.7654867</td>
<td align="right">1.2617699</td>
<td align="right">4.832920</td>
<td align="right">31.17097</td>
<td align="right">7.2984071</td>
<td align="right">64.93726</td>
<td align="right">-0.1986372</td>
</tr>
<tr class="odd">
<td align="left">Morelos</td>
<td align="right">57691.242</td>
<td align="right">6.195455</td>
<td align="right">18.33333</td>
<td align="right">1.7030303</td>
<td align="right">0.5633333</td>
<td align="right">9.861212</td>
<td align="right">31.24424</td>
<td align="right">4.9187879</td>
<td align="right">47.28121</td>
<td align="right">-0.6802424</td>
</tr>
<tr class="even">
<td align="left">Nayarit</td>
<td align="right">59052.500</td>
<td align="right">7.631000</td>
<td align="right">23.97050</td>
<td align="right">8.7990000</td>
<td align="right">5.0060000</td>
<td align="right">6.799500</td>
<td align="right">32.67350</td>
<td align="right">6.9410000</td>
<td align="right">63.14500</td>
<td align="right">-0.2349000</td>
</tr>
<tr class="odd">
<td align="left">Nuevo León</td>
<td align="right">100382.431</td>
<td align="right">3.787059</td>
<td align="right">18.57353</td>
<td align="right">0.9839216</td>
<td align="right">0.7858824</td>
<td align="right">4.066471</td>
<td align="right">28.11275</td>
<td align="right">1.9998039</td>
<td align="right">54.41549</td>
<td align="right">-1.0942157</td>
</tr>
<tr class="even">
<td align="left">Oaxaca</td>
<td align="right">6961.209</td>
<td align="right">16.805281</td>
<td align="right">36.09884</td>
<td align="right">2.8206316</td>
<td align="right">3.1497544</td>
<td align="right">11.066702</td>
<td align="right">40.27021</td>
<td align="right">15.8554737</td>
<td align="right">91.27837</td>
<td align="right">0.6180772</td>
</tr>
<tr class="odd">
<td align="left">Puebla</td>
<td align="right">28428.032</td>
<td align="right">14.312074</td>
<td align="right">32.72539</td>
<td align="right">3.2478802</td>
<td align="right">1.6124885</td>
<td align="right">9.253088</td>
<td align="right">42.44691</td>
<td align="right">8.8613364</td>
<td align="right">76.21313</td>
<td align="right">0.3278249</td>
</tr>
<tr class="even">
<td align="left">Querétaro de Arteaga</td>
<td align="right">113242.889</td>
<td align="right">8.568333</td>
<td align="right">21.90611</td>
<td align="right">6.3483333</td>
<td align="right">1.7050000</td>
<td align="right">7.095556</td>
<td align="right">33.48778</td>
<td align="right">2.5894444</td>
<td align="right">72.44111</td>
<td align="right">-0.5086111</td>
</tr>
<tr class="odd">
<td align="left">Quintana Roo</td>
<td align="right">150156.200</td>
<td align="right">6.969000</td>
<td align="right">18.39200</td>
<td align="right">5.9530000</td>
<td align="right">2.1370000</td>
<td align="right">3.057000</td>
<td align="right">44.57200</td>
<td align="right">4.2250000</td>
<td align="right">36.24100</td>
<td align="right">-0.5632000</td>
</tr>
<tr class="even">
<td align="left">San Luis Potosí</td>
<td align="right">46858.966</td>
<td align="right">10.375862</td>
<td align="right">28.86793</td>
<td align="right">4.1108621</td>
<td align="right">3.9877586</td>
<td align="right">18.568103</td>
<td align="right">32.10621</td>
<td align="right">8.2081034</td>
<td align="right">72.41879</td>
<td align="right">0.1196552</td>
</tr>
<tr class="odd">
<td align="left">Sinaloa</td>
<td align="right">164795.611</td>
<td align="right">6.652778</td>
<td align="right">23.66000</td>
<td align="right">5.4638889</td>
<td align="right">1.3066667</td>
<td align="right">5.844444</td>
<td align="right">34.63333</td>
<td align="right">5.2383333</td>
<td align="right">57.53611</td>
<td align="right">-0.5440556</td>
</tr>
<tr class="even">
<td align="left">Sonora</td>
<td align="right">39587.917</td>
<td align="right">3.589583</td>
<td align="right">20.41347</td>
<td align="right">1.8644444</td>
<td align="right">1.9793056</td>
<td align="right">2.133056</td>
<td align="right">24.85278</td>
<td align="right">2.8312500</td>
<td align="right">70.84097</td>
<td align="right">-0.9675694</td>
</tr>
<tr class="odd">
<td align="left">Tabasco</td>
<td align="right">140898.353</td>
<td align="right">6.646471</td>
<td align="right">20.33588</td>
<td align="right">2.3741176</td>
<td align="right">0.6641176</td>
<td align="right">11.327647</td>
<td align="right">35.55588</td>
<td align="right">4.0582353</td>
<td align="right">63.79412</td>
<td align="right">-0.5448235</td>
</tr>
<tr class="even">
<td align="left">Tamaulipas</td>
<td align="right">80039.488</td>
<td align="right">6.232791</td>
<td align="right">25.30000</td>
<td align="right">1.2079070</td>
<td align="right">1.6497674</td>
<td align="right">8.213023</td>
<td align="right">30.23977</td>
<td align="right">3.3969767</td>
<td align="right">61.80233</td>
<td align="right">-0.5246512</td>
</tr>
<tr class="odd">
<td align="left">Tlaxcala</td>
<td align="right">21214.117</td>
<td align="right">4.319667</td>
<td align="right">13.79917</td>
<td align="right">1.5933333</td>
<td align="right">0.5343333</td>
<td align="right">1.108333</td>
<td align="right">34.21767</td>
<td align="right">2.1665000</td>
<td align="right">48.54050</td>
<td align="right">-0.8518333</td>
</tr>
<tr class="even">
<td align="left">Veracruz de Ignacio de la Llave</td>
<td align="right">38266.533</td>
<td align="right">14.142076</td>
<td align="right">33.53835</td>
<td align="right">2.4762736</td>
<td align="right">2.2141038</td>
<td align="right">15.555425</td>
<td align="right">37.42741</td>
<td align="right">8.2850943</td>
<td align="right">70.83278</td>
<td align="right">0.2541981</td>
</tr>
<tr class="odd">
<td align="left">Yucatán</td>
<td align="right">19784.670</td>
<td align="right">12.498207</td>
<td align="right">32.09783</td>
<td align="right">17.5136792</td>
<td align="right">1.6091509</td>
<td align="right">1.710189</td>
<td align="right">46.18566</td>
<td align="right">2.0950000</td>
<td align="right">70.62226</td>
<td align="right">0.2529906</td>
</tr>
<tr class="even">
<td align="left">Zacatecas</td>
<td align="right">27227.741</td>
<td align="right">5.970172</td>
<td align="right">25.48672</td>
<td align="right">4.7017241</td>
<td align="right">0.8882759</td>
<td align="right">3.074483</td>
<td align="right">26.84828</td>
<td align="right">1.6341379</td>
<td align="right">71.13603</td>
<td align="right">-0.6136034</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb266-1" data-line-number="1"><span class="co">#Gráfico condensado para variables numéricas. </span></a>
<a class="sourceLine" id="cb266-2" data-line-number="2"></a>
<a class="sourceLine" id="cb266-3" data-line-number="3"></a>
<a class="sourceLine" id="cb266-4" data-line-number="4"><span class="kw">library</span>(corrplot)</a>
<a class="sourceLine" id="cb266-5" data-line-number="5">marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb266-6" data-line-number="6"><span class="st">  </span><span class="kw">filter</span> (AÑO<span class="op">==</span><span class="st">&quot;2015&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb266-7" data-line-number="7"><span class="st">  </span><span class="kw">filter</span>(ENT<span class="op">!=</span><span class="st">&quot;Nacional&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb266-8" data-line-number="8"><span class="st">  </span><span class="kw">select</span>(POB_TOT, ANALF, SPRIM, OVSDE, OVSEE, OVSAE, VHAC, OVPT, <span class="st">`</span><span class="dt">PL&lt;5000</span><span class="st">`</span>, PO2SM, IM) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb266-9" data-line-number="9"><span class="st">  </span><span class="kw">cor</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb266-10" data-line-number="10"><span class="st">  </span><span class="kw">corrplot</span>() </a></code></pre></div>
<p><img src="libRo_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="7">
<li id="fn7"><p>Ya sea utilizando la API especificada por un proveedor de datos o programando a una función para que recorra en sitios web, redes sociales, etc., idetifique ciertos patrones de texto y los alamacene.<a href="manejo.html#fnref7" class="footnote-back">↩</a></p></li>
<li id="fn8"><p>Y preferiblemente cortos: en R no seleccionamos las columnas con un menú, introducimos sus nombres en la consola: elija bien esos nombres, los tipeará una y otra vez.<a href="manejo.html#fnref8" class="footnote-back">↩</a></p></li>
<li id="fn9"><p>Similar en concepto a | de UNIX.<a href="manejo.html#fnref9" class="footnote-back">↩</a></p></li>
<li id="fn10"><p>Los restantes operadores son <code>%T&gt;%</code>, que hace una bifurcación y para dar output a un paso intermedio y <code>%$&gt;%</code>, que regresa el output como un conjunto de vectores en lugar de un data.frame.<a href="manejo.html#fnref10" class="footnote-back">↩</a></p></li>
<li id="fn11"><p>Esto no significa que deba tener el mismo número de filas que de columnas, esos serían datos cuadrados, un caso especial de los datos rectangulares.<a href="manejo.html#fnref11" class="footnote-back">↩</a></p></li>
<li id="fn12"><p>R impide intrínsecamente llevar a caso semejante mala práctica.<a href="manejo.html#fnref12" class="footnote-back">↩</a></p></li>
<li id="fn13"><p>Si cree que esta desprolijidad se debe a las malas prácticas de la frutería poco sabia en cuestiones de manejo de dato considere que las bases de datos del Banco Mundial suelen tener esta estructura.<a href="manejo.html#fnref13" class="footnote-back">↩</a></p></li>
<li id="fn14"><p>La sintaxis de gather() puede ser algo complicada, sin embargo una interfaz gráfica llamada <code>tidyshiny()</code> nos puede asistir en el proceso dándonos retroalimentación inmediata. Dado que no está en el repositorio CRAN la instalación es algo más complicada que lo usual, pero puede hacerlo con esta línea que resolverá previamente las dependencia: <code>if(!require(tidyr)) {install.packages(&quot;devtools&quot;)} ; library(devtools); install_github(&quot;MangoTheCat/tidyshiny&quot;)</code>. Úsela desde Rstudio en el botón Addins, debajo del menú.<a href="manejo.html#fnref14" class="footnote-back">↩</a></p></li>
<li id="fn15"><p>Una recomendación en estos casos es remover del entorno el objeto de datos al que asignamos nombre después de utilizarlo. Ya ha cumplido su función, deberíamos descartarlo.<a href="manejo.html#fnref15" class="footnote-back">↩</a></p></li>
<li id="fn16"><p><code>chsiq.test()</code> admite una tabla como imput, <code>table()</code> produce tablas, pero recibe vectores como imput.<a href="manejo.html#fnref16" class="footnote-back">↩</a></p></li>
<li id="fn17"><p>Los errores ortográficos o de estilo en la codificación de una base de datos son un tema menor. Para R “México”, “MEXICO”, “Mexico”, “méxico” son cuatro cadenas de caracteres completamente diferentes.<a href="manejo.html#fnref17" class="footnote-back">↩</a></p></li>
<li id="fn18"><p>Nótese el énfasis en exploratorio. Este flujo de trabajo no está organizado alrededor de una hipótesis y utiliza poco o nada del conocimiento disponible sobre un tema. Al carecer de estado del arte y de marco de hipótesis no es un proceso de investigación. Está orientado a familizarizarnos con los datos, identificar y visualizar patrones y relaciones y, en el mejor de los casos, generar nuevas hipótesis. Dicho sea de paso, ni R ni ninguna plataforma de software producen buena investigación o análisis lúcidos, use dplyr, R base o papel y lápiz. A lo sumo pueden facilitarnos los aspectos técnicos y dejarnos más tiempo disponible para investigar o analizar.<a href="manejo.html#fnref18" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="investigacion-reproducible-.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="graficos.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["libRo.pdf", "libRo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
