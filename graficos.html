<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>R para Ciencias Sociales</title>
  <meta name="description" content="Análisis de datos con R, con aplicación a las ciencias sociales">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="R para Ciencias Sociales" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Análisis de datos con R, con aplicación a las ciencias sociales" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R para Ciencias Sociales" />
  
  <meta name="twitter:description" content="Análisis de datos con R, con aplicación a las ciencias sociales" />
  

<meta name="author" content="Martín Paladino">


<meta name="date" content="2018-08-10">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="manejo.html">
<link rel="next" href="analisis-de-datos-categoricos.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<script src="libs/d3-3.3.8/d3.min.js"></script>
<script src="libs/dagre-0.4.0/dagre-d3.min.js"></script>
<link href="libs/mermaid-0.3.0/dist/mermaid.css" rel="stylesheet" />
<script src="libs/mermaid-0.3.0/dist/mermaid.slim.min.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/chromatography-0.1/chromatography.js"></script>
<script src="libs/DiagrammeR-binding-1.0.0/DiagrammeR.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R para ciencias sociales</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preámbulo</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#para-quien-es-este-libro"><i class="fa fa-check"></i><b>0.1</b> ¿Para quién es este libro?</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#el-tidyverse"><i class="fa fa-check"></i><b>0.2</b> El <code>tidyverse</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="introduccion.html"><a href="introduccion.html"><i class="fa fa-check"></i>Introducción</a><ul>
<li class="chapter" data-level="0.3" data-path="introduccion.html"><a href="introduccion.html#que-es-r"><i class="fa fa-check"></i><b>0.3</b> ¿Qué es R?</a><ul>
<li class="chapter" data-level="0.3.1" data-path="introduccion.html"><a href="introduccion.html#el-lenguaje-de-programacion-r"><i class="fa fa-check"></i><b>0.3.1</b> El <em>lenguaje de programación R</em></a></li>
<li class="chapter" data-level="0.3.2" data-path="introduccion.html"><a href="introduccion.html#el-interprete"><i class="fa fa-check"></i><b>0.3.2</b> El <em>intérprete</em></a></li>
</ul></li>
<li class="chapter" data-level="0.4" data-path="introduccion.html"><a href="introduccion.html#instalacion-de-r-y-rstudio-en-windows."><i class="fa fa-check"></i><b>0.4</b> Instalación de R y Rstudio en Windows.</a></li>
<li class="chapter" data-level="0.5" data-path="introduccion.html"><a href="introduccion.html#interface-de-rstudio."><i class="fa fa-check"></i><b>0.5</b> Interface de Rstudio.</a><ul>
<li class="chapter" data-level="0.5.1" data-path="introduccion.html"><a href="introduccion.html#consola."><i class="fa fa-check"></i><b>0.5.1</b> Consola.</a></li>
<li class="chapter" data-level="0.5.2" data-path="introduccion.html"><a href="introduccion.html#editor-de-archivos."><i class="fa fa-check"></i><b>0.5.2</b> Editor de Archivos.</a></li>
<li class="chapter" data-level="0.5.3" data-path="introduccion.html"><a href="introduccion.html#entorno-de-trabajo."><i class="fa fa-check"></i><b>0.5.3</b> Entorno de trabajo.</a></li>
<li class="chapter" data-level="0.5.4" data-path="introduccion.html"><a href="introduccion.html#graficos."><i class="fa fa-check"></i><b>0.5.4</b> Gráficos.</a></li>
<li class="chapter" data-level="0.5.5" data-path="introduccion.html"><a href="introduccion.html#ayuda."><i class="fa fa-check"></i><b>0.5.5</b> Ayuda.</a></li>
<li class="chapter" data-level="0.5.6" data-path="introduccion.html"><a href="introduccion.html#paquetes-de-extension."><i class="fa fa-check"></i><b>0.5.6</b> Paquetes de extensión.</a></li>
</ul></li>
<li class="chapter" data-level="0.6" data-path="introduccion.html"><a href="introduccion.html#tipos-y-estructuras-de-datos"><i class="fa fa-check"></i><b>0.6</b> Tipos y estructuras de datos</a><ul>
<li class="chapter" data-level="0.6.1" data-path="introduccion.html"><a href="introduccion.html#tipos-de-datos"><i class="fa fa-check"></i><b>0.6.1</b> Tipos de datos</a></li>
<li class="chapter" data-level="0.6.2" data-path="introduccion.html"><a href="introduccion.html#estructuras-de-datos."><i class="fa fa-check"></i><b>0.6.2</b> Estructuras de datos.</a></li>
</ul></li>
<li class="chapter" data-level="0.7" data-path="introduccion.html"><a href="introduccion.html#orientacion-a-objetos."><i class="fa fa-check"></i><b>0.7</b> Orientación a objetos.</a></li>
<li class="chapter" data-level="0.8" data-path="introduccion.html"><a href="introduccion.html#programacion-funcional."><i class="fa fa-check"></i><b>0.8</b> Programación funcional.</a></li>
<li class="chapter" data-level="0.9" data-path="introduccion.html"><a href="introduccion.html#vocabulario."><i class="fa fa-check"></i><b>0.9</b> Vocabulario.</a></li>
<li class="chapter" data-level="0.10" data-path="introduccion.html"><a href="introduccion.html#funciones-y-librerias-de-funciones."><i class="fa fa-check"></i><b>0.10</b> Funciones y librerías de funciones.</a></li>
<li class="chapter" data-level="0.11" data-path="introduccion.html"><a href="introduccion.html#convenciones-de-estilo-de-este-documento."><i class="fa fa-check"></i><b>0.11</b> Convenciones de estilo de este documento.</a></li>
<li class="chapter" data-level="0.12" data-path="introduccion.html"><a href="introduccion.html#bloques-de-codigo-y-comentarios."><i class="fa fa-check"></i><b>0.12</b> Bloques de código y comentarios.</a></li>
<li class="chapter" data-level="0.13" data-path="introduccion.html"><a href="introduccion.html#uso-de-mayusculas."><i class="fa fa-check"></i><b>0.13</b> Uso de mayúsculas.</a></li>
<li class="chapter" data-level="0.14" data-path="introduccion.html"><a href="introduccion.html#sobre-el-estilo-de-programacion-en-r."><i class="fa fa-check"></i><b>0.14</b> Sobre el estilo de programación en R.</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="primeros.html"><a href="primeros.html"><i class="fa fa-check"></i><b>1</b> Primeros pasos en R</a><ul>
<li class="chapter" data-level="1.1" data-path="primeros.html"><a href="primeros.html#crear-un-proyecto."><i class="fa fa-check"></i><b>1.1</b> Crear un proyecto.</a></li>
<li class="chapter" data-level="1.2" data-path="primeros.html"><a href="primeros.html#sintaxis-de-r-operadores-y-operandos."><i class="fa fa-check"></i><b>1.2</b> Sintaxis de R: operadores y operandos.</a></li>
<li class="chapter" data-level="1.3" data-path="primeros.html"><a href="primeros.html#sintaxis-de-r-funciones-y-argumentos."><i class="fa fa-check"></i><b>1.3</b> Sintaxis de R: funciones y argumentos.</a></li>
<li class="chapter" data-level="1.4" data-path="primeros.html"><a href="primeros.html#vectores-y-atributos-de-los-vectores."><i class="fa fa-check"></i><b>1.4</b> Vectores y atributos de los vectores.</a></li>
<li class="chapter" data-level="1.5" data-path="primeros.html"><a href="primeros.html#manipulacion-de-datos."><i class="fa fa-check"></i><b>1.5</b> Manipulación de datos.</a></li>
<li class="chapter" data-level="1.6" data-path="primeros.html"><a href="primeros.html#funcion-para-calcular-una-mediana-con-funciones-primitivas-de-r."><i class="fa fa-check"></i><b>1.6</b> Función para calcular una mediana con funciones primitivas de R.</a></li>
<li class="chapter" data-level="1.7" data-path="primeros.html"><a href="primeros.html#manipulacion-de-estructuras-de-datos."><i class="fa fa-check"></i><b>1.7</b> Manipulación de estructuras de datos.</a><ul>
<li class="chapter" data-level="1.7.1" data-path="primeros.html"><a href="primeros.html#magia"><i class="fa fa-check"></i><b>1.7.1</b> Magia</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="primeros.html"><a href="primeros.html#sobre-los-archivos-de-sintaxis."><i class="fa fa-check"></i><b>1.8</b> Sobre los archivos de sintaxis.</a></li>
<li class="chapter" data-level="1.9" data-path="primeros.html"><a href="primeros.html#anexo"><i class="fa fa-check"></i><b>1.9</b> Anexo</a><ul>
<li class="chapter" data-level="1.9.1" data-path="primeros.html"><a href="primeros.html#operadores-binarios-de-r"><i class="fa fa-check"></i><b>1.9.1</b> Operadores binarios de R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="investigacion-reproducible-.html"><a href="investigacion-reproducible-.html"><i class="fa fa-check"></i><b>2</b> Investigación reproducible.</a><ul>
<li class="chapter" data-level="2.1" data-path="investigacion-reproducible-.html"><a href="investigacion-reproducible-.html#introduccion-alcances-del-problema."><i class="fa fa-check"></i><b>2.1</b> Introducción: alcances del problema.</a></li>
<li class="chapter" data-level="2.2" data-path="investigacion-reproducible-.html"><a href="investigacion-reproducible-.html#investigacion-reproducible.-1"><i class="fa fa-check"></i><b>2.2</b> Investigación reproducible.</a><ul>
<li class="chapter" data-level="2.2.1" data-path="investigacion-reproducible-.html"><a href="investigacion-reproducible-.html#ventajas-de-la-investigacion-reproducible."><i class="fa fa-check"></i><b>2.2.1</b> Ventajas de la investigación reproducible.</a></li>
<li class="chapter" data-level="2.2.2" data-path="investigacion-reproducible-.html"><a href="investigacion-reproducible-.html#desafios-de-la-investigacion-reproducible."><i class="fa fa-check"></i><b>2.2.2</b> Desafíos de la investigación reproducible.</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="investigacion-reproducible-.html"><a href="investigacion-reproducible-.html#filosofia-programacion-funcional-con-inmutabilidad-de-datos-transparencia-referencial-y-funciones-puras."><i class="fa fa-check"></i><b>2.3</b> Filosofía: programación funcional con inmutabilidad de datos, transparencia referencial y funciones puras.</a></li>
<li class="chapter" data-level="2.4" data-path="investigacion-reproducible-.html"><a href="investigacion-reproducible-.html#hagamos-pizza-en-r."><i class="fa fa-check"></i><b>2.4</b> Hagamos pizza en R.</a><ul>
<li class="chapter" data-level="2.4.1" data-path="investigacion-reproducible-.html"><a href="investigacion-reproducible-.html#pizzeria-el-asignador.-pizzas-de-hoy-y-de-ayer."><i class="fa fa-check"></i><b>2.4.1</b> Pizzería “El asignador”. Pizzas de hoy y de ayer.</a></li>
<li class="chapter" data-level="2.4.2" data-path="investigacion-reproducible-.html"><a href="investigacion-reproducible-.html#pizzeria-la-funcional-clasica.-el-cambio-se-lo-da-en-parentesis."><i class="fa fa-check"></i><b>2.4.2</b> Pizzería La funcional clásica. El cambio se lo da en paréntesis.</a></li>
<li class="chapter" data-level="2.4.3" data-path="investigacion-reproducible-.html"><a href="investigacion-reproducible-.html#pizzeria-magrittr-la-mas-del-rumbo"><i class="fa fa-check"></i><b>2.4.3</b> Pizzería magrittr ¡La más %&gt;% del rumbo!</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="manejo.html"><a href="manejo.html"><i class="fa fa-check"></i><b>3</b> Manejo da datos</a><ul>
<li class="chapter" data-level="3.1" data-path="manejo.html"><a href="manejo.html#el-objeto-de-este-documento."><i class="fa fa-check"></i><b>3.1</b> El objeto de este documento.</a></li>
<li class="chapter" data-level="3.2" data-path="manejo.html"><a href="manejo.html#manipulacion-de-datos-con-tidyverse"><i class="fa fa-check"></i><b>3.2</b> Manipulación de datos con <code>tidyverse::</code></a></li>
<li class="chapter" data-level="3.3" data-path="manejo.html"><a href="manejo.html#la-forma-de-los-datos."><i class="fa fa-check"></i><b>3.3</b> La forma de los datos.</a><ul>
<li class="chapter" data-level="3.3.1" data-path="manejo.html"><a href="manejo.html#sumarios-de-datos-o-base-de-datos"><i class="fa fa-check"></i><b>3.3.1</b> ¿Sumarios de datos o base de datos?</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="manejo.html"><a href="manejo.html#datos-rectangulares."><i class="fa fa-check"></i><b>3.4</b> Datos rectangulares.</a><ul>
<li class="chapter" data-level="3.4.1" data-path="manejo.html"><a href="manejo.html#datos-prolijos-tidy-data"><i class="fa fa-check"></i><b>3.4.1</b> Datos prolijos (tidy data)</a></li>
<li class="chapter" data-level="3.4.2" data-path="manejo.html"><a href="manejo.html#reformateo-de-datos."><i class="fa fa-check"></i><b>3.4.2</b> Reformateo de datos.</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="manejo.html"><a href="manejo.html#manejo-de-datos-con-dplyr"><i class="fa fa-check"></i><b>3.5</b> Manejo de datos con <code>dplyr::</code></a><ul>
<li class="chapter" data-level="3.5.1" data-path="manejo.html"><a href="manejo.html#verbos-basicos-de-dplyr"><i class="fa fa-check"></i><b>3.5.1</b> Verbos básicos de <code>dplyr::</code></a></li>
<li class="chapter" data-level="3.5.2" data-path="manejo.html"><a href="manejo.html#uso-de-la-de-sintaxis-de-dplyr"><i class="fa fa-check"></i><b>3.5.2</b> Uso de la de sintaxis de <code>dplyr::</code></a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="manejo.html"><a href="manejo.html#uso-avanzado-de-dplyr"><i class="fa fa-check"></i><b>3.6</b> Uso avanzado de <code>dplyr::</code></a><ul>
<li class="chapter" data-level="3.6.1" data-path="manejo.html"><a href="manejo.html#alternar-entre-formato-largo-y-ancho."><i class="fa fa-check"></i><b>3.6.1</b> Alternar entre formato largo y ancho.</a></li>
<li class="chapter" data-level="3.6.2" data-path="manejo.html"><a href="manejo.html#seleccionar-las-columnas-que-cumplen-determinada-condicion."><i class="fa fa-check"></i><b>3.6.2</b> Seleccionar las columnas que cumplen determinada condición.</a></li>
<li class="chapter" data-level="3.6.3" data-path="manejo.html"><a href="manejo.html#filtrar-por-mas-de-una-condicion-o-dentro-de-un-conjunto."><i class="fa fa-check"></i><b>3.6.3</b> Filtrar por más de una condición o dentro de un conjunto.</a></li>
<li class="chapter" data-level="3.6.4" data-path="manejo.html"><a href="manejo.html#transformacion-avanzada-de-datos."><i class="fa fa-check"></i><b>3.6.4</b> Transformacion avanzada de datos.</a></li>
<li class="chapter" data-level="3.6.5" data-path="manejo.html"><a href="manejo.html#sumarios-avanzados."><i class="fa fa-check"></i><b>3.6.5</b> Sumarios avanzados.</a></li>
<li class="chapter" data-level="3.6.6" data-path="manejo.html"><a href="manejo.html#funciones-avanzadas-de-combinacion-de-bases-de-datos."><i class="fa fa-check"></i><b>3.6.6</b> Funciones avanzadas de combinación de bases de datos.</a></li>
<li class="chapter" data-level="3.6.7" data-path="manejo.html"><a href="manejo.html#operadores-avanzados-de-magrittr"><i class="fa fa-check"></i><b>3.6.7</b> Operadores avanzados de <code>magrittr::</code></a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="manejo.html"><a href="manejo.html#limites-de-dplyr"><i class="fa fa-check"></i><b>3.7</b> Límites de <code>dplyr::</code></a></li>
<li class="chapter" data-level="3.8" data-path="manejo.html"><a href="manejo.html#manipulacion-con-dplyren-la-practica.-flujo-de-trabajo."><i class="fa fa-check"></i><b>3.8</b> Manipulación con <code>dplyr::</code>en la práctica. Flujo de trabajo.</a><ul>
<li class="chapter" data-level="3.8.1" data-path="manejo.html"><a href="manejo.html#implementacion-en-dplyr-de-un-analisis-exploratorio-de-la-base-de-datos-indice-de-marginacion-del-conapo."><i class="fa fa-check"></i><b>3.8.1</b> Implementación en dplyr:: de un análisis exploratorio de la base de datos Índice de marginación del CONAPO.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="graficos.html"><a href="graficos.html"><i class="fa fa-check"></i><b>4</b> Gráficos con R y ggplot</a><ul>
<li class="chapter" data-level="4.1" data-path="graficos.html"><a href="graficos.html#acerca-de-este-documento."><i class="fa fa-check"></i><b>4.1</b> Acerca de este documento.</a></li>
<li class="chapter" data-level="4.2" data-path="graficos.html"><a href="graficos.html#la-gramatica-de-los-graficos."><i class="fa fa-check"></i><b>4.2</b> La gramática de los gráficos.</a><ul>
<li class="chapter" data-level="4.2.1" data-path="graficos.html"><a href="graficos.html#filosofia."><i class="fa fa-check"></i><b>4.2.1</b> Filosofía.</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="graficos.html"><a href="graficos.html#la-gramatica-de-los-graficos-aplicada-en-ggplot."><i class="fa fa-check"></i><b>4.3</b> La gramática de los gráficos aplicada en <code>ggplot()</code>.</a></li>
<li class="chapter" data-level="4.4" data-path="graficos.html"><a href="graficos.html#la-base-de-datos."><i class="fa fa-check"></i><b>4.4</b> La base de datos.</a><ul>
<li class="chapter" data-level="4.4.1" data-path="graficos.html"><a href="graficos.html#indice-de-marginacion-por-municipios-1990-2015."><i class="fa fa-check"></i><b>4.4.1</b> Índice de marginación por municipios 1990-2015.</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="graficos.html"><a href="graficos.html#descripcion-rapida-de-la-base-de-datos."><i class="fa fa-check"></i><b>4.5</b> Descripción rápida de la base de datos.</a><ul>
<li class="chapter" data-level="4.5.1" data-path="graficos.html"><a href="graficos.html#nombres-cortos-y-largos."><i class="fa fa-check"></i><b>4.5.1</b> Nombres cortos y largos.</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="graficos.html"><a href="graficos.html#grafico-basico."><i class="fa fa-check"></i><b>4.6</b> Gráfico básico.</a><ul>
<li class="chapter" data-level="4.6.1" data-path="graficos.html"><a href="graficos.html#construccion-de-un-grafico-de-barras-paso-a-paso."><i class="fa fa-check"></i><b>4.6.1</b> Construcción de un gráfico de barras paso a paso.</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="graficos.html"><a href="graficos.html#personalizacion-de-grafico."><i class="fa fa-check"></i><b>4.7</b> Personalización de gráfico.</a><ul>
<li class="chapter" data-level="4.7.1" data-path="graficos.html"><a href="graficos.html#orden-manual-de-las-categorias."><i class="fa fa-check"></i><b>4.7.1</b> Orden manual de las categorías.</a></li>
<li class="chapter" data-level="4.7.2" data-path="graficos.html"><a href="graficos.html#orden-automatico-de-categorias."><i class="fa fa-check"></i><b>4.7.2</b> Orden automático de categorías.</a></li>
<li class="chapter" data-level="4.7.3" data-path="graficos.html"><a href="graficos.html#titulo-subtitulo-titulos-de-ejes-vineta"><i class="fa fa-check"></i><b>4.7.3</b> Título, subtítulo, títulos de ejes, viñeta</a></li>
<li class="chapter" data-level="4.7.4" data-path="graficos.html"><a href="graficos.html#estilos-visuales."><i class="fa fa-check"></i><b>4.7.4</b> Estilos visuales.</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="graficos.html"><a href="graficos.html#graficos-intermedios-mas-de-una-serie-de-datos"><i class="fa fa-check"></i><b>4.8</b> Gráficos intermedios (más de una serie de datos)</a><ul>
<li class="chapter" data-level="4.8.1" data-path="graficos.html"><a href="graficos.html#datos-formato-de-datos-largo-y-ancho."><i class="fa fa-check"></i><b>4.8.1</b> Datos Formato de datos largo y ancho.</a></li>
<li class="chapter" data-level="4.8.2" data-path="graficos.html"><a href="graficos.html#grafico-de-barras-lado-a-lado."><i class="fa fa-check"></i><b>4.8.2</b> Gráfico de barras lado a lado.</a></li>
<li class="chapter" data-level="4.8.3" data-path="graficos.html"><a href="graficos.html#graficos-multipanel."><i class="fa fa-check"></i><b>4.8.3</b> Gráficos multipanel.</a></li>
<li class="chapter" data-level="4.8.4" data-path="graficos.html"><a href="graficos.html#grafico-de-punto."><i class="fa fa-check"></i><b>4.8.4</b> Gráfico de punto.</a></li>
<li class="chapter" data-level="4.8.5" data-path="graficos.html"><a href="graficos.html#grafico-de-punto-y-linea."><i class="fa fa-check"></i><b>4.8.5</b> Gráfico de punto y línea.</a></li>
<li class="chapter" data-level="4.8.6" data-path="graficos.html"><a href="graficos.html#grafico-de-dispersion."><i class="fa fa-check"></i><b>4.8.6</b> Gráfico de dispersión.</a></li>
<li class="chapter" data-level="4.8.7" data-path="graficos.html"><a href="graficos.html#grafico-de-dispersion-en-paneles."><i class="fa fa-check"></i><b>4.8.7</b> Gráfico de dispersión en paneles.</a></li>
<li class="chapter" data-level="4.8.8" data-path="graficos.html"><a href="graficos.html#grafico-de-caja."><i class="fa fa-check"></i><b>4.8.8</b> Gráfico de caja.</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="graficos.html"><a href="graficos.html#personalizacion-avanzada-de-graficos."><i class="fa fa-check"></i><b>4.9</b> Personalización avanzada de gráficos.</a><ul>
<li class="chapter" data-level="4.9.1" data-path="graficos.html"><a href="graficos.html#etiquetas-y-elementos-de-texto."><i class="fa fa-check"></i><b>4.9.1</b> Etiquetas y elementos de texto.</a></li>
<li class="chapter" data-level="4.9.2" data-path="graficos.html"><a href="graficos.html#ajuste-del-elemento-texto."><i class="fa fa-check"></i><b>4.9.2</b> Ajuste del elemento texto.</a></li>
<li class="chapter" data-level="4.9.3" data-path="graficos.html"><a href="graficos.html#posicion-de-las-leyendas."><i class="fa fa-check"></i><b>4.9.3</b> Posición de las leyendas.</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="graficos.html"><a href="graficos.html#escalas."><i class="fa fa-check"></i><b>4.10</b> Escalas.</a><ul>
<li class="chapter" data-level="4.10.1" data-path="graficos.html"><a href="graficos.html#escalas-y-sistemas-de-coordenadas"><i class="fa fa-check"></i><b>4.10.1</b> Escalas y sistemas de coordenadas</a></li>
<li class="chapter" data-level="4.10.2" data-path="graficos.html"><a href="graficos.html#ajuste-manual-de-intervalos-de-escala."><i class="fa fa-check"></i><b>4.10.2</b> Ajuste manual de intervalos de escala.</a></li>
<li class="chapter" data-level="4.10.3" data-path="graficos.html"><a href="graficos.html#transformacion-de-escalas"><i class="fa fa-check"></i><b>4.10.3</b> Transformación de escalas</a></li>
</ul></li>
<li class="chapter" data-level="4.11" data-path="graficos.html"><a href="graficos.html#sistemas-de-coordenadas."><i class="fa fa-check"></i><b>4.11</b> Sistemas de coordenadas.</a><ul>
<li class="chapter" data-level="4.11.1" data-path="graficos.html"><a href="graficos.html#coordenadas-polares."><i class="fa fa-check"></i><b>4.11.1</b> Coordenadas polares.</a></li>
</ul></li>
<li class="chapter" data-level="4.12" data-path="graficos.html"><a href="graficos.html#fortificar-nuestros-graficos-con-datos-de-un-modelo"><i class="fa fa-check"></i><b>4.12</b> Fortificar nuestros gráficos con datos de un modelo</a><ul>
<li class="chapter" data-level="4.12.1" data-path="graficos.html"><a href="graficos.html#rectas-de-ajuste"><i class="fa fa-check"></i><b>4.12.1</b> Rectas de ajuste</a></li>
<li class="chapter" data-level="4.12.2" data-path="graficos.html"><a href="graficos.html#intervalos-de-confianza-y-barras-de-error."><i class="fa fa-check"></i><b>4.12.2</b> Intervalos de confianza y barras de error.</a></li>
<li class="chapter" data-level="4.12.3" data-path="graficos.html"><a href="graficos.html#etiquetado-de-casos."><i class="fa fa-check"></i><b>4.12.3</b> Etiquetado de casos.</a></li>
</ul></li>
<li class="chapter" data-level="4.13" data-path="graficos.html"><a href="graficos.html#extensiones-a-ggplot2"><i class="fa fa-check"></i><b>4.13</b> Extensiones a <code>ggplot2::</code></a></li>
<li class="chapter" data-level="4.14" data-path="graficos.html"><a href="graficos.html#etiquetas"><i class="fa fa-check"></i><b>4.14</b> Etiquetas</a><ul>
<li class="chapter" data-level="4.14.1" data-path="graficos.html"><a href="graficos.html#grafico-de-dispersion-con-histogramas-marginales."><i class="fa fa-check"></i><b>4.14.1</b> Gráfico de dispersión con histogramas marginales.</a></li>
<li class="chapter" data-level="4.14.2" data-path="graficos.html"><a href="graficos.html#graficos-de-proporciones-jerarquicas."><i class="fa fa-check"></i><b>4.14.2</b> Gráficos de proporciones jerárquicas.</a></li>
<li class="chapter" data-level="4.14.3" data-path="graficos.html"><a href="graficos.html#im-feeling-lucky"><i class="fa fa-check"></i><b>4.14.3</b> I’m feeling lucky…</a></li>
<li class="chapter" data-level="4.14.4" data-path="graficos.html"><a href="graficos.html#relaciones-multivariadas."><i class="fa fa-check"></i><b>4.14.4</b> Relaciones multivariadas.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html"><i class="fa fa-check"></i><b>5</b> Análisis de datos categóricos</a><ul>
<li class="chapter" data-level="5.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#introduccion-1"><i class="fa fa-check"></i><b>5.1</b> Introducción</a><ul>
<li class="chapter" data-level="5.1.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#datos-categoricos"><i class="fa fa-check"></i><b>5.1.1</b> Datos categóricos</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#tablas"><i class="fa fa-check"></i><b>5.2</b> Tablas</a><ul>
<li class="chapter" data-level="5.2.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#tablas-de-contingencia-de-dos-dimensiones."><i class="fa fa-check"></i><b>5.2.1</b> Tablas de contingencia de dos dimensiones.</a></li>
<li class="chapter" data-level="5.2.2" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#tablas-de-contingencia-en-r."><i class="fa fa-check"></i><b>5.2.2</b> Tablas de contingencia en R.</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#prueba-de-hipotesis-de-independencia-estadistica-para-tablas-de-contingencia."><i class="fa fa-check"></i><b>5.3</b> Prueba de hipótesis de independencia estadística para tablas de contingencia.</a><ul>
<li class="chapter" data-level="5.3.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#el-modelo-de-independencia."><i class="fa fa-check"></i><b>5.3.1</b> El modelo de independencia.</a></li>
<li class="chapter" data-level="5.3.2" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#prueba-de-independencia-para-una-tabla-bidimensional."><i class="fa fa-check"></i><b>5.3.2</b> Prueba de independencia para una tabla bidimensional.</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#analisis-de-los-residuos."><i class="fa fa-check"></i><b>5.4</b> Análisis de los residuos.</a><ul>
<li class="chapter" data-level="5.4.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#prueba-chi2-en-r."><i class="fa fa-check"></i><b>5.4.1</b> Prueba <span class="math inline">\(\chi\)</span><sup>2</sup> en R.</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#metodos-graficos-para-tablas-de-contingencia."><i class="fa fa-check"></i><b>5.5</b> Métodos gráficos para tablas de contingencia.</a><ul>
<li class="chapter" data-level="5.5.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#modelos-loglineales-para-datos-categoricos."><i class="fa fa-check"></i><b>5.5.1</b> Modelos loglineales para datos categóricos.</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#analisis-practico-de-datos-categoricos."><i class="fa fa-check"></i><b>5.6</b> Análisis práctico de datos categóricos.</a><ul>
<li class="chapter" data-level="5.6.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#la-base-de-datos.-1"><i class="fa fa-check"></i><b>5.6.1</b> La base de datos.</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#genero-y-partido-politico."><i class="fa fa-check"></i><b>5.7</b> Género y partido político.</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="lineales.html"><a href="lineales.html"><i class="fa fa-check"></i><b>6</b> Modelos lineales</a><ul>
<li class="chapter" data-level="6.1" data-path="lineales.html"><a href="lineales.html#introduccion-2"><i class="fa fa-check"></i><b>6.1</b> Introducción</a></li>
<li class="chapter" data-level="6.2" data-path="lineales.html"><a href="lineales.html#ajuste-de-modelo-lineales-con-lm"><i class="fa fa-check"></i><b>6.2</b> Ajuste de modelo lineales con <code>lm()</code></a><ul>
<li class="chapter" data-level="6.2.1" data-path="lineales.html"><a href="lineales.html#sumario-de-un-modelo."><i class="fa fa-check"></i><b>6.2.1</b> Sumario de un modelo.</a></li>
<li class="chapter" data-level="6.2.2" data-path="lineales.html"><a href="lineales.html#interpretacion-basica-del-sumario-de-un-modelo."><i class="fa fa-check"></i><b>6.2.2</b> Interpretación básica del sumario de un modelo.</a></li>
<li class="chapter" data-level="6.2.3" data-path="lineales.html"><a href="lineales.html#intervalos-de-confianza."><i class="fa fa-check"></i><b>6.2.3</b> Intervalos de confianza.</a></li>
<li class="chapter" data-level="6.2.4" data-path="lineales.html"><a href="lineales.html#valores-estimados-y-residuos."><i class="fa fa-check"></i><b>6.2.4</b> Valores estimados y residuos.</a></li>
<li class="chapter" data-level="6.2.5" data-path="lineales.html"><a href="lineales.html#prediccion-del-modelo."><i class="fa fa-check"></i><b>6.2.5</b> Predicción del modelo.</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="lineales.html"><a href="lineales.html#modelos-lineales-con-mas-de-una-variable-independiente."><i class="fa fa-check"></i><b>6.3</b> Modelos lineales con más de una variable independiente.</a><ul>
<li class="chapter" data-level="6.3.1" data-path="lineales.html"><a href="lineales.html#exploracion-de-datos-multivariados."><i class="fa fa-check"></i><b>6.3.1</b> Exploración de datos multivariados.</a></li>
<li class="chapter" data-level="6.3.2" data-path="lineales.html"><a href="lineales.html#especificacion-de-modelos-con-multiples-variables-independientes."><i class="fa fa-check"></i><b>6.3.2</b> Especificación de modelos con múltiples variables independientes.</a></li>
<li class="chapter" data-level="6.3.3" data-path="lineales.html"><a href="lineales.html#comparar-modelos-lineales-multiples."><i class="fa fa-check"></i><b>6.3.3</b> Comparar modelos lineales múltiples.</a></li>
<li class="chapter" data-level="6.3.4" data-path="lineales.html"><a href="lineales.html#imprimir-un-sumario-de-varios-modelos."><i class="fa fa-check"></i><b>6.3.4</b> Imprimir un sumario de varios modelos.</a></li>
<li class="chapter" data-level="6.3.5" data-path="lineales.html"><a href="lineales.html#imprimir-un-sumario-formateado-de-varios-modelos."><i class="fa fa-check"></i><b>6.3.5</b> Imprimir un sumario formateado de varios modelos.</a></li>
<li class="chapter" data-level="6.3.6" data-path="lineales.html"><a href="lineales.html#anova-de-varios-modelos."><i class="fa fa-check"></i><b>6.3.6</b> ANOVA de varios modelos.</a></li>
<li class="chapter" data-level="6.3.7" data-path="lineales.html"><a href="lineales.html#criterio-de-informacion-de-akaike."><i class="fa fa-check"></i><b>6.3.7</b> Criterio de información de Akaike.</a></li>
<li class="chapter" data-level="6.3.8" data-path="lineales.html"><a href="lineales.html#modelos-lineales-con-variables-independientes-categoricas."><i class="fa fa-check"></i><b>6.3.8</b> Modelos lineales con variables independientes categóricas.</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="lineales.html"><a href="lineales.html#supuestos-de-un-modelo-lineal."><i class="fa fa-check"></i><b>6.4</b> Supuestos de un modelo lineal.</a><ul>
<li class="chapter" data-level="6.4.1" data-path="lineales.html"><a href="lineales.html#normalidad."><i class="fa fa-check"></i><b>6.4.1</b> Normalidad.</a></li>
<li class="chapter" data-level="6.4.2" data-path="lineales.html"><a href="lineales.html#independencia."><i class="fa fa-check"></i><b>6.4.2</b> Independencia.</a></li>
<li class="chapter" data-level="6.4.3" data-path="lineales.html"><a href="lineales.html#linealidad."><i class="fa fa-check"></i><b>6.4.3</b> Linealidad.</a></li>
<li class="chapter" data-level="6.4.4" data-path="lineales.html"><a href="lineales.html#homocedasticidad."><i class="fa fa-check"></i><b>6.4.4</b> Homocedasticidad.</a></li>
<li class="chapter" data-level="6.4.5" data-path="lineales.html"><a href="lineales.html#casos-atipicos."><i class="fa fa-check"></i><b>6.4.5</b> Casos atípicos.</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="lineales.html"><a href="lineales.html#regresion-robusta."><i class="fa fa-check"></i><b>6.5</b> Regresión robusta.</a></li>
<li class="chapter" data-level="6.6" data-path="lineales.html"><a href="lineales.html#supuestos-de-los-modelos-lineales-problemas-y-soluciones."><i class="fa fa-check"></i><b>6.6</b> Supuestos de los modelos lineales: problemas y soluciones.</a></li>
<li class="chapter" data-level="6.7" data-path="lineales.html"><a href="lineales.html#funciones-adicionales-para-modelos-lineales."><i class="fa fa-check"></i><b>6.7</b> Funciones adicionales para modelos lineales.</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="generalizados.html"><a href="generalizados.html"><i class="fa fa-check"></i><b>7</b> Modelos lineales generalizados</a><ul>
<li class="chapter" data-level="7.1" data-path="generalizados.html"><a href="generalizados.html#introduccion."><i class="fa fa-check"></i><b>7.1</b> Introducción.</a></li>
<li class="chapter" data-level="7.2" data-path="generalizados.html"><a href="generalizados.html#ajuste-de-modelos-logit-con-glm"><i class="fa fa-check"></i><b>7.2</b> Ajuste de modelos logit con <code>glm()</code></a><ul>
<li class="chapter" data-level="7.2.1" data-path="generalizados.html"><a href="generalizados.html#presentacion-de-los-datos."><i class="fa fa-check"></i><b>7.2.1</b> Presentación de los datos.</a></li>
<li class="chapter" data-level="7.2.2" data-path="generalizados.html"><a href="generalizados.html#un-modelo-lineal-con-glm"><i class="fa fa-check"></i><b>7.2.2</b> Un modelo lineal con <code>glm()</code></a></li>
<li class="chapter" data-level="7.2.3" data-path="generalizados.html"><a href="generalizados.html#la-ordenada-al-origen-de-un-modelo-logit."><i class="fa fa-check"></i><b>7.2.3</b> La ordenada al origen de un modelo logit.</a></li>
<li class="chapter" data-level="7.2.4" data-path="generalizados.html"><a href="generalizados.html#estimacion-de-beta_1"><i class="fa fa-check"></i><b>7.2.4</b> Estimación de <span class="math inline">\(\beta_1\)</span></a></li>
<li class="chapter" data-level="7.2.5" data-path="generalizados.html"><a href="generalizados.html#modelo-logit-con-dos-variables-independientes."><i class="fa fa-check"></i><b>7.2.5</b> Modelo logit con dos variables independientes.</a></li>
<li class="chapter" data-level="7.2.6" data-path="generalizados.html"><a href="generalizados.html#modelo-logit-con-multiples-variables-dependientes."><i class="fa fa-check"></i><b>7.2.6</b> Modelo logit con múltiples variables dependientes.</a></li>
<li class="chapter" data-level="7.2.7" data-path="generalizados.html"><a href="generalizados.html#pruebas-de-significancia."><i class="fa fa-check"></i><b>7.2.7</b> Pruebas de significancia.</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="generalizados.html"><a href="generalizados.html#presentacion-de-resultados."><i class="fa fa-check"></i><b>7.3</b> Presentación de resultados.</a><ul>
<li class="chapter" data-level="7.3.1" data-path="generalizados.html"><a href="generalizados.html#intervalos-de-confianza.-1"><i class="fa fa-check"></i><b>7.3.1</b> Intervalos de confianza.</a></li>
<li class="chapter" data-level="7.3.2" data-path="generalizados.html"><a href="generalizados.html#grafico-de-coeficientes."><i class="fa fa-check"></i><b>7.3.2</b> Gráfico de coeficientes.</a></li>
<li class="chapter" data-level="7.3.3" data-path="generalizados.html"><a href="generalizados.html#tabla-y-grafico-de-efectos-totales-promedio."><i class="fa fa-check"></i><b>7.3.3</b> Tabla y gráfico de efectos totales promedio.</a></li>
<li class="chapter" data-level="7.3.4" data-path="generalizados.html"><a href="generalizados.html#sumario-de-efectos-marginales."><i class="fa fa-check"></i><b>7.3.4</b> Sumario de efectos marginales.</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="generalizados.html"><a href="generalizados.html#modelos-ligit-multinomiales."><i class="fa fa-check"></i><b>7.4</b> Modelos ligit multinomiales.</a><ul>
<li class="chapter" data-level="7.4.1" data-path="generalizados.html"><a href="generalizados.html#ajuste-de-modelos-logit-multinomiales-com-multinom"><i class="fa fa-check"></i><b>7.4.1</b> Ajuste de modelos logit multinomiales com <code>multinom()</code></a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="generalizados.html"><a href="generalizados.html#anexo-i.-probabilidades-y-razones-de-probabilidad."><i class="fa fa-check"></i><b>7.5</b> Anexo I. Probabilidades y razones de probabilidad.</a></li>
<li class="chapter" data-level="7.6" data-path="generalizados.html"><a href="generalizados.html#anexo-ii.-asterisco-sobre-los-asteriscos."><i class="fa fa-check"></i><b>7.6</b> Anexo II. Asterisco sobre los asteriscos.</a></li>
<li class="chapter" data-level="7.7" data-path="generalizados.html"><a href="generalizados.html#anexo-iii.-tipos-de-variables-independiente-y-modelo-lineal-apropiado."><i class="fa fa-check"></i><b>7.7</b> Anexo III. Tipos de variables independiente y modelo lineal apropiado.</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="martinpaladino.github.com" target="blank">Martín Paladino</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R para Ciencias Sociales</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="graficos" class="section level1">
<h1><span class="header-section-number">Capítulo 4</span> Gráficos con R y ggplot</h1>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb267-1" data-line-number="1"><span class="kw">library</span>(tidyverse)         <span class="co">#Muchas librerías en una: dplyr, ggplot, tibble, tidyr, readr, etc.</span></a>
<a class="sourceLine" id="cb267-2" data-line-number="2"><span class="kw">library</span> (knitr)            <span class="co">#Aquí por kable, para generar tablas formatedas.</span></a>
<a class="sourceLine" id="cb267-3" data-line-number="3"><span class="kw">library</span> (Amelia)           <span class="co">#Diagnóstico e imputación de casos perdidos. Cortesía de 1er K del KKV.</span></a>
<a class="sourceLine" id="cb267-4" data-line-number="4"><span class="kw">library</span> (stringr)          <span class="co">#Manipulación de cadenas de caracteres.</span></a>
<a class="sourceLine" id="cb267-5" data-line-number="5"><span class="kw">library</span>(extrafont)         <span class="co">#Tipografías personalizadas. </span></a>
<a class="sourceLine" id="cb267-6" data-line-number="6"><span class="kw">library</span>(scales)            <span class="co">#Para manipular escalas en ggplot.</span></a>
<a class="sourceLine" id="cb267-7" data-line-number="7"><span class="kw">library</span>(ggrepel)</a>
<a class="sourceLine" id="cb267-8" data-line-number="8"><span class="kw">library</span>(treemapify)        <span class="co">#detools::install_github(&quot;wilkox/treemapify&quot;) </span></a>
<a class="sourceLine" id="cb267-9" data-line-number="9"><span class="kw">library</span>(ggExtra)</a>
<a class="sourceLine" id="cb267-10" data-line-number="10"><span class="kw">library</span>(GGally)</a>
<a class="sourceLine" id="cb267-11" data-line-number="11"><span class="kw">library</span>(plotluck)          <span class="co">#devtools::install_github(&quot;stefan-schroedl/plotluck&quot;)</span></a>
<a class="sourceLine" id="cb267-12" data-line-number="12"><span class="kw">library</span>(readr)</a></code></pre></div>
<div id="acerca-de-este-documento." class="section level2">
<h2><span class="header-section-number">4.1</span> Acerca de este documento.</h2>
<p>Este documento es una guía práctica para graficar en R usando las librerías <code>dplyr::</code> para manipulación de datos y <code>ggplot2::</code> para generar gráficos.
Quienes tengan interés en la manipulación de datos pueden leer la Guía práctica para manipulación de datos en R. Quienes prefieran utilizar la sintaxis de <code>qplot()</code> para hacer gráficos rápidos con una sintaxis simplificada pueden leer la Guía práctica de gráficos con <code>qplot()</code>, que también incluye algunos gráficos preconfigurados que facilitarán la exploración.
El objetivo de esta guía es familiarizar al lector con la lógica y la sintaxis de ambas librerías, de modo que puedan utilizarlas para explorar datos y comunicar resultados de investigación a través de visualizaciones.
Todos los ejemplos se presentan con la sintaxis completa para su ejecución y abundantes comentarios explicando que hace cada línea. Los comentarios al código están antecedidos por el símbolo <code>#</code>, como está especificado en R.
El código está en formato largo, es decir, cada función y los argumento de algunas funciones se presenta en una nueva línea, separada dos espacios del margen o alineada con el paréntesis correspondiente.</p>
</div>
<div id="la-gramatica-de-los-graficos." class="section level2">
<h2><span class="header-section-number">4.2</span> La gramática de los gráficos.</h2>
<div id="filosofia." class="section level3">
<h3><span class="header-section-number">4.2.1</span> Filosofía.</h3>
<p>La gramática de los gráficos movernos del paradigma de los <em>tipos</em> de gráficos y centrarnos en los <em>elmentos</em> que constituyen un gráficos estadístico, tanto aquellos que son directamente visibles en el resultado final como aquelos que, sin bien no estan directamnete a la vista, configuran a los elementos visibles. Identificando claramente a los elementos podemos encadernalos y del mismo modo en que encadenamos palabras para producir oraciones podemos encadenar elementos para producir gráficos y comrpender gráficos.</p>
<table>
<caption>Elementos de la gramática de los gráficos</caption>
<colgroup>
<col width="14%" />
<col width="8%" />
<col width="52%" />
<col width="24%" />
</colgroup>
<thead>
<tr class="header">
<th>Elemento</th>
<th>Visible</th>
<th></th>
<th>Algunos…</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Geométricos</td>
<td>Sí</td>
<td>Son las marcas en el espacio que representan a los datos.</td>
<td>Puntos, líneas, polígonos, rectángulos</td>
</tr>
<tr class="even">
<td>Mapeo de datos</td>
<td>No</td>
<td>Es la especificación de las series de datos controlan propiedades los elementos geométricos</td>
<td>x, y, color, relleno, forma</td>
</tr>
<tr class="odd">
<td>Transformación</td>
<td>No</td>
<td>Es la especificación de transformación de datos mapeados a datos representables en el espacio</td>
<td>Conteos, medias, errores típicos, modelos</td>
</tr>
<tr class="even">
<td>Escala</td>
<td>Sí</td>
<td>Señalan la relación entre una serie numéricas –variable– y el lugar que los elementos geométricos ocupan en el espacio.</td>
<td>Ejes, marcas, etiquetas</td>
</tr>
<tr class="odd">
<td>Coordenadas</td>
<td>No</td>
<td>Controlan la proyección de una serie numérica al espacio bidimensional de un gráfico</td>
<td>Cartesianas, polares, ternarias, fijas</td>
</tr>
<tr class="even">
<td>Anotaciones</td>
<td>Sí</td>
<td>Agregan información al gráfico en forma de texto, los produce directamente el usuar io</td>
<td>Título, subtítulo, viñeta.</td>
</tr>
</tbody>
</table>
<p>A partir de estos elementos podríamos definir a un gráfico de barras como aquel cuyos elementos geométricos son rectángulos, en el que está mapeada una variable categórica en el eje x, que crea una variable continua para el eje y a partir de una tranformación que reporta los conteos para cada categoría de esa variable, que tiene una escala discreta para el eje x y una continua en el eje y y se representa en un espacio cartesino.</p>
</div>
</div>
<div id="la-gramatica-de-los-graficos-aplicada-en-ggplot." class="section level2">
<h2><span class="header-section-number">4.3</span> La gramática de los gráficos aplicada en <code>ggplot()</code>.</h2>
<p>En la gramática de los gráficos tienen cinco componentes básicos a partir de los que podemos controlar prácticamente todos los aspectos de un gráfico. <code>ggplot()</code> los implementa en su sintaxis. Varias de los elementos se crean por defecto, por ejemplo a partir del mapeo de datos <code>ggplot()</code> crea la escala con sus marcas y etiquetas. En el caso de las coordenadas siempre toma por defecto un sistema cartesiano. En todos los casos podemos modificar posteriormente estos valores por defecto.</p>
<ul>
<li>Una especificación de mapeo a variables.
<ul>
<li>Pueden remitir tanto a los ejes del gráfico (x, y)</li>
<li>como a otras propiedades como colores, símbolos, tamaños, tipografías, tipos de líneas, etc.</li>
<li>En <code>ggplot()</code> se especifican con los argumentos pasados a <code>aes()</code>.</li>
</ul></li>
<li>Un sistema de coordenadas.
<ul>
<li>Controla la proyección de los datos numéricos al espacio.</li>
<li>Por defecto <code>ggpplot()</code> crea un sistema de coordenadas cartesiano con los ejes x y y,</li>
<li>Podemos cambiarlo a coordenadas polares, ternarias o proyecciones cartográficas.</li>
<li>Se puede modificar agregando <code>+ coord_*</code>, donde <code>*</code> es cualquier sistema de coordenados incluido en <code>ggplot()</code> o sus extensiones.</li>
</ul></li>
<li>Una escala.
<ul>
<li>Controla la relación entre la serie numérica que estamos representando y su representación en el espacio.</li>
<li>Por defecto <code>ggplot()</code> crea una escala natural para los ejes en el que estos extienden un poco más que las observaciones máximas y mínimas.
<ul>
<li>Por defecto <code>ggplot()</code> ubica a los ejes en el 0 de la escala.</li>
<li>Podemos cambiar la escala a través de una transformación, por ejemplo, pasando de escala natural a logarítmica.</li>
</ul></li>
<li>Por defecto <code>ggplot()</code> crea marcas y etiquetas de escala en número cerrados (unidades, decenas, centenas, miles, etc. ), dependiendo del rango de nuestros datos.
<ul>
<li>Es posible cambiar la cantidad y ubicación de marcas y/o etiquetas de escala.</li>
</ul></li>
<li>Se puede modificar agregando <code>+ scale_*_°</code>, donde <code>*</code> es el eje que vamos a modificar y <code>°</code> el tipo de escala que estamos usando: continua o discreta.</li>
</ul></li>
<li>Una transformación estadística.
<ul>
<li>Controla la transformación necesaria de los datos para su representación.
<ul>
<li>Por ejemplo, realiza los conteos de frecuencias para un gráfico de barras o un histograma.</li>
<li>O transformaciones más complejas como las necesarias para un boxplot.</li>
</ul></li>
<li>No aplica a todos los gráficos y existe la posibilidad de hacerla nosotros mismos y pasar los datos transformados a <code>ggplot()</code>.</li>
<li>Se puede modificar con el argumento <code>stat= &quot;*&quot;</code>, donde <code>*</code> es la transformación que queremos realizar. <code>stat = identity</code> para no hacer ninguna transformación y lo usamos cuando la provee el usuario.</li>
</ul></li>
<li>Un elemento geométrico.
<ul>
<li>Es el elemento que representa a los datos en el gráfico.</li>
<li>Podemos utilizar diferentes elementos para representar los mismos datos.
<ul>
<li>O combinar varios en un mismo gráfico.</li>
</ul></li>
</ul></li>
<li>Etiquetas completas.
<ul>
<li><code>ggplot()</code> toma de las variables nombres para los ejes y etiquetas para las escalas (discretas o continuas)
<ul>
<li>De los mapeos adicionales (es decir, aquellos que no remiten directamente a los ejes) las etiquetas de leyendas.</li>
</ul></li>
</ul></li>
<li>Anotaciones.
<ul>
<li>Títulos, subtítulos, viñetas y cualquier otra anotación que querramos incluir será intoducida directamente por el usuario.</li>
</ul></li>
</ul>
</div>
<div id="la-base-de-datos." class="section level2">
<h2><span class="header-section-number">4.4</span> La base de datos.</h2>
<div id="indice-de-marginacion-por-municipios-1990-2015." class="section level3">
<h3><span class="header-section-number">4.4.1</span> Índice de marginación por municipios 1990-2015.</h3>
<p>Todos los ejemplos se llevan a cabo con la base de datos del Índice de Marginación elaborado por CONAPO, desagregada a nivel municipal.</p>
<p>Base de datos en formato csv: <a href="http://www.conapo.gob.mx/work/models/CONAPO/Marginacion/Datos_Abiertos/Municipio/Base_Indice_de_marginacion_municipal_90-15.csv" class="uri">http://www.conapo.gob.mx/work/models/CONAPO/Marginacion/Datos_Abiertos/Municipio/Base_Indice_de_marginacion_municipal_90-15.csv</a></p>
<p>Diccionario de variables en formato csv:
<a href="http://www.conapo.gob.mx/work/models/CONAPO/Marginacion/Datos_Abiertos/Localidad/Diccionario_marginacion_localidad_95-10.csv" class="uri">http://www.conapo.gob.mx/work/models/CONAPO/Marginacion/Datos_Abiertos/Localidad/Diccionario_marginacion_localidad_95-10.csv</a></p>
<p>Metodología:
<a href="http://www.conapo.gob.mx/work/models/CONAPO/Resource/1755/1/images/IAM_05Anexo.pdf" class="uri">http://www.conapo.gob.mx/work/models/CONAPO/Resource/1755/1/images/IAM_05Anexo.pdf</a></p>
<p>##Carga de los datos.</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb268-1" data-line-number="1">base_dura &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;datos/Base_Indice_de_marginacion_municipal_90-15.csv&quot;</span>, </a>
<a class="sourceLine" id="cb268-2" data-line-number="2">    <span class="dt">col_types =</span> <span class="kw">cols</span>(AÑ<span class="dt">O =</span> <span class="kw">col_character</span>(), </a>
<a class="sourceLine" id="cb268-3" data-line-number="3">                     <span class="dt">CVE_ENT =</span> <span class="kw">col_character</span>(), </a>
<a class="sourceLine" id="cb268-4" data-line-number="4">                     <span class="dt">CVE_MUN =</span> <span class="kw">col_character</span>(), </a>
<a class="sourceLine" id="cb268-5" data-line-number="5">                     <span class="dt">IM =</span> <span class="kw">col_double</span>(), </a>
<a class="sourceLine" id="cb268-6" data-line-number="6">                     <span class="dt">IND0A100 =</span> <span class="kw">col_double</span>(), </a>
<a class="sourceLine" id="cb268-7" data-line-number="7">                     <span class="dt">LUGAR_EST =</span> <span class="kw">col_integer</span>(), </a>
<a class="sourceLine" id="cb268-8" data-line-number="8">                     <span class="dt">LUG_NAC =</span> <span class="kw">col_integer</span>(), </a>
<a class="sourceLine" id="cb268-9" data-line-number="9">                     <span class="dt">OVPT =</span> <span class="kw">col_double</span>(), </a>
<a class="sourceLine" id="cb268-10" data-line-number="10">                     <span class="dt">OVSAE =</span> <span class="kw">col_double</span>(), </a>
<a class="sourceLine" id="cb268-11" data-line-number="11">                     <span class="dt">OVSD =</span> <span class="kw">col_double</span>(), </a>
<a class="sourceLine" id="cb268-12" data-line-number="12">                     <span class="dt">OVSDE =</span> <span class="kw">col_double</span>(), </a>
<a class="sourceLine" id="cb268-13" data-line-number="13">                     <span class="dt">OVSDSE =</span> <span class="kw">col_double</span>(),</a>
<a class="sourceLine" id="cb268-14" data-line-number="14">                     <span class="dt">OVSEE =</span> <span class="kw">col_double</span>(), </a>
<a class="sourceLine" id="cb268-15" data-line-number="15">                     <span class="st">`</span><span class="dt">PL&lt;5000</span><span class="st">`</span> =<span class="st"> </span><span class="kw">col_double</span>(), </a>
<a class="sourceLine" id="cb268-16" data-line-number="16">                     <span class="dt">PO2SM =</span> <span class="kw">col_double</span>(), </a>
<a class="sourceLine" id="cb268-17" data-line-number="17">                     <span class="dt">SPRIM =</span> <span class="kw">col_double</span>(), </a>
<a class="sourceLine" id="cb268-18" data-line-number="18">                     <span class="dt">VHAC =</span> <span class="kw">col_double</span>(), </a>
<a class="sourceLine" id="cb268-19" data-line-number="19">                     <span class="dt">VP =</span> <span class="kw">col_integer</span>()))</a></code></pre></div>
<pre><code>## Warning in rbind(names(probs), probs_f): number of columns of result is not
## a multiple of vector length (arg 1)</code></pre>
<pre><code>## Warning: 70750 parsing failures.
## row # A tibble: 5 x 5 col     row col      expected   actual file                                    expected   &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;      &lt;chr&gt;  &lt;chr&gt;                                   actual 1     1 VP       an integer -      &#39;datos/Base_Indice_de_marginacion_muni… file 2     1 OVSD     a double   -      &#39;datos/Base_Indice_de_marginacion_muni… row 3     1 OVSDSE   a double   -      &#39;datos/Base_Indice_de_marginacion_muni… col 4     1 IND0A100 a double   -      &#39;datos/Base_Indice_de_marginacion_muni… expected 5     2 VP       an integer -      &#39;datos/Base_Indice_de_marginacion_muni…
## ... ................. ... .......................................................................... ........ .......................................................................... ...... .......................................................................... .... .......................................................................... ... .......................................................................... ... .......................................................................... ........ ..........................................................................
## See problems(...) for more details.</code></pre>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb271-1" data-line-number="1"><span class="co">#Advierte que pasó a NA (missing) las columnas de algunas variables. Los indicadores del IM cambiaron con el tiempo.</span></a></code></pre></div>
<p>##Limpieza de la base con dplyr</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb272-1" data-line-number="1">base_marginacion &lt;-<span class="st">                                        </span><span class="co">#Sobre este objeto voy a trabajar.</span></a>
<a class="sourceLine" id="cb272-2" data-line-number="2"><span class="st">  </span>base_dura <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb272-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>CVE_MUN, <span class="op">-</span>CVE_ENT, <span class="op">-</span>CVE_MUN, <span class="op">-</span>VP)</a></code></pre></div>
</div>
</div>
<div id="descripcion-rapida-de-la-base-de-datos." class="section level2">
<h2><span class="header-section-number">4.5</span> Descripción rápida de la base de datos.</h2>
<div id="nombres-cortos-y-largos." class="section level3">
<h3><span class="header-section-number">4.5.1</span> Nombres cortos y largos.</h3>
<p>###Diagnóstico de casos perdidos.</p>
<ul>
<li>Algunas variables no fueron relevadas o calculadas en algunos años de la elaboración del índice.</li>
<li>Sin embargo no hay casos perdidos al azar, sólo esos missing sistemáticos por cambios de metodología.</li>
</ul>
<p><img src="libRo_files/figure-html/tableplot-1.png" width="960" /></p>
</div>
</div>
<div id="grafico-basico." class="section level2">
<h2><span class="header-section-number">4.6</span> Gráfico básico.</h2>
<ul>
<li>Para comenzar construiremos paso a paso un gráfico de barras.
<ul>
<li>Usamos gráficos de barras para representar conteos de variables categóricas.</li>
<li>Nunca los usamos para representar un estadístico descriptivo, ya que no nos dan una magnitud del error o de la precisión de la estimación. En ese caso usamos un boxplot en alguna de sus variedades o un gráfico de barras al que agregamos intervalos de confianza o márgenes de error.</li>
</ul></li>
</ul>
<div id="construccion-de-un-grafico-de-barras-paso-a-paso." class="section level3">
<h3><span class="header-section-number">4.6.1</span> Construcción de un gráfico de barras paso a paso.</h3>
<ul>
<li>ggplot encadena pasos con el operador <code>+</code>.</li>
<li>La sintaxis mínima para obtener un gráfico es <code>ggplot(datos, aes(x=variable_mapeada_en_eje_x, y=variable_mapeada_en_eje_y)) + geom_elementogeométrico</code></li>
</ul>
<p>Veamos uno a uno:</p>
<ul>
<li><code>ggplot()</code> abre la llamada a la función.</li>
<li><code>datos</code> es el primer argumento que pasamos a función.
<ul>
<li>Debe ser un <code>data.frame</code> con los datos que vamos a graficar.</li>
<li>Podemos explicitar que estos son los datos con <code>data=datos</code>, aunque al ubicarlo en la primera posición la función los identifica como datos.</li>
</ul></li>
<li><code>aes()</code> son los mapeos de datos, en los que relacionamos a cada eje del gráfico con una serie de datos.
<ul>
<li>La sintaxis es <code>eje = columna</code>, donde eje puede ser x o y y columna es el nombre de una columna en el <code>data.frame</code> <code>datos</code>.</li>
<li>Aquí mismo podemos pasar otro tipo de mapeos: <code>color</code>, <code>shape</code>, <code>fill</code>, <code>size</code>, etc, siempre controlados por una columna en el <code>datos</code>.</li>
<li>Si pasamos un argumento de color, forma, relleno, etc. fuera de los paréntesis de <code>aes()</code>, pero sin dentro de los de <code>ggplot()</code> se lo considerará una constante y afectará a todos los elementos geométricos. Por ejemplo <code>ggplot(datos, aes(x=categorías, y=conteos), fill=&quot;red&quot;)</code> rellenará el elemento geométrico de color rojo.</li>
</ul></li>
<li><code>+</code> encadena operaciones. Si no unimos las capas del gráfico con <code>+</code> R nos regresa un error de sintaxis.</li>
<li><code>geom_*</code>, donde el asterisco es el elemento geométrico que queremos utilizar para hacer visibles los datos.
-<code>geom_point</code> dibuja un punto en la intersección entre las coordenadas x y y.
-<code>geom_line</code> dibuja una línea uniendo esos puntos.
-<code>geom_col</code> crea columnas desde el 0 del eje hasta la intersección de los ejes.</li>
</ul>
<p>Diferentes elementos geométricos requieren de diferentes mapeos o producen diferentes resultados dependiendo del tipo de datos de la columna que les pasemos. La principal diferencia se da cuando pasamos un <code>factor</code><a href="#fn19" class="footnote-ref" id="fnref19"><sup>19</sup></a> o un vector numérico. Algunos elementos geométricos traen implícita una transformación estadística que requiere algún tipo especial de variables o combinaciones variables. Por ejemplo, <code>geom_bar</code> implícitamente transforma una variable en conteos, por lo que acepta solamente factores. <code>geom_boxplot</code> calcula la media, cuartiles, rango intercuartiles, etc. de una variable numérica para cada categoría de un categórica, por que lo que regresa un error si le pasamos otro tipo de variables.</p>
<p>#### Gráfico de barras a partir de conteos manuales.</p>
<ul>
<li>En este caso capturamos manualmente los datos.
<ul>
<li>Tienen que tener la estructura data.frame o equivalente (ejp. tibble)</li>
<li>Una columna con las categorías, otra con los conteos.</li>
<li>Usamos la función <code>tribble()</code> que permite capturar los datos por columna.
-Es muy conveniente para importar <em>pocos</em> datos que hemos tomado de una página web o de <sub>Excel</sub>. Seleccionamos y copiamos el rango de datos, los pegamos en el editor de texto y agregamos los nombres de colima antecedidos por <code>~</code>, separamos con comas y listo.<a href="#fn20" class="footnote-ref" id="fnref20"><sup>20</sup></a> No es un método recomendable para bases de datos grandes o con más de dos columnas.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb273-1" data-line-number="1"><span class="kw">tribble</span>(</a>
<a class="sourceLine" id="cb273-2" data-line-number="2">  <span class="op">~</span>GM,        <span class="op">~</span>n,</a>
<a class="sourceLine" id="cb273-3" data-line-number="3">  <span class="st">&quot;Muy alto&quot;</span>, <span class="dv">283</span>,</a>
<a class="sourceLine" id="cb273-4" data-line-number="4">  <span class="st">&quot;Alto&quot;</span>,     <span class="dv">817</span>,</a>
<a class="sourceLine" id="cb273-5" data-line-number="5">  <span class="st">&quot;Medio&quot;</span>,    <span class="dv">514</span>, </a>
<a class="sourceLine" id="cb273-6" data-line-number="6">  <span class="st">&quot;Bajo&quot;</span>,     <span class="dv">498</span>,</a>
<a class="sourceLine" id="cb273-7" data-line-number="7">  <span class="st">&quot;Muy bajo&quot;</span>, <span class="dv">345</span></a>
<a class="sourceLine" id="cb273-8" data-line-number="8">        ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb273-9" data-line-number="9"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>GM, <span class="dt">y=</span>n)) <span class="op">+</span><span class="st"> </span><span class="co"># Abro la función y con `aes` mapeo GM al eje x y n al y. Automáticamente genera las escalas, etiquetas, etc. a partir de las propiedad de las variables. </span></a>
<a class="sourceLine" id="cb273-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_col</span> () <span class="co">#Agrego el elemento geométrico columna. geom_col requiere mapeos en x y y.</span></a></code></pre></div>
<p><img src="libRo_files/figure-html/barra_conteo_manual-1.png" width="672" /></p>
<p>Tenemos un gráfico básico que tiene algunos errores que hay que corregir. Primero vamos ver otras dos maneras de generar gráficos de barras, después ir puliendo el gráfico hasta calidad publicación. Posteriormente vamos a agregar capas de información adicional.</p>
<div id="grafico-de-barras-a-partir-de-conteos-con-dplyr." class="section level4">
<h4><span class="header-section-number">4.6.1.1</span> Gráfico de barras a partir de conteos con dplyr.</h4>
<ul>
<li>La función tally de dplyr genera estructuras data.frame con conteos. Primero seleccionamos y agrupamos los datos, después hacemos el conteo.</li>
</ul>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb274-1" data-line-number="1">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb274-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(AÑO<span class="op">==</span><span class="st">&quot;2015&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ENT<span class="op">!=</span><span class="st">&quot;Nacional&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#Filtra sólo el año 2015 y excluyo el valor Nacional.</span></a>
<a class="sourceLine" id="cb274-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(GM) <span class="op">%&gt;%</span><span class="st">                          </span><span class="co">#Genera un grupo de observaciones por cada categoría de la variable GM. </span></a>
<a class="sourceLine" id="cb274-4" data-line-number="4"><span class="st">  </span>tally                                     <span class="co"># Realiza el conteo y lo muestra. </span></a></code></pre></div>
<pre><code>## # A tibble: 5 x 2
##   GM           n
##   &lt;chr&gt;    &lt;int&gt;
## 1 Alto       817
## 2 Bajo       498
## 3 Medio      514
## 4 Muy alto   283
## 5 Muy bajo   345</code></pre>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb276-1" data-line-number="1">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(AÑO<span class="op">==</span><span class="st">&quot;2015&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ENT<span class="op">!=</span><span class="st">&quot;Nacional&quot;</span>) <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">group_by</span>(GM) <span class="op">%&gt;%</span><span class="st"> </span>tally <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#Recreo el conteo, pues el anterior fue a consoloa y desapareció para R. </span></a>
<a class="sourceLine" id="cb276-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>GM, <span class="dt">y=</span>n)) <span class="op">+</span><span class="st">                  </span><span class="co">#n es la columna con los conteos. </span></a>
<a class="sourceLine" id="cb276-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_col</span>()</a></code></pre></div>
<div class="figure">
<img src="libRo_files/figure-html/barra_tally-1.png" alt="Municipios por Grado de Marginación a nivel nacional" width="672" />
<p class="caption">
(#fig:barra_tally)Municipios por Grado de Marginación a nivel nacional
</p>
</div>
</div>
<div id="grafico-de-barras-con-conteos-automaticos." class="section level4">
<h4><span class="header-section-number">4.6.1.2</span> Gráfico de barras con conteos automáticos.</h4>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb277-1" data-line-number="1">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb277-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(AÑO<span class="op">==</span><span class="st">&quot;2015&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ENT<span class="op">!=</span><span class="st">&quot;Nacional&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb277-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>GM)) <span class="op">+</span></a>
<a class="sourceLine" id="cb277-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_bar</span> (<span class="dt">stat=</span><span class="st">&quot;count&quot;</span>) <span class="co">#geom_bar(stat=&quot;count&quot;) realiza el conteo de manera silenciosa.</span></a></code></pre></div>
<p><img src="libRo_files/figure-html/barra_count-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="personalizacion-de-grafico." class="section level2">
<h2><span class="header-section-number">4.7</span> Personalización de gráfico.</h2>
<ul>
<li>El gráfico que hemos realizado tiene la información básica, sin embargo no está prolijo y le faltan elementos importantes. Los mejoraremos paso a paso.</li>
</ul>
<div id="orden-manual-de-las-categorias." class="section level3">
<h3><span class="header-section-number">4.7.1</span> Orden manual de las categorías.</h3>
<p>En el gráfico anterior las categorías de la variable GM están ordenadas según el alfabeto, tal como R procesa a una cadena de caracteres al convertirla a factor. En este caso dificulta la lectura del gráfico, pues no tiene el orden natural que va de Muy alto a Muy bajo o el orden decreciente por conteos.</p>
<ul>
<li><code>ggplot()</code> no tiene un método interno para reordenar categorías, retoma el orden del tipo de datos <code>factor</code> de R.</li>
<li><code>forcats::fct_relevel</code> permite reordenar manualmente categorías directamente en las estructura de datos y de ese modo pasar ese orden a <code>ggplot()</code>.
<ul>
<li>Podemos poner en práctica la programación funcional llamando a la función directamente en el mapeado <code>aes</code> de <code>ggplot()</code>. De este modo no se alteraran los datos originales y se evitan efectos colaterales.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb278-1" data-line-number="1">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb278-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(AÑO<span class="op">==</span><span class="st">&quot;2015&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ENT<span class="op">!=</span><span class="st">&quot;Nacional&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">count</span>(GM) <span class="op">%&gt;%</span><span class="st">                        </span><span class="co">#Genera conteos</span></a>
<a class="sourceLine" id="cb278-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">fct_relevel</span>(GM, <span class="st">&quot;Muy alto&quot;</span>, <span class="st">&quot;Alto&quot;</span>, <span class="st">&quot;Medio&quot;</span>, <span class="st">&quot;Bajo&quot;</span>, <span class="st">&quot;Muy bajo&quot;</span>), <span class="co">#Mapeo x al output fct_relevel.</span></a>
<a class="sourceLine" id="cb278-4" data-line-number="4">             <span class="dt">y=</span>n)) <span class="op">+</span><span class="st">                                                            </span><span class="co">#La otra variable no se ve afectada.</span></a>
<a class="sourceLine" id="cb278-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_col</span>() -&gt;<span class="st"> </span>g                                  <span class="co">#Asigno el nombre &quot;g&quot; a esta salida Puedo modificarla más adelante.</span></a>
<a class="sourceLine" id="cb278-6" data-line-number="6"><span class="kw">print</span>(g)                                           <span class="co">#Invoco explícitamente print() para hacerlo visible. </span></a></code></pre></div>
<p><img src="libRo_files/figure-html/barra_ordenado_maual-1.png" width="672" /></p>
</div>
<div id="orden-automatico-de-categorias." class="section level3">
<h3><span class="header-section-number">4.7.2</span> Orden automático de categorías.</h3>
<ul>
<li><p>Otra posibilidad es reordenar las categorías de x por su frecuencia.</p></li>
<li><p><code>forcats::fct_reorder</code> reordena a partir de una variable numérica. En este caso serviría para reordenar categorías de la variable GM de menor a mayor frecuencia.</p></li>
</ul>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb279-1" data-line-number="1">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb279-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(AÑO<span class="op">==</span><span class="st">&quot;2015&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ENT<span class="op">!=</span><span class="st">&quot;Nacional&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">count</span>(GM) <span class="op">%&gt;%</span><span class="st">  </span><span class="co">#Genera conteos, dplyr:: por un conflicto con otra función count()</span></a>
<a class="sourceLine" id="cb279-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">fct_reorder</span>(GM, <span class="kw">desc</span>(n)),                          <span class="co">#GM ordenado por desc(n). desc(n) datos de &gt; a &lt;</span></a>
<a class="sourceLine" id="cb279-4" data-line-number="4">             <span class="dt">y=</span>n)) <span class="op">+</span></a>
<a class="sourceLine" id="cb279-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_col</span>()</a></code></pre></div>
<p><img src="libRo_files/figure-html/barra_ordenado-1.png" width="672" /></p>
</div>
<div id="titulo-subtitulo-titulos-de-ejes-vineta" class="section level3">
<h3><span class="header-section-number">4.7.3</span> Título, subtítulo, títulos de ejes, viñeta</h3>
<ul>
<li>Un gráfico siempre debe llevar rótulos que hagan explícito que están presentando y como.</li>
<li>El elemento <code>labs()</code> permite incluir fácilmente todas las etiquetas necesarias.</li>
<li>Argumentos que acepta <code>labs()</code>:</li>
</ul>
<table>
<thead>
<tr class="header">
<th>Argumento</th>
<th>Elemento del gráfico</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>title</td>
<td>Título</td>
</tr>
<tr class="even">
<td>subtitle</td>
<td>Subtítulo</td>
</tr>
<tr class="odd">
<td>caption</td>
<td>Viñeta</td>
</tr>
<tr class="even">
<td>x</td>
<td>Nombre del eje x</td>
</tr>
<tr class="odd">
<td>y</td>
<td>Nombre del eje y</td>
</tr>
<tr class="even">
<td>fill</td>
<td>Nombre de la leyenda de códigos de colores creados con <code>fill=</code></td>
</tr>
<tr class="odd">
<td>color</td>
<td>Nombre de la leyenda de códigos de colores creados con <code>color=</code></td>
</tr>
<tr class="even">
<td>shape</td>
<td>Nombre de la leyenda de simbología creada con <code>shape=</code></td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb280-1" data-line-number="1">g <span class="op">+</span><span class="st"> </span><span class="kw">labs</span> (<span class="dt">title=</span> <span class="st">&quot;La mayoría de los municipios tienen un grado de marginación alto&quot;</span>, </a>
<a class="sourceLine" id="cb280-2" data-line-number="2">          <span class="dt">subtitle=</span><span class="st">&quot;Pero Muy alto son una minoría&quot;</span>, </a>
<a class="sourceLine" id="cb280-3" data-line-number="3">          <span class="dt">x=</span><span class="st">&quot;Grado de Marginación&quot;, </span></a>
<a class="sourceLine" id="cb280-4" data-line-number="4"><span class="st">          y=&quot;</span>Frecuencia absoluta<span class="st">&quot;, </span></a>
<a class="sourceLine" id="cb280-5" data-line-number="5"><span class="st">          caption= &quot;</span>Datos CONAPO para <span class="dv">2015</span><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb280-6" data-line-number="6"><span class="st">          ) -&gt;                              g #Asigno el nombre &quot;</span>g<span class="st">&quot; al gráfico con etiquetas.</span></a>
<a class="sourceLine" id="cb280-7" data-line-number="7"><span class="st">print (g)</span></a></code></pre></div>
<p><img src="libRo_files/figure-html/barra_etiquetas-1.png" width="672" /></p>
</div>
<div id="estilos-visuales." class="section level3">
<h3><span class="header-section-number">4.7.4</span> Estilos visuales.</h3>
<ul>
<li>la función <code>theme()</code> de <code>ggplot2::</code> nos permite cambiar el aspecto visual de los gráficos.</li>
<li>La forma más fácil de usarla es seleccionando alguno de los estilos visuales disponibles.</li>
<li>Nótese que las opciones de <code>theme()</code> <strong>no</strong> afectan a los elementos del gráfico que representan datos. En este caso no cambian los colores, ancho u otro atributo de las barras. Esos atributos se pueden cambiar solamente si los mapeamos a datos.</li>
<li>Esto puede ser frustrante, pero es una excelente manera de preservar la integridad de la representación.</li>
</ul>
<p>A continuación se presentan algunos de ellos aplicados al gráfico g.</p>
<p><code>theme_grey()</code> El estilo visual por default de ggplot2.
- Fondo gris, ejes implícitos, líneas de escala blancas. Recomendado para presentaciones.</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb281-1" data-line-number="1">g <span class="op">+</span><span class="st"> </span><span class="kw">theme_grey</span>()</a></code></pre></div>
<p><img src="libRo_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<p><code>theme_classic()</code> asemeja al estilo de los gráficos R Base.
- Fondo blanco, ejes explícitos, marcas de escala sobre los ejes, sin líneas de guía.</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb282-1" data-line-number="1">g <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>()</a></code></pre></div>
<p><img src="libRo_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
<p>###<code>theme_minimal()</code> es un estilo que produce gráficos elegantes y legibles para impresión.
- Fondo blanco, ejes implícitos, líneas de guía escala grises.</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb283-1" data-line-number="1">g <span class="op">+</span><span class="st"> </span><span class="kw">theme_minimal</span>()</a></code></pre></div>
<p><img src="libRo_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
</div>
</div>
<div id="graficos-intermedios-mas-de-una-serie-de-datos" class="section level2">
<h2><span class="header-section-number">4.8</span> Gráficos intermedios (más de una serie de datos)</h2>
<ul>
<li>ggplot() ofrece varias maneras de incorporar múltiples series de datos en un mismo gráfico. Estas dependerán del tipo de gráfico que estemos usando. Por ahora seguiremos usando el gráfico de barras básico al que agregaremos la variable AÑO para comparar la evolución quinquenal del número municipios por GM.</li>
<li>Es importante tener en cuenta que para graficar más de una serie de datos estos deben estar en formato largo.</li>
</ul>
<div id="datos-formato-de-datos-largo-y-ancho." class="section level3">
<h3><span class="header-section-number">4.8.1</span> Datos Formato de datos largo y ancho.</h3>
<ul>
<li>Para gráficos con más de una serie es conveniente tener los datos en formato largo.
<ul>
<li>De ese modo <code>ggplot()</code> puede agruparlos fácilmente.
<ul>
<li>Internamente hace algo similar a la función <code>filter()</code> de <code>dplyr::</code></li>
</ul></li>
<li>Para R la estructura es la misma, <code>data.frame</code>, pero cambia la forma en que organizamos la información.</li>
<li>En formato ancho la información de interés está organizada por columnas.
<ul>
<li>El nombre de columna señala la serie y en cada fila se guarda un valor.</li>
</ul></li>
<li>En formato largo el valor está en una columna aparte y hay una columna clave en la que se repite en las filas a que variable corresponde ese dato.
<ul>
<li>Se lo conoce como formato key paired o empatado por claves.</li>
<li>Duplica el largo de la estructura de datos, porque hay dos filas donde antes había dos columnas.</li>
</ul></li>
<li><code>dplyr::</code> generalmente produce datos en formato largo.</li>
<li><code>tidyr::gather()</code> pasa de formato ancho a largo.</li>
<li><code>tidyr::spread()</code> pasa de formato largo a ancho.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb284-1" data-line-number="1">base_marginacion <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb284-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ANIO=</span>AÑO) <span class="op">%&gt;%</span><span class="st">                                       </span><span class="co">#PQ dplyr a veces tiene problemas con la ñ</span></a>
<a class="sourceLine" id="cb284-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span> (ANIO <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;2015&quot;</span>, <span class="st">&quot;2010&quot;</span>) <span class="op">&amp;</span><span class="st"> </span>ENT<span class="op">!=</span><span class="st">&quot;Nacional&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># %in% busca equivalencias en un vector. </span></a>
<a class="sourceLine" id="cb284-4" data-line-number="4"><span class="st">  </span><span class="kw">group_by</span> (GM, ANIO) <span class="op">%&gt;%</span><span class="st">                                    </span><span class="co">#Doble agrupamiento. Genera formato de datos largo. </span></a>
<a class="sourceLine" id="cb284-5" data-line-number="5"><span class="st">  </span>tally -&gt;<span class="st"> </span>data                                              ##Guardo el conteo como data para graficar después##</a>
<a class="sourceLine" id="cb284-6" data-line-number="6"><span class="kw">kable</span> (data, <span class="dt">caption=</span><span class="st">&quot;Formato largo. Categoría, grupo, valor&quot;</span>)</a></code></pre></div>
<table>
<caption>(#tab:formato_largo_corto)Formato largo. Categoría, grupo, valor</caption>
<thead>
<tr class="header">
<th align="left">GM</th>
<th align="left">ANIO</th>
<th align="right">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Alto</td>
<td align="left">2010</td>
<td align="right">408</td>
</tr>
<tr class="even">
<td align="left">Alto</td>
<td align="left">2015</td>
<td align="right">817</td>
</tr>
<tr class="odd">
<td align="left">Bajo</td>
<td align="left">2010</td>
<td align="right">401</td>
</tr>
<tr class="even">
<td align="left">Bajo</td>
<td align="left">2015</td>
<td align="right">498</td>
</tr>
<tr class="odd">
<td align="left">Medio</td>
<td align="left">2010</td>
<td align="right">944</td>
</tr>
<tr class="even">
<td align="left">Medio</td>
<td align="left">2015</td>
<td align="right">514</td>
</tr>
<tr class="odd">
<td align="left">Muy alto</td>
<td align="left">2010</td>
<td align="right">441</td>
</tr>
<tr class="even">
<td align="left">Muy alto</td>
<td align="left">2015</td>
<td align="right">283</td>
</tr>
<tr class="odd">
<td align="left">Muy bajo</td>
<td align="left">2010</td>
<td align="right">262</td>
</tr>
<tr class="even">
<td align="left">Muy bajo</td>
<td align="left">2015</td>
<td align="right">345</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb285-1" data-line-number="1"><span class="kw">kable</span>(<span class="kw">spread</span>(data, ANIO, n), <span class="dt">caption=</span> <span class="st">&quot;Formato ancho. Categoría, Grupo, Grupo.&quot;</span>)</a></code></pre></div>
<table>
<caption>(#tab:formato_largo_corto)Formato ancho. Categoría, Grupo, Grupo.</caption>
<thead>
<tr class="header">
<th align="left">GM</th>
<th align="right">2010</th>
<th align="right">2015</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Alto</td>
<td align="right">408</td>
<td align="right">817</td>
</tr>
<tr class="even">
<td align="left">Bajo</td>
<td align="right">401</td>
<td align="right">498</td>
</tr>
<tr class="odd">
<td align="left">Medio</td>
<td align="right">944</td>
<td align="right">514</td>
</tr>
<tr class="even">
<td align="left">Muy alto</td>
<td align="right">441</td>
<td align="right">283</td>
</tr>
<tr class="odd">
<td align="left">Muy bajo</td>
<td align="right">262</td>
<td align="right">345</td>
</tr>
</tbody>
</table>
</div>
<div id="grafico-de-barras-lado-a-lado." class="section level3">
<h3><span class="header-section-number">4.8.2</span> Gráfico de barras lado a lado.</h3>
<ul>
<li>Este gráfico presenta dos series de datos usando un código de color.
<ul>
<li>En este caso es el color que rellena las barras, lo mapeamos con <code>fill=</code>.</li>
<li>ggplot() usa los colores de una paleta por default.
<ul>
<li>Podemos personalizar la paleta de colores.</li>
</ul></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb286-1" data-line-number="1"><span class="co">#Primero asigno a las etiquetas el nombre etiquetas, así las puedo incluir con + etiquetas. </span></a>
<a class="sourceLine" id="cb286-2" data-line-number="2">etiquetas &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb286-3" data-line-number="3"><span class="st">  </span><span class="kw">labs</span> (<span class="dt">title=</span> <span class="st">&quot;2010-2015 ¿retroceso?&quot;</span>, <span class="dt">subtitle=</span><span class="st">&quot;O foco en los municipios de mayor marginación&quot;, x=&quot;</span>Grado de Marginación&quot;, <span class="dt">y=</span><span class="st">&quot;Frecuencia absoluta&quot;</span>, <span class="dt">caption=</span> <span class="st">&quot;Datos CONAPO para 2015&quot;</span>)</a>
<a class="sourceLine" id="cb286-4" data-line-number="4"></a>
<a class="sourceLine" id="cb286-5" data-line-number="5">  <span class="kw">ggplot</span> (data, <span class="kw">aes</span>(<span class="dt">x=</span>GM, <span class="dt">y=</span>n, <span class="dt">fill=</span>ANIO)) <span class="op">+</span></a>
<a class="sourceLine" id="cb286-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co">#Position=&quot;dodge&quot; Barras lado a lado. Por defecto barras apiladas.</span></a>
<a class="sourceLine" id="cb286-7" data-line-number="7"><span class="st">  </span>etiquetas <span class="op">+</span><span class="st">                    </span><span class="co">#Etiquetas completas, también se pueden especificar a mano.</span></a>
<a class="sourceLine" id="cb286-8" data-line-number="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill=</span><span class="st">&quot;Año&quot;</span>)               <span class="co">#Agrego la leyenda de colores (`fill=`), se suma a + etiquetas</span></a></code></pre></div>
<p><img src="libRo_files/figure-html/barra_a%C3%B1o_color-1.png" width="672" /></p>
</div>
<div id="graficos-multipanel." class="section level3">
<h3><span class="header-section-number">4.8.3</span> Gráficos multipanel.</h3>
<ul>
<li>Los gráficos multipanel dividen un gráfico en varios subgráficos, presentando una serie en cada uno. Simplifican gráficos muy complejos (este no lo es) y funcionan bien sin colores. Al estar todos los paneles en la misma escala es posible compararlos.</li>
<li>En <code>ggplot2::</code> el elemento <code>facet_wrap()</code> nos permite señalar la variable de agrupamiento, cada categoría de esa variable será un panel.
<ul>
<li>Antecedemos al nombre de la variable con <code>~</code>. Porque sí.</li>
<li><code>ncol=</code> nos permite especificar la cantidad de columnas de paneles.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb287-1" data-line-number="1">data <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb287-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span> (<span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">fct_relevel</span>(GM, <span class="st">&quot;Muy alto&quot;</span>, <span class="st">&quot;Alto&quot;</span>, <span class="st">&quot;Medio&quot;</span>, <span class="st">&quot;Bajo&quot;</span>, <span class="st">&quot;Muy bajo&quot;</span>), <span class="dt">y=</span>n)) <span class="op">+</span></a>
<a class="sourceLine" id="cb287-3" data-line-number="3"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>ANIO, <span class="dt">ncol=</span><span class="dv">2</span>) <span class="op">+</span><span class="st">          </span><span class="co">#~ANIO: variable de agrupamiento. ncol= 2columnas.</span></a>
<a class="sourceLine" id="cb287-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_col</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb287-5" data-line-number="5"><span class="st">  </span>etiquetas <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb287-6" data-line-number="6"><span class="st">  </span><span class="kw">theme_minimal</span>()</a></code></pre></div>
<p><img src="libRo_files/figure-html/barra_a%C3%B1o_panel-1.png" width="672" /></p>
</div>
<div id="grafico-de-punto." class="section level3">
<h3><span class="header-section-number">4.8.4</span> Gráfico de punto.</h3>
<ul>
<li>Los gráficos de puntos expresan la misma información uno de barras, pero utilizan un elemento geométrico diferente.
<ul>
<li>Usan puntos en lugar barras.</li>
<li>Es convención poner a las categorías de la variable en el eje y y las frecuencias en el eje x.</li>
<li>Y ordenarlas por frecuencia de mayor a menor.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb288-1" data-line-number="1">data <span class="op">%&gt;%</span><span class="st">                        </span><span class="co"># Tomamos los mismos datos.</span></a>
<a class="sourceLine" id="cb288-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span> (<span class="kw">aes</span>(<span class="dt">y=</span><span class="kw">fct_relevel</span>(GM, <span class="st">&quot;Muy alto&quot;</span>, <span class="st">&quot;Alto&quot;</span>, <span class="st">&quot;Medio&quot;</span>, <span class="st">&quot;Bajo&quot;</span>, <span class="st">&quot;Muy bajo&quot;</span>), <span class="dt">x=</span>n)) <span class="op">+</span></a>
<a class="sourceLine" id="cb288-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color=</span>ANIO)) <span class="op">+</span><span class="st"> </span><span class="co">#Se pueden agregar mapeos directamente en geom_</span></a>
<a class="sourceLine" id="cb288-4" data-line-number="4"><span class="st">  </span>etiquetas <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb288-5" data-line-number="5"><span class="st">  </span><span class="kw">theme_minimal</span>()</a></code></pre></div>
<p><img src="libRo_files/figure-html/punto-1.png" width="672" /></p>
</div>
<div id="grafico-de-punto-y-linea." class="section level3">
<h3><span class="header-section-number">4.8.5</span> Gráfico de punto y línea.</h3>
<ul>
<li>Para enfatizar la variación interanual podemos dibujar una recta que una ambos puntos.
<ul>
<li>Agregar etiquetas con el número de la variación.</li>
<li>Ordenar las categorías de la variable por orden de variación.</li>
<li>Es necesario desdoblar la estructura de datos,
<ul>
<li>una en formato ancho para definir las coordenadas de los puntos de la recta y calcular la diferencia interquinquenal.</li>
<li>otra en formato largo para marcar los puntos mapeados a <code>color=</code></li>
</ul></li>
<li>Usamos <code>geom_segment()</code> para dibujar las rectas, este toma 4 argumentos: x, xend, y, yend.</li>
<li>Usamos <code>geom_text()</code> para ubicar sobre cada recta la magnitud de variación.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb289-1" data-line-number="1">data &lt;-</a>
<a class="sourceLine" id="cb289-2" data-line-number="2"><span class="st"> </span>data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb289-3" data-line-number="3"><span class="st">   </span><span class="kw">spread</span>(ANIO, n) <span class="op">%&gt;%</span><span class="st">            </span><span class="co">#Paso a formato ancho, crea una columna por año.</span></a>
<a class="sourceLine" id="cb289-4" data-line-number="4"><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">dif=</span><span class="st">`</span><span class="dt">2015</span><span class="st">`</span><span class="op">-</span><span class="st">`</span><span class="dt">2010</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st">  </span><span class="co">#Calculo la diferencia interquinquenal.</span></a>
<a class="sourceLine" id="cb289-5" data-line-number="5"><span class="st">   </span>ungroup <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb289-6" data-line-number="6"><span class="st">   </span><span class="kw">mutate</span>(<span class="dt">GM=</span><span class="kw">fct_reorder</span>(GM, <span class="kw">abs</span>(dif))) <span class="co">#Ordeno las categorías por diferencia absoluta.</span></a>
<a class="sourceLine" id="cb289-7" data-line-number="7">data2 &lt;-<span class="st"> </span>data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span> (<span class="op">-</span>dif) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>(., key, value, <span class="op">-</span>GM) <span class="co">#Recreo los datos en formato largo para poder el argumento color. </span></a>
<a class="sourceLine" id="cb289-8" data-line-number="8">   <span class="kw">ggplot</span> (data, <span class="kw">aes</span>(<span class="dt">y=</span>GM)) <span class="op">+</span></a>
<a class="sourceLine" id="cb289-9" data-line-number="9"><span class="st">   </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">y=</span>GM, <span class="dt">yend=</span>GM, <span class="dt">x=</span><span class="st">`</span><span class="dt">2010</span><span class="st">`</span>, <span class="dt">xend=</span><span class="st">`</span><span class="dt">2015</span><span class="st">`</span>)) <span class="op">+</span><span class="st"> </span><span class="co">#Línea</span></a>
<a class="sourceLine" id="cb289-10" data-line-number="10"><span class="st">   </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">y=</span>GM, <span class="dt">x=</span>(<span class="st">`</span><span class="dt">2010</span><span class="st">`</span><span class="op">+</span><span class="st">`</span><span class="dt">2015</span><span class="st">`</span>)<span class="op">/</span><span class="dv">2</span>, <span class="dt">label=</span> dif, <span class="dt">vjust=</span><span class="fl">1.5</span>)) <span class="op">+</span><span class="st"> </span><span class="co">#Etiqueta variación.</span></a>
<a class="sourceLine" id="cb289-11" data-line-number="11"><span class="st">   </span><span class="kw">geom_point</span>(<span class="dt">data=</span>data2, <span class="kw">aes</span>(<span class="dt">y=</span>GM, <span class="dt">x=</span>value, <span class="dt">color=</span>key), <span class="dt">size=</span><span class="dv">4</span>) <span class="op">+</span><span class="st"> </span><span class="co">#Puntos con valores quinquenales.</span></a>
<a class="sourceLine" id="cb289-12" data-line-number="12"><span class="st">   </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Diferencia interquinquenal en Nro de Municipios por Grado de Marginación&quot;, subtitle=&quot;</span>¿Es la misma metodología?<span class="st">&quot;, caption=&quot;</span>Datos CONAPO <span class="dv">2015</span><span class="st">&quot;, x=&quot;</span>Municipios<span class="st">&quot;, y=&quot;</span>Grado de Marginación&quot;, <span class="dt">color=</span><span class="st">&quot;Año&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb289-13" data-line-number="13"><span class="st">     </span><span class="kw">theme_minimal</span>()</a></code></pre></div>
<p><img src="libRo_files/figure-html/punto_linea-1.png" width="672" /></p>
</div>
<div id="grafico-de-dispersion." class="section level3">
<h3><span class="header-section-number">4.8.6</span> Gráfico de dispersión.</h3>
<ul>
<li>Los gráficos de dispersión muestran las relaciones entre dos variables continuas.
<ul>
<li>Por ejemplo, podemos explorar la relación entre la cantidad de habitantes de un municipio y su índice de marginación.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb290-1" data-line-number="1">g &lt;-<span class="st"> </span>base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb290-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span> (AÑO<span class="op">==</span><span class="st">&quot;2015&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ENT<span class="op">!=</span><span class="st">&quot;Nacional&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb290-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>POB_TOT, <span class="dt">y=</span>IM)) <span class="op">+</span><span class="st"> </span><span class="co">#Mapeo x y y.</span></a>
<a class="sourceLine" id="cb290-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_point</span>()                   <span class="co">#Un punto en cada intersección de x y y.</span></a>
<a class="sourceLine" id="cb290-5" data-line-number="5"><span class="kw">print</span> (g)</a></code></pre></div>
<p><img src="libRo_files/figure-html/dispersion-1.png" width="672" /></p>
</div>
<div id="grafico-de-dispersion-en-paneles." class="section level3">
<h3><span class="header-section-number">4.8.7</span> Gráfico de dispersión en paneles.</h3>
<ul>
<li>Para explorar la relación entre dos variables en diferentes contextos podemos usar paneles.
<ul>
<li>Y graficar la dispersión para cada categoría de una tercera variable.</li>
<li>En este caso, la relación entre población y marginación en cada Entidad Federativa.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb291-1" data-line-number="1">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb291-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span> (AÑO<span class="op">==</span><span class="st">&quot;2015&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ENT<span class="op">!=</span><span class="st">&quot;Nacional&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb291-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>POB_TOT, <span class="dt">y=</span>IM)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb291-4" data-line-number="4"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>ENT, <span class="dt">nrow=</span><span class="dv">8</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb291-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb291-6" data-line-number="6"><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb291-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;El Indice de Marginación baja a medida que sube el número de habitantes&quot;</span>, <span class="dt">subtitle=</span><span class="st">&quot;outliners interesantes&quot;</span>, <span class="dt">x=</span><span class="st">&quot;Población del Municipio&quot;</span>, <span class="dt">y=</span> <span class="st">&quot;Índice de marginación&quot;, caption=&quot;</span>Datos CONAPO <span class="dv">2015</span><span class="st">&quot;) +</span></a>
<a class="sourceLine" id="cb291-8" data-line-number="8"><span class="st">  theme_minimal()</span></a></code></pre></div>
<p><img src="libRo_files/figure-html/dispresion_paneles_ENT-1.png" width="672" /></p>
<ul>
<li>O en cada quinquenio relevado.</li>
</ul>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb292-1" data-line-number="1">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb292-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span> (ENT<span class="op">!=</span><span class="st">&quot;Nacional&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb292-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>POB_TOT, <span class="dt">y=</span>IM)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb292-4" data-line-number="4"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>AÑO, <span class="dt">ncol=</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb292-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb292-6" data-line-number="6"><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb292-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;El Indice de Marginación baja a medida que sube el número de habitantes&quot;</span>, <span class="dt">subtitle=</span><span class="st">&quot;Urbanización&quot;, x=&quot;</span>Población del Municipio<span class="st">&quot;, y= &quot;</span>Índice de marginación&quot;, <span class="dt">caption=</span><span class="st">&quot;Datos CONAPO 2015&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb292-8" data-line-number="8"><span class="st">  </span><span class="kw">theme_minimal</span>()</a></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
<p><img src="libRo_files/figure-html/dispersion_paneles_ANIO-1.png" width="672" /></p>
</div>
<div id="grafico-de-caja." class="section level3">
<h3><span class="header-section-number">4.8.8</span> Gráfico de caja.</h3>
<ul>
<li>Los gráficos de caja o boxplot son muy apropiados para ver cómo varía una variable continua en relación a una categórica. A diferencia de un gráfico que sólo nos muestra una una estimación puntual (como un gráfico de barras de medias o medianas) un boxplot nos da simultáneamente información sobre la estimación, la dispersión y la presencia de casos extremos.</li>
<li>Un en gráfico de caso estándar:
<ul>
<li>Una línea horizontal señala la mediana.</li>
<li>La caja la extensión entre los cuartiles 1 y 3.</li>
<li>Los “bigotes” cubren una vez y media el rango intercuartil, 1.5 veces el largo de la caja.</li>
<li>Los puntos por encima o por debajo de los bigotes marcan valores atípicos o outliers.</li>
</ul></li>
<li>En <code>ggplot2::</code> el elemento geométrico <code>geom_boxplot()</code> y <code>stat=boxplot</code> trabajan en conjunto para hacer todas las transformaciones y graficar los elementos
geométricos.
<ul>
<li>Mapeamos una x categórica y una y continua a <code>geom_boxplot</code> y obtenemos el gráfico estándar.</li>
<li>Si queremos emplear el elemento geométrico boxplot, pero utilizar estadísticos diferentes (ejp. la media y los dos primeros desvíos), podemos pasar los argumentos <code>ymin</code>,<code>lower,</code>middle<code>,</code>upper<code>y</code>ymax<code>en el mapeo</code>aes`.</li>
</ul></li>
</ul>
<div id="grafico-de-caja-estandar" class="section level4">
<h4><span class="header-section-number">4.8.8.1</span> Gráfico de caja estandar</h4>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb294-1" data-line-number="1">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb294-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span> (AÑO<span class="op">==</span><span class="st">&quot;2015&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ENT<span class="op">!=</span><span class="st">&quot;Nacional&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb294-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>ENT, <span class="dt">y=</span>POB_TOT)) <span class="op">+</span><span class="st">     </span><span class="co">#Mapeo una categórica y una contínua.  </span></a>
<a class="sourceLine" id="cb294-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st">                    </span><span class="co">#Agrego el elemento geométrico.</span></a>
<a class="sourceLine" id="cb294-5" data-line-number="5"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;La mayoría de los municipios de México tienen poca población&quot;,</span></a>
<a class="sourceLine" id="cb294-6" data-line-number="6"><span class="st">       subtitle=&quot;</span>Muchos casos atípicos<span class="op">:</span><span class="st"> </span>Municipios urbanos muy poblados<span class="st">&quot;, </span></a>
<a class="sourceLine" id="cb294-7" data-line-number="7"><span class="st">       x=&quot;</span>Entidad Federativa<span class="st">&quot;, </span></a>
<a class="sourceLine" id="cb294-8" data-line-number="8"><span class="st">       y=&quot;</span>Población por municipio<span class="st">&quot;, </span></a>
<a class="sourceLine" id="cb294-9" data-line-number="9"><span class="st">       caption=&quot;</span>Datos CONAPO <span class="dv">2015</span><span class="st">&quot;) +</span></a>
<a class="sourceLine" id="cb294-10" data-line-number="10"><span class="st">  theme_minimal() +</span></a>
<a class="sourceLine" id="cb294-11" data-line-number="11"><span class="st">  theme(axis.text.x = element_text(angle = 90,    #Roto 90° las etiquetas del eje x</span></a>
<a class="sourceLine" id="cb294-12" data-line-number="12"><span class="st">                                   size = 6,      # Reduzco el tamaño a 6 puntos </span></a>
<a class="sourceLine" id="cb294-13" data-line-number="13"><span class="st">                                   color=&quot;</span>blue<span class="st">&quot;) #Cambio el color del texto a azul </span></a>
<a class="sourceLine" id="cb294-14" data-line-number="14"><span class="st">        )   </span></a></code></pre></div>
<p><img src="libRo_files/figure-html/caja_estandar-1.png" width="672" /></p>
</div>
<div id="grafico-de-caja-con-estadisticos-personalizados" class="section level4">
<h4><span class="header-section-number">4.8.8.2</span> Gráfico de caja con estadísticos personalizados</h4>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb295-1" data-line-number="1">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb295-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span> (AÑO<span class="op">==</span><span class="st">&quot;2015&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ENT<span class="op">!=</span><span class="st">&quot;Nacional&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb295-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(ENT) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb295-4" data-line-number="4"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span> (<span class="dt">media=</span><span class="kw">mean</span>(POB_TOT),            <span class="co">#Obtengo la media por ENT</span></a>
<a class="sourceLine" id="cb295-5" data-line-number="5">             <span class="dt">desvio=</span><span class="kw">sd</span>(POB_TOT)) <span class="op">%&gt;%</span><span class="st">         </span><span class="co">#Y el desvío estándar</span></a>
<a class="sourceLine" id="cb295-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">fct_reorder</span>(ENT, media),      <span class="co">#Mapeo x categórica reordenada por media.</span></a>
<a class="sourceLine" id="cb295-7" data-line-number="7">             <span class="dt">ymin =</span> media<span class="op">-</span>desvio<span class="op">*</span><span class="dv">2</span>,          <span class="co">#Bigote bajo: 2sigma</span></a>
<a class="sourceLine" id="cb295-8" data-line-number="8">             <span class="dt">lower =</span> media<span class="op">-</span>desvio,           <span class="co">#Caja baja: 1sigma</span></a>
<a class="sourceLine" id="cb295-9" data-line-number="9">             <span class="dt">middle =</span> media,                 <span class="co">#Centro: media</span></a>
<a class="sourceLine" id="cb295-10" data-line-number="10">             <span class="dt">upper =</span> media<span class="op">+</span>desvio,           <span class="co">#Caja alta: 1sigma</span></a>
<a class="sourceLine" id="cb295-11" data-line-number="11">             <span class="dt">ymax =</span> media<span class="op">+</span>desvio<span class="op">*</span><span class="dv">2</span>)) <span class="op">+</span><span class="st">       </span><span class="co">#Bigote alto: 2 sigma</span></a>
<a class="sourceLine" id="cb295-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">stat=</span> <span class="st">&quot;identity&quot;</span>) <span class="op">+</span><span class="st">           </span><span class="co">#stat=&quot;identity&quot; para datos personalizados.</span></a>
<a class="sourceLine" id="cb295-13" data-line-number="13"><span class="st">  </span><span class="kw">coord_flip</span> () <span class="op">+</span><span class="st">                            </span><span class="co">#Roto los ejes para hacer visibles las etiquetas.  </span></a>
<a class="sourceLine" id="cb295-14" data-line-number="14"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Baja California y Distrito Federal tienen casi toda su población en municipios muy poblados&quot;</span>,</a>
<a class="sourceLine" id="cb295-15" data-line-number="15">       <span class="dt">y=</span> (<span class="kw">expression</span>(mu<span class="op">*</span><span class="er">~</span>sigma<span class="op">*</span><span class="er">~</span><span class="dv">2</span><span class="op">*</span>sigma)),  <span class="co">#Uso la función expression para insertar letras griegas. </span></a>
<a class="sourceLine" id="cb295-16" data-line-number="16">       <span class="dt">x=</span><span class="st">&quot;Entidad federativa&quot;</span>)  </a></code></pre></div>
<p><img src="libRo_files/figure-html/caja_personalizado-1.png" width="672" /></p>
</div>
<div id="grafico-de-violin" class="section level4">
<h4><span class="header-section-number">4.8.8.3</span> Gráfico de violín</h4>
<ul>
<li>Otra alternativa para graficar una variable continua en las diferentes categorías de una variable categórica es el gráfico de violín.
<ul>
<li>Este genera una figura con la densidad de frecuencia a lo largo de la escala.</li>
<li>Es similar a generar una curva de densidad para cada categoría, pero lo hace en dos direcciones.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb296-1" data-line-number="1">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb296-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span> (AÑO<span class="op">==</span><span class="st">&quot;2015&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ENT <span class="op">%in%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb296-3" data-line-number="3"><span class="st">            </span><span class="kw">c</span>(<span class="st">&quot;Guerrero&quot;</span>, <span class="st">&quot;Distrito Federal&quot;</span>, <span class="st">&quot;Veracruz de Ignacio de la Llave&quot;</span>, <span class="st">&quot;Baja California&quot;</span>, <span class="st">&quot;Tlaxcala&quot;</span>, </a>
<a class="sourceLine" id="cb296-4" data-line-number="4">              <span class="st">&quot;Oaxaca&quot;</span>, <span class="st">&quot;Tamaulipas&quot;</span>)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co">#Selecciono algunas Entidades.</span></a>
<a class="sourceLine" id="cb296-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ENT=</span><span class="kw">str_wrap</span>(ENT, <span class="dv">15</span>)) <span class="op">%&gt;%</span><span class="st">         </span><span class="co">#Ajusto el ancho de los nombres de las categorías, inserta un salto de línea cada 15 caracteres. </span></a>
<a class="sourceLine" id="cb296-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>ENT, <span class="dt">y=</span>IM)) <span class="op">+</span><span class="st">                </span><span class="co">#Mapeo x categórica y y continua.  </span></a>
<a class="sourceLine" id="cb296-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_violin</span>(<span class="dt">fill=</span><span class="st">&quot;chartreuse4&quot;</span>) <span class="op">+</span><span class="st">         </span><span class="co">#Relleno el violín con un color verde. </span></a>
<a class="sourceLine" id="cb296-8" data-line-number="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Las Entidades con menos marginación son menos desiguales&quot;</span>, </a>
<a class="sourceLine" id="cb296-9" data-line-number="9">       <span class="dt">x=</span><span class="st">&quot;Entidad Federativa&quot;</span>, </a>
<a class="sourceLine" id="cb296-10" data-line-number="10">       <span class="dt">y=</span><span class="st">&quot;Índice de marginación&quot;, </span></a>
<a class="sourceLine" id="cb296-11" data-line-number="11"><span class="st">       caption=&quot;</span>Datos CONAPO <span class="dv">2015</span><span class="st">&quot;) +</span></a>
<a class="sourceLine" id="cb296-12" data-line-number="12"><span class="st">  theme_minimal() +        </span></a>
<a class="sourceLine" id="cb296-13" data-line-number="13"><span class="st">  theme(plot.title = element_text(size=11,        #Reduzco el tamaño del título a 11 puntos.</span></a>
<a class="sourceLine" id="cb296-14" data-line-number="14"><span class="st">                                  face=&quot;</span>italic<span class="st">&quot;)  #Y cambio la fuente a itálica.</span></a>
<a class="sourceLine" id="cb296-15" data-line-number="15"><span class="st">        )   </span></a></code></pre></div>
<p><img src="libRo_files/figure-html/violin-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="personalizacion-avanzada-de-graficos." class="section level2">
<h2><span class="header-section-number">4.9</span> Personalización avanzada de gráficos.</h2>
<ul>
<li>Hasta ahora hemos trabajado con los estilos visuales predefinidos de ggplot. Sin embargo cambiando las propiedades de un estilo podemos personalizar prácticamente todos los elementos estéticos de un gráfico, es decir, aquellos en los que no se están mapeando datos.
<ul>
<li><code>ggplot2</code> separa completamente la estética del gráfico de la representación de datos. Por lo tanto cambiando el estilo <strong>no</strong> podemos:
<ul>
<li>Cambiar los colores, tipografías, simbología o cualquier propiedad de los elementos geométricos.</li>
<li>Cambiar las escalas.</li>
<li>Cambiar los proporciones del gráfico.</li>
</ul></li>
</ul></li>
<li>Sin embargo podemos cambiar:
<ul>
<li>El tamaño, tipografía, color, orientación, ubicación de los elementos no de datos como etiquetas, leyendas, títulos, marcas de escalas, etc.</li>
</ul></li>
</ul>
<div id="etiquetas-y-elementos-de-texto." class="section level3">
<h3><span class="header-section-number">4.9.1</span> Etiquetas y elementos de texto.</h3>
<ul>
<li>Un problema frecuente es que las etiquetas de los ejes se superponen y no son visibles. Esto es usual cuando las etiquetas son largas, por ejemplo, estamos usando como etiqueta una pregunta tal cuál fue formulada en un encuesta. Hay varias estrategias para solucionar este problema. Si estamos utilizando algún estilo visual (theme) <strong>debemos hacer los cambios después de aplicar el tema</strong>. De lo contrario las especificaciones del estilo tendrá prioridad y sobrescribirán nuestro cambio.</li>
<li>Problemas y soluciones frecuentes.
<ul>
<li><strong>Cambiar la orientación de las etiquetas</strong>. Al rotarlas 90 o 45° aumentamos la legibilidad.
<ul>
<li>Esto lo hacemos ajustando el elemento texto de cada eje. Ver ejemplo en <a href="graficos.html#grafico-de-caja-estandar">Gráfico de caja estandar</a></li>
<li>Por defecto el texto a 0 grados, es decir, paralelo al eje x. Podemos cambiar cualquier ángulo entre 0 y 360.</li>
</ul></li>
<li><strong>Cambiar la orientación del gráfico</strong>. Al rotar los ejes podemos poner las etiquetas largas en el eje y, donde tendrán más espacio.
<ul>
<li>Esto lo hacemos cambiando rotando las coordenadas con <code>+ coord_flip</code>. Ver ejemplo en <a href="graficos.html#grafico-de-caja-con-estadisticos-personalizados">Gráfico de caja con estadísticos personalizados</a></li>
<li>En algunos casos podemos lograr el mismo efecto cambiando el mapeado de los ejes x y y, pero no siempre es así.</li>
</ul></li>
<li><strong>Reducir el tamaño de la tipografía</strong>.
<ul>
<li>Esto lo hacemos cambiando el elemento texto de los ejes. Ver ejemplo <a href="graficos.html#grafico-de-caja-estandar">Gráfico de caja estandar</a></li>
<li>Cambiando ese elemento también podemos cambiar el font face, color,</li>
</ul></li>
<li><strong>Agregar saltos de línea</strong> para obtener bloques de texto más cortos en varias líneas.
<ul>
<li>Esto lo hacemos haciendo el ajuste de línea previamente con la función <code>stringr::str_wrap()</code>. Ver ejemplo en <a href="graficos.html#grafico-de-violin">Gráfico de violín</a></li>
<li>Es recomendable agregar los saltos de líneas antes de pasar los datos a <code>ggplot()</code>, tipicamente con la función <code>dplyr::mutate()</code>.</li>
<li>También podemos agregar saltos de línea manuales con <code>\n</code> dentro de una cadena de caracteres.</li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="ajuste-del-elemento-texto." class="section level3">
<h3><span class="header-section-number">4.9.2</span> Ajuste del elemento texto.</h3>
<ul>
<li>Dentro de los estilos visuales de <code>ggplot()</code> la clase <code>element_text</code> nos permite ajustar las propiedades de texto.
<ul>
<li>Primero debemos ubicar la parte del gráfico que queremos modificar. A continuación se listan algunas de uso frecuente.</li>
</ul></li>
</ul>
<div id="elementos-con-texto-de-un-grafico-de-ggplot." class="section level4">
<h4><span class="header-section-number">4.9.2.1</span> Elementos con texto de un gráfico de ggplot.</h4>
<table>
<thead>
<tr class="header">
<th>Elemento del tema</th>
<th>Afecta a</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>theme(axis.title = element_text () )</code></td>
<td>Los nombres de ambos ejes</td>
</tr>
<tr class="even">
<td><code>theme(axis.title.x = element_text ())</code></td>
<td>Los nombres del eje x</td>
</tr>
<tr class="odd">
<td><code>theme(axis.title.y =element_text ())</code></td>
<td>Los nombres del eje y</td>
</tr>
<tr class="even">
<td><code>theme(axis.text = element_text ())</code></td>
<td>Las etiquetas de ambos ejes</td>
</tr>
<tr class="odd">
<td><code>theme(axis.text.x = element_text ())</code></td>
<td>Las etiquetas del eje x</td>
</tr>
<tr class="even">
<td><code>theme(axis.text.y = element_text ())</code></td>
<td>Las etiquetas del eje y</td>
</tr>
<tr class="odd">
<td><code>theme(plot.title = element_text ())</code></td>
<td>El título del gráfico</td>
</tr>
<tr class="even">
<td><code>theme(plot.subtitle = element_text ())</code></td>
<td>El subtítulo del gráfico</td>
</tr>
<tr class="odd">
<td><code>theme(plot.caption = element_text ())</code></td>
<td>La viñeta del gráfico</td>
</tr>
</tbody>
</table>
<ul>
<li>Luego después del signo <code>=</code> debemos señalar que queremos cambiar el elemento texto con <code>element_text()</code> y pasar alguno de los siguientes argumentos:</li>
</ul>
<table>
<thead>
<tr class="header">
<th>Argumento</th>
<th>Cambia…</th>
<th>Ejemplo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>family</td>
<td>La fuente</td>
<td>family = “sans”</td>
</tr>
<tr class="even">
<td>face</td>
<td>Tipo de letra</td>
<td>face = “italic”</td>
</tr>
<tr class="odd">
<td>color</td>
<td>Color de letra</td>
<td>color = “green”<a href="#fn21" class="footnote-ref" id="fnref21"><sup>21</sup></a></td>
</tr>
<tr class="even">
<td>hjust</td>
<td>Alineación horizontal</td>
<td>hjust = -1</td>
</tr>
<tr class="odd">
<td>vjust</td>
<td>Alineación vertical</td>
<td>vjust = 0.1</td>
</tr>
<tr class="even">
<td>angle</td>
<td>Ángulo del texto en °</td>
<td>angle = 90</td>
</tr>
</tbody>
</table>
<ul>
<li>La sintaxis para modificar el subtítulo del gráfico a fuente Times New Roman, itálica, verde, alineado 1 punto a la izquierda, 0.1 punto más arriba y rotado 90° es: <code>+ plot.subtitle(element_text(family = &quot;Times New Roman&quot;, face = &quot;italic&quot;, color = &quot;green&quot;, hjust = -1 , vjust = 0.1 , angle = 90)</code>
<ul>
<li>Nótese que los argumentos en cadenas de caracteres van entre comillas, los numéricos no.</li>
</ul></li>
<li>Si queremos <strong>eleminar un elemento del gráfico</strong> debemos asignarlo a <code>element_blank()</code>.
<ul>
<li>Por ejemplo, <code>theme(axis.title.x = element_blank())</code> elimina el nombre del eje x.</li>
</ul></li>
</ul>
</div>
</div>
<div id="posicion-de-las-leyendas." class="section level3">
<h3><span class="header-section-number">4.9.3</span> Posición de las leyendas.</h3>
<ul>
<li>Una característica grandiosa de <code>ggplot()</code> es que genera automáticamente las leyendas cuando aplicamos un color, relleno o símbolo a un elemento.
<ul>
<li>Ya hemos visto como se cambia el título de la leyenda en <a href="graficos.html#titulo-subtitulo-titulos-de-ejes-vineta">Título, subtítulo, títulos de ejes, viñeta</a></li>
<li>También es posible ajustar el lugar en el que se ubicará el recuadro con la leyenda, aprovechando de ese modo algún área en blanco del gráfico.</li>
<li>Eso lo hacemos modificando el elemento <code>theme(legend.position = &quot;&quot;)</code></li>
<li>Acepta la opciones:</li>
</ul></li>
</ul>
<table>
<thead>
<tr class="header">
<th>Argumento</th>
<th>Efecto</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>none</td>
<td>Elimina la leyenda</td>
</tr>
<tr class="even">
<td>top</td>
<td>Parte superior del gráfico</td>
</tr>
<tr class="odd">
<td>bottom</td>
<td>Parte inferior del gráfico</td>
</tr>
<tr class="even">
<td>left</td>
<td>A la izquierda</td>
</tr>
<tr class="odd">
<td>right</td>
<td>A la derecha</td>
</tr>
<tr class="even">
<td>c(0,0)</td>
<td>Abajo, a la izquierda</td>
</tr>
<tr class="odd">
<td>c(0,1)</td>
<td>Abajo a la derecha</td>
</tr>
<tr class="even">
<td>c(1,1)</td>
<td>Arriba a la izquierda</td>
</tr>
<tr class="odd">
<td>c(1,0)</td>
<td>Arriba a la derecha</td>
</tr>
</tbody>
</table>
<ul>
<li><code>ggplot()</code> hereda los nombres de la leyenda de la variable de agrupamiento. Para cambiarlos se recomienda recodificar esa variable.
<ul>
<li>Asumiendo que es un factor lo hacemos con <code>dplyr::mutate(recode())</code> antes de pasar los datos al gráfico.<a href="#fn22" class="footnote-ref" id="fnref22"><sup>22</sup></a></li>
</ul></li>
</ul>
</div>
</div>
<div id="escalas." class="section level2">
<h2><span class="header-section-number">4.10</span> Escalas.</h2>
<div id="escalas-y-sistemas-de-coordenadas" class="section level3">
<h3><span class="header-section-number">4.10.1</span> Escalas y sistemas de coordenadas</h3>
<ul>
<li>Antes de ver como cambiamos la escala en que se encuentran los datos es conveniente aclarar que son y disipar la confusión entre escalas y coordenadas.</li>
<li>La escala es el sistema numérico con el que se procesan los datos.
<ul>
<li>La escala natural de enteros, por ejemplo, va de cero a <span class="math inline">\(\alpha\)</span> con intervalos iguales de una unidad.</li>
<li>La escala tiene efectos sobre las operaciones aritméticas. No es igual la correlación en x y y que la correlación entre x y el logaritmo de y.</li>
</ul></li>
<li>El sistema de coordenadas es la forma en que proyectamos las series numéricas en el espacio bidimensional del gráfico.
<ul>
<li><code>ggplot()</code> usa por defecto las coordenadas cartesianas en las que hay dos ejes perpendiculares.</li>
<li>Podemos pasar un gráfico de coordenadas cartesianas a polares sin que se afecte la escala.</li>
</ul></li>
</ul>
</div>
<div id="ajuste-manual-de-intervalos-de-escala." class="section level3">
<h3><span class="header-section-number">4.10.2</span> Ajuste manual de intervalos de escala.</h3>
<ul>
<li><code>ggplot()</code> hace un muy buen trabajo identificando la escala de nuestros datos y etiquetando puntos relevantes de la misma para hacer legible el gráfico.
<ul>
<li>Sin embargo en ocasiones puede ser mejor especificar manualmente los intervalos, para marcar determinada información en el gráfico.
<ul>
<li>Por ejemplo marcar la media de una distribución u otro dato relevante.</li>
</ul></li>
<li>Lo hacemos pasando un vector de números al <code>elemento scale_x_continous(breaks= )</code> para el eje x y <code>scale_y_continuos(breaks=)</code> para el eje y.</li>
<li>Ese vector puede ser manual usando la función <code>c()</code>, una secuencia generada con <code>seq()</code> o una mezcla de ambos.</li>
</ul></li>
<li>Aplicaremos intervalos manuales a un gráfico que aún no hemos presentado, el histograma. Es convencional para mostrar la distribución de una variable.</li>
</ul>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb297-1" data-line-number="1">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb297-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span> (AÑO<span class="op">==</span><span class="st">&quot;2015&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ENT<span class="op">!=</span><span class="st">&quot;Nacional&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb297-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>POB_TOT)) <span class="op">+</span><span class="st">        </span><span class="co">#Sólo mapeo a x, ggplot hace la transformación y mapea las frecuencias a y.</span></a>
<a class="sourceLine" id="cb297-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins=</span><span class="dv">100</span>) <span class="op">+</span><span class="st">      </span><span class="co">#Generará 100 barras. Por defecto es 30, pero conviene ajustarlo.</span></a>
<a class="sourceLine" id="cb297-5" data-line-number="5"><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb297-6" data-line-number="6"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Distribución de frecuencia municipios por población&quot;,</span></a>
<a class="sourceLine" id="cb297-7" data-line-number="7"><span class="st">       subtitle=&quot;</span>La mayoría de los municipios están poco poblados<span class="st">&quot;,</span></a>
<a class="sourceLine" id="cb297-8" data-line-number="8"><span class="st">       x= &quot;</span>Población&quot;, </a>
<a class="sourceLine" id="cb297-9" data-line-number="9">       <span class="dt">y=</span> <span class="st">&quot;Número de municipios&quot;</span>, </a>
<a class="sourceLine" id="cb297-10" data-line-number="10">       <span class="dt">caption=</span> <span class="st">&quot;Datos CONAPO 2015&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb297-11" data-line-number="11"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span>                           <span class="co">#Especifico los intervalos de y manualmente  </span></a>
<a class="sourceLine" id="cb297-12" data-line-number="12">                       <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">256</span>, <span class="dv">666</span>, <span class="dv">829</span>, <span class="dv">1000</span>)) <span class="co">#Y les paso un vector de número arbitrarios. </span></a></code></pre></div>
<p><img src="libRo_files/figure-html/histograma-1.png" width="672" /></p>
</div>
<div id="transformacion-de-escalas" class="section level3">
<h3><span class="header-section-number">4.10.3</span> Transformación de escalas</h3>
<ul>
<li><code>ggplot()</code> nos permite cambiar los datos de escala dentro del propio gráfico.
<ul>
<li>El uso más frecuente es pasar de una escala natural a una logarítmica.</li>
<li>Es de gran utilidad cuando estamos graficando o modelando datos en los variables están sesgadas.</li>
</ul></li>
</ul>
<div id="aplicacion-de-escala-logaritmica" class="section level4">
<h4><span class="header-section-number">4.10.3.1</span> Aplicación de escala logarítmica</h4>
<ul>
<li>Una transformación logarítmica pasa los datos a sus potencias, equiparando la distancia entre 1 y 10 a la distancia entre 10 y 1000.
<ul>
<li>El efecto es forzar datos sesgados a una distribución mucho más parecida a una normal.</li>
<li><code>ggplot()</code> expresa adecuadamente la escala como potencias de los números. (ejp: 1e2=100, 1e3=1000)</li>
<li>Para números largos R (y por tanto ggplot) siempre usan notación científica.</li>
</ul></li>
<li>En <code>ggplot()</code> agregamos <code>+ scale_x_log10()</code> o <code>+scale_y_log10()</code> para pasar un eje a logaritmo base 10.</li>
<li>Aplicaremos una transformación logarítmica al histograma de población por municipios.</li>
</ul>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb298-1" data-line-number="1">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb298-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span> (AÑO<span class="op">==</span><span class="st">&quot;2015&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ENT<span class="op">!=</span><span class="st">&quot;Nacional&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb298-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>POB_TOT)) <span class="op">+</span><span class="st">        </span><span class="co">#Sólo mapeo a x, ggplot hace la transformación y mapea las frecuencias a y.</span></a>
<a class="sourceLine" id="cb298-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins=</span><span class="dv">100</span>) <span class="op">+</span><span class="st">      </span><span class="co">#Generará 100 barras. Por defecto es 30, pero conviene ajustarlo.</span></a>
<a class="sourceLine" id="cb298-5" data-line-number="5"><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb298-6" data-line-number="6"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Distribución de frecuencia municipios por logaritmo de población&quot;,</span></a>
<a class="sourceLine" id="cb298-7" data-line-number="7"><span class="st">       subtitle=&quot;</span>La mayoría de los municipios están poco poblados<span class="st">&quot;,</span></a>
<a class="sourceLine" id="cb298-8" data-line-number="8"><span class="st">       x= &quot;</span>Logarítmo de Población&quot;, </a>
<a class="sourceLine" id="cb298-9" data-line-number="9">       <span class="dt">y=</span> <span class="st">&quot;Número de municipios&quot;</span>, </a>
<a class="sourceLine" id="cb298-10" data-line-number="10">       <span class="dt">caption=</span> <span class="st">&quot;Datos CONAPO 2015&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb298-11" data-line-number="11"><span class="st">  </span><span class="kw">scale_x_log10</span>()                <span class="co"># Sólo agrego esta línea y paso la escala de x a logaritmo base 10.</span></a></code></pre></div>
<p><img src="libRo_files/figure-html/histograma_log-1.png" width="672" /></p>
<ul>
<li>También podemos señalar intervalos arbitrarios en una escala transformada, en este caso hacen muy visible el efecto de la transformación logarítmica.</li>
<li>De paso introducimos un nuevo tipo gráfico de la familia del los histogramas la Curva de densidad.
<ul>
<li>Presenta el kernel de densidad (el resultado de la función de densidad) de un distribución.</li>
<li>Enfatiza el carácter continuo de la variable.</li>
<li>Funciona muy bien para visualizar el cambio en la distribución de una variable en dos series de datos.</li>
<li>El eje y señala la probabilidad de un valor de x.</li>
<li>El área total bajo la curva es 1.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb299-1" data-line-number="1">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb299-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span> (AÑO <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1990&quot;</span>, <span class="st">&quot;2015&quot;</span>) <span class="op">&amp;</span><span class="st"> </span>ENT<span class="op">!=</span><span class="st">&quot;Nacional&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb299-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>POB_TOT, <span class="dt">fill=</span>AÑO)) <span class="op">+</span><span class="st">                                   </span><span class="co">#Mapeo x a población, relleno a año. </span></a>
<a class="sourceLine" id="cb299-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">alpha=</span><span class="fl">0.5</span>) <span class="op">+</span><span class="st">                                            </span><span class="co">#Transparencia 50%</span></a>
<a class="sourceLine" id="cb299-5" data-line-number="5"><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb299-6" data-line-number="6"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Curva de densidad de municipios por logaritmo de población&quot;,</span></a>
<a class="sourceLine" id="cb299-7" data-line-number="7"><span class="st">       subtitle=&quot;</span>En <span class="dv">25</span> años aumentó la probabilidad de recidir en un municipio de más <span class="fl">50.000</span> habitantes<span class="st">&quot;,</span></a>
<a class="sourceLine" id="cb299-8" data-line-number="8"><span class="st">       x= expression(log[10]*(población)),                             #expression para subíndice de 10</span></a>
<a class="sourceLine" id="cb299-9" data-line-number="9"><span class="st">       y= &quot;</span>Probabilidad<span class="st">&quot;, </span></a>
<a class="sourceLine" id="cb299-10" data-line-number="10"><span class="st">       caption= &quot;</span>Datos CONAPO <span class="dv">2015</span><span class="st">&quot;, </span></a>
<a class="sourceLine" id="cb299-11" data-line-number="11"><span class="st">       fill=&quot;</span>Año<span class="st">&quot;) +</span></a>
<a class="sourceLine" id="cb299-12" data-line-number="12"><span class="st">  scale_x_log10(breaks=                                                #Defino manualmente los intervalos...</span></a>
<a class="sourceLine" id="cb299-13" data-line-number="13"><span class="st">                  c(100, 200, 300, 400, 1000, 10000, 100000, 1000000), #pasando un vector de números</span></a>
<a class="sourceLine" id="cb299-14" data-line-number="14"><span class="st">                labels= comma) +                                       #Cambio de 1e3 a 1,000</span></a>
<a class="sourceLine" id="cb299-15" data-line-number="15"><span class="st">  theme(axis.text.x = element_text(angle=90))                          #Roto las etiquetas por legibilidad</span></a></code></pre></div>
<p><img src="libRo_files/figure-html/densidad_log_manual-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="sistemas-de-coordenadas." class="section level2">
<h2><span class="header-section-number">4.11</span> Sistemas de coordenadas.</h2>
<ul>
<li>Los sistemas de coordenadas manejan la proyección de los datos al espacio.
<ul>
<li><code>ggpplot()</code> utiliza, por defecto, datos en coordenadas cartesianas.
<ul>
<li>Se trata de una opción muy razonable.</li>
</ul></li>
<li>Pero admite también coordenadas polares.</li>
<li>y a través de extensiones coordenadas ternarias.
<ul>
<li>Que son la única opción para representar tres variables continuas en un espacio bidimensional.
##Coordenadas cartesianas.</li>
</ul></li>
</ul></li>
<li>Simples, efectivas, dos ejes perpendiculares, las diferencias numéricas se presentan como diferencias de distancia.
<ul>
<li>Los seres humanos somos muy buenos visualizando diferencias de distancias.</li>
<li>Con la escala y una regla podemos reconstruir los puntos de datos aún cuando no son explícitos.</li>
</ul></li>
<li>Un gráfico de dispersión es el ejemplo más evidente, es esencialmente un mapa de puntos definidos por dos ejes.</li>
<li>También acepta ejes con variables categóricas, en los que cada categoría es un punto.
<ul>
<li>En este caso no tomamos en consideración la distancia entre los puntos, no hay una escala numérica.</li>
<li>A modo de ejemplo, un gráfico de barras.</li>
</ul></li>
</ul>
<div id="coordenadas-polares." class="section level3">
<h3><span class="header-section-number">4.11.1</span> Coordenadas polares.</h3>
<ul>
<li>Las coordenadas polares parten de un punto y se configuran a partir de ángulo y distancia vs dos distancias en el caso de las cartesianas.
<ul>
<li>Los seres humanos somos bastante malos estimando visualmente diferencias de ángulos.</li>
<li>En general lo que podemos mapear en coordenadas polares lo podemos mapear en coordenadas cartesianas. Entonces…</li>
</ul></li>
</ul>
<div id="grafico-de-pastel." class="section level4">
<h4><span class="header-section-number">4.11.1.1</span> Gráfico de pastel.</h4>
<ul>
<li>El gráfico de pastel es el más frecuente de los gráficos en coordenadas polares.
<ul>
<li>Técnicamente es un gráfico de barras apiladas proyectado a coordenadas polares.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb300-1" data-line-number="1">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb300-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span> (AÑO<span class="op">==</span><span class="st">&quot;2015&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ENT<span class="op">!=</span><span class="st">&quot;Nacional&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb300-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb300-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="st">&quot;&quot;</span>, <span class="dt">fill=</span>GM)) <span class="op">+</span><span class="st">           </span><span class="co">#Mapeo los datos a fill, para que haga sólo 1 columna. </span></a>
<a class="sourceLine" id="cb300-5" data-line-number="5"><span class="st">  </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette=</span><span class="st">&quot;Greys&quot;</span>)  <span class="op">+</span><span class="st">    </span><span class="co">#Cargo una paleta de colores grises. </span></a>
<a class="sourceLine" id="cb300-6" data-line-number="6"><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb300-7" data-line-number="7"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>())    <span class="co">#Elimino la etiqueta de x. </span></a></code></pre></div>
<p><img src="libRo_files/figure-html/barra_apilada-1.png" width="672" /></p>
<ul>
<li>Al que aplicamos coordenadas polares.</li>
</ul>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb301-1" data-line-number="1">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb301-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span> (AÑO<span class="op">==</span><span class="st">&quot;2015&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ENT<span class="op">!=</span><span class="st">&quot;Nacional&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb301-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb301-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="st">&quot;&quot;</span>, <span class="dt">fill=</span>GM)) <span class="op">+</span><span class="st">            </span></a>
<a class="sourceLine" id="cb301-5" data-line-number="5"><span class="st">  </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette=</span><span class="st">&quot;Set1&quot;</span>)  <span class="op">+</span><span class="st">     </span><span class="co">#Cargo una paleta de colores de alto contraste. </span></a>
<a class="sourceLine" id="cb301-6" data-line-number="6"><span class="st">  </span><span class="kw">coord_polar</span>(<span class="dt">theta=</span><span class="st">&quot;y&quot;</span>) <span class="op">+</span><span class="st">                 </span><span class="co">#Paso a coordenadas polares, y controla el ángulo. </span></a>
<a class="sourceLine" id="cb301-7" data-line-number="7"><span class="st">  </span><span class="kw">theme_void</span>()                             <span class="co">#Tema nulo. </span></a></code></pre></div>
<p><img src="libRo_files/figure-html/barra_apilada_polar-1.png" width="672" /></p>
</div>
<div id="grafico-de-lineas-proyectado-a-coordenadas-polares." class="section level4">
<h4><span class="header-section-number">4.11.1.2</span> Gráfico de líneas proyectado a coordenadas polares.</h4>
<ul>
<li>Otro uso de las coordenadas polares se da en los gráficos de radar.
<ul>
<li>Son una proyección polar de un gráfico de línea.</li>
<li>Los gráficos de líneas se utilizan frecuentemente para seguir la evolución en el tiempo de una o más variables.</li>
<li>Son preferibles a los gráficos de radar excepto en dos situaciones:
<ul>
<li>Cuando representamos algún fenómeno cíclico, en el que el final es el comienzo.</li>
<li>Cuando realizamos gráficos con paneles. Podemos entrenar el ojo a una figura geométrica generada por el radar y detectar cambios más intuitivamente.</li>
</ul></li>
</ul></li>
<li>El gráfico de radar usa un tipo especial de coordenadas: <code>coord_radar()</code>. Hace un proyección polar, pero mantiene rectas a las líneas.
<ul>
<li>Son bastante complicados con ggplot ya que los valores por defecto están pensados, acertadamente, para coordenadas cartesianas. Debemos controlar manualmente muchos parámetros.</li>
</ul></li>
</ul>
</div>
<div id="grafico-de-linea-por-grupos." class="section level4">
<h4><span class="header-section-number">4.11.1.3</span> Gráfico de línea por grupos.</h4>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb302-1" data-line-number="1">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb302-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span> (ENT<span class="op">!=</span><span class="st">&quot;Nacional&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb302-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span> (GM<span class="op">!=</span><span class="st">&quot;-&quot;</span>) <span class="op">%&gt;%</span><span class="st">                                   </span><span class="co">#Missing mal codificado en la base. </span></a>
<a class="sourceLine" id="cb302-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ANIO=</span>AÑO) <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb302-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">GM=</span><span class="kw">fct_relevel</span>(</a>
<a class="sourceLine" id="cb302-6" data-line-number="6">    GM, <span class="st">&quot;Muy bajo&quot;</span>, <span class="st">&quot;Bajo&quot;</span>, <span class="st">&quot;Medio&quot;</span>, <span class="st">&quot;Alto&quot;</span>, <span class="st">&quot;Muy alto&quot;</span>) <span class="co">#Reordeno el factor GM.</span></a>
<a class="sourceLine" id="cb302-7" data-line-number="7">    ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb302-8" data-line-number="8"><span class="st">  </span><span class="kw">group_by</span>(GM, ANIO) <span class="op">%&gt;%</span><span class="st">                                 </span><span class="co">#Agrupamiento.</span></a>
<a class="sourceLine" id="cb302-9" data-line-number="9"><span class="st">  </span>tally <span class="op">%&gt;%</span><span class="st">                                              </span><span class="co">#Conteos.</span></a>
<a class="sourceLine" id="cb302-10" data-line-number="10"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>GM, <span class="dt">y=</span>n, <span class="dt">group=</span>ANIO)) <span class="op">+</span><span class="st">                   </span><span class="co">#aes(group=x) para varias líneas en un gráfico. </span></a>
<a class="sourceLine" id="cb302-11" data-line-number="11"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color=</span>ANIO), <span class="dt">size=</span> <span class="fl">1.3</span>) <span class="op">+</span><span class="st">                </span><span class="co">#Mapeado por color y tamaño de línea </span></a>
<a class="sourceLine" id="cb302-12" data-line-number="12"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Variación quinquenal de municipios por GM&quot;</span>,</a>
<a class="sourceLine" id="cb302-13" data-line-number="13">       <span class="dt">subtitle=</span><span class="st">&quot;Las variables demográficas son lentas, posiblemente refleje cambios metodológicos&quot;,</span></a>
<a class="sourceLine" id="cb302-14" data-line-number="14"><span class="st">       caption=&quot;</span>Datos CONAPO <span class="dv">2015</span><span class="st">&quot;, </span></a>
<a class="sourceLine" id="cb302-15" data-line-number="15"><span class="st">       x=&quot;</span>Grado de Marginación&quot;, </a>
<a class="sourceLine" id="cb302-16" data-line-number="16">       <span class="dt">y=</span><span class="st">&quot;Frecuencia&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_minimal</span>()</a></code></pre></div>
<p><img src="libRo_files/figure-html/linea-1.png" width="672" /></p>
</div>
<div id="grafico-de-radar" class="section level4">
<h4><span class="header-section-number">4.11.1.4</span> Gráfico de radar</h4>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb303-1" data-line-number="1"><span class="co">#Crear la función coord_radar() </span></a>
<a class="sourceLine" id="cb303-2" data-line-number="2"><span class="co">#Código cortesía de Erwan Le Pennec</span></a>
<a class="sourceLine" id="cb303-3" data-line-number="3"><span class="co">#http://www.cmap.polytechnique.fr/~lepennec/R/Radar/RadarAndParallelPlots.html</span></a>
<a class="sourceLine" id="cb303-4" data-line-number="4"></a>
<a class="sourceLine" id="cb303-5" data-line-number="5">coord_radar &lt;-<span class="st"> </span><span class="cf">function</span> (<span class="dt">theta =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">start =</span> <span class="dv">0</span>, <span class="dt">direction =</span> <span class="dv">1</span>) </a>
<a class="sourceLine" id="cb303-6" data-line-number="6">{</a>
<a class="sourceLine" id="cb303-7" data-line-number="7">    theta &lt;-<span class="st"> </span><span class="kw">match.arg</span>(theta, <span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>))</a>
<a class="sourceLine" id="cb303-8" data-line-number="8">    r &lt;-<span class="st"> </span><span class="cf">if</span> (theta <span class="op">==</span><span class="st"> &quot;x&quot;</span>) </a>
<a class="sourceLine" id="cb303-9" data-line-number="9">        <span class="st">&quot;y&quot;</span></a>
<a class="sourceLine" id="cb303-10" data-line-number="10">    <span class="cf">else</span> <span class="st">&quot;x&quot;</span></a>
<a class="sourceLine" id="cb303-11" data-line-number="11">    <span class="kw">ggproto</span>(<span class="st">&quot;CordRadar&quot;</span>, CoordPolar, <span class="dt">theta =</span> theta, <span class="dt">r =</span> r, <span class="dt">start =</span> start, </a>
<a class="sourceLine" id="cb303-12" data-line-number="12">        <span class="dt">direction =</span> <span class="kw">sign</span>(direction),</a>
<a class="sourceLine" id="cb303-13" data-line-number="13">        <span class="dt">is_linear =</span> <span class="cf">function</span>(coord) <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb303-14" data-line-number="14">}</a>
<a class="sourceLine" id="cb303-15" data-line-number="15"></a>
<a class="sourceLine" id="cb303-16" data-line-number="16">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb303-17" data-line-number="17"><span class="st">  </span><span class="kw">filter</span> (ENT<span class="op">!=</span><span class="st">&quot;Nacional&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb303-18" data-line-number="18"><span class="st">  </span><span class="kw">filter</span> (GM<span class="op">!=</span><span class="st">&quot;-&quot;</span>) <span class="op">%&gt;%</span><span class="st">            </span></a>
<a class="sourceLine" id="cb303-19" data-line-number="19"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ANIO=</span>AÑO) <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb303-20" data-line-number="20"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">GM=</span><span class="kw">fct_relevel</span>(</a>
<a class="sourceLine" id="cb303-21" data-line-number="21">    GM, <span class="st">&quot;Muy bajo&quot;</span>, <span class="st">&quot;Bajo&quot;</span>, <span class="st">&quot;Medio&quot;</span>, <span class="st">&quot;Alto&quot;</span>, <span class="st">&quot;Muy alto&quot;</span>) </a>
<a class="sourceLine" id="cb303-22" data-line-number="22">    ) <span class="op">%&gt;%</span><span class="st">   </span><span class="kw">group_by</span>(GM, ANIO) <span class="op">%&gt;%</span><span class="st">                                </span></a>
<a class="sourceLine" id="cb303-23" data-line-number="23"><span class="st">  </span>tally <span class="op">%&gt;%</span><span class="st">                                             </span></a>
<a class="sourceLine" id="cb303-24" data-line-number="24"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>GM, <span class="dt">y=</span>n, <span class="dt">group=</span>ANIO)) <span class="op">+</span><span class="st">                  </span></a>
<a class="sourceLine" id="cb303-25" data-line-number="25"><span class="st">  </span><span class="kw">geom_polygon</span>(<span class="kw">aes</span>(<span class="dt">color =</span> ANIO),        <span class="co">#geom_polygon para que cierre las líneas.</span></a>
<a class="sourceLine" id="cb303-26" data-line-number="26">               <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">size =</span> <span class="fl">1.1</span>) <span class="op">+</span><span class="st">  </span><span class="co">#fill=NA para relleno del polígono sea transparente.  </span></a>
<a class="sourceLine" id="cb303-27" data-line-number="27"><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb303-28" data-line-number="28"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.ticks.y =</span> <span class="kw">element_blank</span>(),  <span class="co">#Elimino marcas de ejes</span></a>
<a class="sourceLine" id="cb303-29" data-line-number="29">        <span class="dt">axis.text.y =</span> <span class="kw">element_blank</span>()) <span class="op">+</span><span class="st"> </span><span class="co">#Elimino nombres de ejes. </span></a>
<a class="sourceLine" id="cb303-30" data-line-number="30"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Variación quinquenal de municipios por GM&quot;</span>,</a>
<a class="sourceLine" id="cb303-31" data-line-number="31">       <span class="dt">subtitle=</span><span class="st">&quot;Las variables demográficas son lentas, posiblemente refleje cambios metodológicos&quot;,</span></a>
<a class="sourceLine" id="cb303-32" data-line-number="32"><span class="st">       caption=&quot;</span>Datos CONAPO <span class="dv">2015</span><span class="st">&quot;, </span></a>
<a class="sourceLine" id="cb303-33" data-line-number="33"><span class="st">       x=&quot;&quot;, </span></a>
<a class="sourceLine" id="cb303-34" data-line-number="34"><span class="st">       y=&quot;&quot;) +                           #Elimino etiquetas de ejes</span></a>
<a class="sourceLine" id="cb303-35" data-line-number="35"><span class="st">  coord_radar()                          #Igual a coord_polar, pero con líneas rectas. </span></a></code></pre></div>
<p><img src="libRo_files/figure-html/radar-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="fortificar-nuestros-graficos-con-datos-de-un-modelo" class="section level2">
<h2><span class="header-section-number">4.12</span> Fortificar nuestros gráficos con datos de un modelo</h2>
<ul>
<li>Una forma de hacer más inteligibles a nuestros gráficos es complementarlos con información de un modelo.
<ul>
<li>Que no es lo mismo que hacer un gráfico para presentar los resultados de un modelo.<br />
</li>
</ul></li>
<li>Usos frecuentes:
<ul>
<li>Incorporar una recta o curva de ajuste a un gráfico de dispersión.</li>
<li>Incorporar barras de error a una estimación.</li>
<li>O líneas que señalan la media.</li>
</ul></li>
</ul>
<div id="rectas-de-ajuste" class="section level3">
<h3><span class="header-section-number">4.12.1</span> Rectas de ajuste</h3>
<ul>
<li>El elemento geométrico <code>geom_smooth()</code> de <code>ggplot()</code> gráfica una recta o curva de ajuste, así como el intervalo de confianza al 95%.
<ul>
<li>Obtiene esa información a partir de métodos de ajuste, distintos tipos de modelos.</li>
<li>Los computa automáticamente con la formula <code>y~x</code>, donde y es la variable dependiente y x la independiente.</li>
<li>No es necesario ajustar el modelo previamente, aunque es una buena idea si queremos obtener la ordenada al origen, coeficientes y R<sup>2</sup>.</li>
<li>Por defecto usa el método <code>loess</code> (regresión local) para n chicas y <code>gam</code> (modelo general aditivo) para n grande. Ambos producen curvas.</li>
<li>Podemos especificar un modelo lineal con <code>method=&quot;lm&quot;</code> o uno lineal generalizado con <code>method=&quot;glm&quot;</code>.</li>
</ul></li>
</ul>
<div id="grafico-de-dispersion-con-recta-de-ajuste-e-intervalo-de-confianza" class="section level4">
<h4><span class="header-section-number">4.12.1.1</span> Gráfico de dispersión con recta de ajuste e intervalo de confianza</h4>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb304-1" data-line-number="1">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb304-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span> (AÑO<span class="op">==</span><span class="st">&quot;2015&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ENT<span class="op">!=</span><span class="st">&quot;Nacional&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb304-3" data-line-number="3"><span class="st">  </span>{<span class="kw">print</span>(<span class="kw">summary</span>(<span class="kw">lm</span>(IM<span class="op">~</span><span class="kw">log10</span>(POB_TOT), .)));.}  <span class="op">%&gt;%</span><span class="st">  </span><span class="co">#Pq %T&gt;% no se lleva con + de ggplot. Alternativa: qplot.</span></a>
<a class="sourceLine" id="cb304-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>POB_TOT, <span class="dt">y=</span>IM)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb304-5" data-line-number="5"><span class="st">  </span><span class="kw">scale_x_log10</span>() <span class="op">+</span><span class="st">                              </span><span class="co">#Transformo POB_TOT a log10</span></a>
<a class="sourceLine" id="cb304-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st">                                 </span><span class="co">#Puntos</span></a>
<a class="sourceLine" id="cb304-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>) <span class="op">+</span><span class="st">                     </span><span class="co">#Recta de ajuste modelo lineal</span></a>
<a class="sourceLine" id="cb304-8" data-line-number="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;El Indice de Marginación baja a medida que sube el número de habitantes&quot;</span>, </a>
<a class="sourceLine" id="cb304-9" data-line-number="9">       <span class="dt">x=</span><span class="kw">expression</span>(log[<span class="dv">10</span>]<span class="op">*</span>Población~del<span class="op">~</span>Municipio), </a>
<a class="sourceLine" id="cb304-10" data-line-number="10">       <span class="dt">y=</span> <span class="st">&quot;Índice de marginación&quot;, </span></a>
<a class="sourceLine" id="cb304-11" data-line-number="11"><span class="st">       caption=&quot;</span>Datos CONAPO <span class="dv">2015</span><span class="st">&quot;) +</span></a>
<a class="sourceLine" id="cb304-12" data-line-number="12"><span class="st">  annotate(&quot;</span>text<span class="st">&quot;, x=20e4, y=4,                  #Anotación: elemento y coordenadas. </span></a>
<a class="sourceLine" id="cb304-13" data-line-number="13"><span class="st">           label=&quot;</span>R<span class="op">^</span><span class="dv">2</span><span class="op">==</span><span class="fl">0.15</span><span class="op">~</span>y<span class="op">==</span><span class="fl">2.32</span><span class="op">%.%-</span><span class="fl">0.56</span><span class="op">*</span>x<span class="st">&quot;,  #expression: a bag of hurt</span></a>
<a class="sourceLine" id="cb304-14" data-line-number="14"><span class="st">           parse= TRUE) +                        #Para que expression evalúe la... expresión.</span></a>
<a class="sourceLine" id="cb304-15" data-line-number="15"><span class="st">  theme_bw()</span></a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = IM ~ log10(POB_TOT), data = .)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.1762 -0.6633 -0.1197  0.5352  5.1231 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     2.32455    0.11169   20.81   &lt;2e-16 ***
## log10(POB_TOT) -0.56651    0.02684  -21.11   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.9202 on 2455 degrees of freedom
## Multiple R-squared:  0.1536, Adjusted R-squared:  0.1532 
## F-statistic: 445.4 on 1 and 2455 DF,  p-value: &lt; 2.2e-16</code></pre>
<p><img src="libRo_files/figure-html/dispersion_ajuste_lm-1.png" width="672" /></p>
</div>
<div id="grafico-de-dispersion-con-curva-de-ajuste-gam." class="section level4">
<h4><span class="header-section-number">4.12.1.2</span> Gráfico de dispersión con curva de ajuste GAM.</h4>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb306-1" data-line-number="1">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb306-2" data-line-number="2"><span class="st">    </span><span class="kw">filter</span> (AÑO<span class="op">==</span><span class="st">&quot;2015&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ENT<span class="op">!=</span><span class="st">&quot;Nacional&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb306-3" data-line-number="3"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>ANALF, <span class="dt">y=</span>PO2SM)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb306-4" data-line-number="4"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb306-5" data-line-number="5"><span class="st">    </span><span class="kw">geom_smooth</span>() <span class="op">+</span><span class="st">        </span><span class="co">#Toma por defecto el método GAM</span></a>
<a class="sourceLine" id="cb306-6" data-line-number="6"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Mayor Analfabetismo, Menor Ingreso&quot;</span>,</a>
<a class="sourceLine" id="cb306-7" data-line-number="7">         <span class="dt">subtitle=</span><span class="st">&quot;Hasta el 20% de población analfabeta&quot;</span>,</a>
<a class="sourceLine" id="cb306-8" data-line-number="8">         <span class="dt">x=</span><span class="st">&quot;% Población de 15 años o más analfabeta&quot;</span>, </a>
<a class="sourceLine" id="cb306-9" data-line-number="9">         <span class="dt">y=</span> <span class="st">&quot;% Población ocupada con ingreso de hasta 2 salarios mínimos&quot;</span>, </a>
<a class="sourceLine" id="cb306-10" data-line-number="10">         <span class="dt">caption=</span><span class="st">&quot;Datos CONAPO 2015&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb306-11" data-line-number="11"><span class="st">  </span><span class="kw">theme_minimal</span>()</a></code></pre></div>
<p><img src="libRo_files/figure-html/dispersion_ajuste_gam-1.png" width="672" /></p>
</div>
</div>
<div id="intervalos-de-confianza-y-barras-de-error." class="section level3">
<h3><span class="header-section-number">4.12.2</span> Intervalos de confianza y barras de error.</h3>
<p>Otra forma de fortificar los gráficos es agregar barras de error o intervalos de confianza. En términos del elemento geométrico ambos se expresan del mismo modo, una linea que en su longitud expresa la magnitud del error de medición o el intervalo de confianza un estadístico o coeficiente. Dos líneas perpendiculares más cortas ayudan a la visualización.
Aquello que expresa este elemento geométrico dependerá de los datos expresados en el gráfico o del modelo subyacente. Con <code>ggplot()</code> es necesario estimar primero el error o intervalo de confianza y pasarle luego esos datos a la función. De este modo podemos usar el elemento geométrico con gran flexibilidad.
El <code>geom_smooth()</code> que hemos utilizado genera por defecto una intervalo de error, se trata de del área color gris alrededor de la recta o cuba de ajuste.
Para los gráficos de barras o puntos es necesario agregar un elemento geométrico con las barras de error.</p>
<ul>
<li>La sintaxis básica de <code>geom_errorbar()</code> es: <code>geom_errorbar(aes(x=x, ymin=piso, ymax=techo))</code>, donde <code>piso</code> y <code>techo</code> definen el rango que queremos mostrar.
<ul>
<li>Siempre es necesario pasar los dos valores, mínimo y máximo.</li>
<li>Es posible definir <code>ymin</code> y <code>ymax</code> a través de una función.</li>
<li>Si queremos barras de error horizontales usamos <code>xmin</code> y <code>xmax</code>.</li>
<li>Podemos definir el mapeo de la variable x aquí o heredarla de mapeo <code>aes()</code> que hicimos al abrir la <code>ggplot()</code>.</li>
</ul></li>
</ul>
<div id="grafico-de-barras-con-desviaciones-estandar-e-intervalos-de-confianza." class="section level4">
<h4><span class="header-section-number">4.12.2.1</span> Gráfico de barras con desviaciones estándar e intervalos de confianza.</h4>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb307-1" data-line-number="1">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb307-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(AÑO<span class="op">==</span><span class="st">&quot;2015&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ENT<span class="op">!=</span><span class="st">&quot;Nacional&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb307-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(ENT) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb307-4" data-line-number="4"><span class="st">  </span><span class="kw">summarise</span> (<span class="dt">media=</span><span class="kw">mean</span>(IM),                               <span class="co">#Estimo la media con la función mean()</span></a>
<a class="sourceLine" id="cb307-5" data-line-number="5">             <span class="dt">desvest=</span><span class="kw">sd</span>(IM),                               <span class="co">#Estimo la desviación estándar con sd()</span></a>
<a class="sourceLine" id="cb307-6" data-line-number="6">             <span class="dt">errorest=</span><span class="kw">sd</span>(IM)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">length</span>(IM))) <span class="op">%&gt;%</span><span class="st">         </span><span class="co">#Estimo el error estándar con una función lambda ;-) </span></a>
<a class="sourceLine" id="cb307-7" data-line-number="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>ENT, <span class="dt">y=</span>media)) <span class="op">+</span></a>
<a class="sourceLine" id="cb307-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_col</span> () <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb307-9" data-line-number="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Media del Índice de Marginación por Entidad Federativa en 2015&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb307-10" data-line-number="10"><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb307-11" data-line-number="11"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">90</span>, <span class="dt">hjust=</span><span class="dv">1</span>)) -&gt;<span class="st"> </span>g <span class="co">#Asigno el gráfico base.</span></a>
<a class="sourceLine" id="cb307-12" data-line-number="12"></a>
<a class="sourceLine" id="cb307-13" data-line-number="13"><span class="co">#Con desviaciones estándar.</span></a>
<a class="sourceLine" id="cb307-14" data-line-number="14"><span class="co">#==========================</span></a>
<a class="sourceLine" id="cb307-15" data-line-number="15">g <span class="op">+</span><span class="st"> </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(                              <span class="co">#Hereda x</span></a>
<a class="sourceLine" id="cb307-16" data-line-number="16">                    <span class="dt">ymin=</span>media<span class="op">-</span>desvest,           <span class="co">#Calcula ymin directamente en la llamada.</span></a>
<a class="sourceLine" id="cb307-17" data-line-number="17">                    <span class="dt">ymax=</span>media<span class="op">+</span>desvest)) <span class="op">+</span></a>
<a class="sourceLine" id="cb307-18" data-line-number="18"><span class="st">                    </span><span class="kw">labs</span>(<span class="dt">subtitle=</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Error +-1 &quot;</span><span class="op">*</span>sigma))))</a></code></pre></div>
<p><img src="libRo_files/figure-html/desvio_estandar-1.png" width="672" /></p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb308-1" data-line-number="1"><span class="co">#Con intervalo de confianza al 95% asumiendo normalidad en los datos. </span></a>
<a class="sourceLine" id="cb308-2" data-line-number="2"><span class="co">#====================================================================</span></a>
<a class="sourceLine" id="cb308-3" data-line-number="3">g <span class="op">+</span><span class="st"> </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>media<span class="dv">-2</span><span class="op">*</span>errorest,  <span class="co">#Piso: media menos 2 errores estandar.</span></a>
<a class="sourceLine" id="cb308-4" data-line-number="4">                      <span class="dt">ymax=</span>media<span class="op">+</span><span class="dv">2</span><span class="op">*</span>errorest), <span class="co">#Media más 2 errores estandar. </span></a>
<a class="sourceLine" id="cb308-5" data-line-number="5">                  <span class="dt">width=</span><span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb308-6" data-line-number="6"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle=</span><span class="st">&quot;Intervalos de confianza de la media 95% asumiendo normalidad de los datos&quot;</span>)</a></code></pre></div>
<p><img src="libRo_files/figure-html/desvio_estandar-2.png" width="672" /></p>
</div>
<div id="grafico-de-linea-con-errores-estandar." class="section level4">
<h4><span class="header-section-number">4.12.2.2</span> Gráfico de línea con errores estándar.</h4>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb309-1" data-line-number="1">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb309-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(ENT<span class="op">!=</span><span class="st">&quot;Nacional&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb309-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ANIO=</span>AÑO) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb309-4" data-line-number="4"><span class="st">  </span><span class="kw">group_by</span>(ANIO) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb309-5" data-line-number="5"><span class="st">  </span><span class="kw">summarise</span> (<span class="dt">media=</span><span class="kw">mean</span>(ANALF, <span class="dt">na.rm=</span>T),                         <span class="co">#Excluyo unos missing del año 2000, sino mean() regresa NaN</span></a>
<a class="sourceLine" id="cb309-6" data-line-number="6">             <span class="dt">desvest=</span><span class="kw">sd</span>(ANALF, <span class="dt">na.rm=</span>T),                         <span class="co">#Excluyo unos missing del año 2000, sino sd() regresa NaN</span></a>
<a class="sourceLine" id="cb309-7" data-line-number="7">             <span class="dt">errorest=</span><span class="kw">sd</span>(ANALF, <span class="dt">na.rm=</span>T)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">length</span>(</a>
<a class="sourceLine" id="cb309-8" data-line-number="8">                                                            <span class="kw">complete.cases</span>(ANALF) <span class="co">#complete.cases:  n sin missing. </span></a>
<a class="sourceLine" id="cb309-9" data-line-number="9">                                                            )</a>
<a class="sourceLine" id="cb309-10" data-line-number="10">                                                    )  </a>
<a class="sourceLine" id="cb309-11" data-line-number="11">             ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb309-12" data-line-number="12"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>ANIO, <span class="dt">y=</span>media)) <span class="op">+</span></a>
<a class="sourceLine" id="cb309-13" data-line-number="13"><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>media<span class="dv">-2</span><span class="op">*</span>errorest, <span class="dt">ymax=</span>media<span class="op">+</span><span class="dv">2</span><span class="op">*</span>errorest), <span class="dt">width=</span><span class="fl">0.2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb309-14" data-line-number="14"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group=</span><span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb309-15" data-line-number="15"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Media Nacional de % de población &gt;15 años analfabeta por municipios&quot;</span>, </a>
<a class="sourceLine" id="cb309-16" data-line-number="16">       <span class="dt">subtitle=</span><span class="st">&quot;Baja la media y se reduce el intervalo al 95%&quot;</span>, </a>
<a class="sourceLine" id="cb309-17" data-line-number="17">       <span class="dt">caption=</span><span class="st">&quot;Datos CONAPO 2015&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb309-18" data-line-number="18"><span class="st">  </span><span class="kw">theme_minimal</span>() </a></code></pre></div>
<p><img src="libRo_files/figure-html/linea_error-1.png" width="672" /></p>
</div>
</div>
<div id="etiquetado-de-casos." class="section level3">
<h3><span class="header-section-number">4.12.3</span> Etiquetado de casos.</h3>
<p>Etiquetar los casos puede ayudarnos identificar casos atípicos o visibilizar algunos casos de nuestro interés. De hecho esta librería nos permite utilizar directamente las etiquetas como elemento geométrico y marcar con el texto una posición precisa en el espacio del gráfico. Si queremos más precisión podemos superponer una capa con el elemento geométrico punto.</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb310-1" data-line-number="1">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb310-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span> (AÑO<span class="op">==</span><span class="st">&quot;2015&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ENT <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Baja California&quot;</span>, <span class="st">&quot;Distrito Federal&quot;</span>, <span class="st">&quot;Colima&quot;</span>, <span class="st">&quot;Oaxaca&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb310-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>ANALF, <span class="dt">y=</span>SPRIM)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb310-4" data-line-number="4"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>ENT, <span class="dt">scales=</span><span class="st">&quot;free&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb310-5" data-line-number="5"><span class="st">    </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label=</span>MUN)) <span class="op">+</span><span class="st">    </span><span class="co">#label= es la variable de las que extrae las etiquetas. </span></a>
<a class="sourceLine" id="cb310-6" data-line-number="6"><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">color=</span><span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st">      </span><span class="co">#Agrego un punto rojo para cada municipio.</span></a>
<a class="sourceLine" id="cb310-7" data-line-number="7"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Dispersión de Población Analfabeta y Población sin eduación primaria por municipio en 4 Entidades&quot;</span>, </a>
<a class="sourceLine" id="cb310-8" data-line-number="8">         <span class="dt">subtitle=</span><span class="st">&quot;Tonameca le viene quedando por allá...&quot;</span>,</a>
<a class="sourceLine" id="cb310-9" data-line-number="9">       <span class="dt">caption=</span><span class="st">&quot;Datos CONAPO 2015&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb310-10" data-line-number="10"><span class="st">  </span><span class="kw">theme_minimal</span>()</a></code></pre></div>
<p><img src="libRo_files/figure-html/texto-1.png" width="672" /></p>
<p>En el caso de Baja California las etiquetas son muy útiles, en Colima algo útiles, para el Distrito Federal muy poco y en el de Oaxaca tenemos un problema grave y frecuente en los gráficos con puntos etiquetados: el overplotting o superposición de elementos.
<code>ggplot()</code> no tiene una solución para este problema, pero como es una librería extensible alguien se encargó de crear una extensión que resuelve, en algunos casos, este problema. La librería <code>ggrepel()</code> tiene dos nuevos elementos geométricos, <code>geom_text_repel()</code> y <code>geom_label_repel()</code>, que hacen lo mismo que sus similares de ggplot, excepto que incluyen un algoritmo que desplaza levemente las etiquetas y evita que se superpongan. Puede ayudarnos en casos como el del Distrito Federal, el que hay algo de superposición.</p>
<div id="etiquetado-con-control-de-superposicion" class="section level4">
<h4><span class="header-section-number">4.12.3.1</span> Etiquetado con control de superposición</h4>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb311-1" data-line-number="1"><span class="co">#library(ggrepel)                            #Cargada al inicio.</span></a>
<a class="sourceLine" id="cb311-2" data-line-number="2">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb311-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span> (AÑO<span class="op">==</span><span class="st">&quot;2015&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ENT <span class="op">==</span><span class="st">&quot;Distrito Federal&quot;</span>) <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb311-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>ANALF, <span class="dt">y=</span>SPRIM)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb311-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_text_repel</span>(<span class="kw">aes</span>(<span class="dt">label=</span>MUN), <span class="dt">size=</span><span class="dv">3</span>) <span class="op">+</span><span class="st">  </span><span class="co">#También puedo ajusta el tamaño del texto. </span></a>
<a class="sourceLine" id="cb311-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">color=</span><span class="st">&quot;red&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb311-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Dispersión de Población Analfabeta y Población sin eduación primaria por municipio en Oaxaca&quot;</span>, </a>
<a class="sourceLine" id="cb311-8" data-line-number="8">       <span class="dt">caption=</span><span class="st">&quot;Datos CONAPO 2015&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb311-9" data-line-number="9"><span class="st">  </span><span class="kw">theme_minimal</span>()  </a></code></pre></div>
<p><img src="libRo_files/figure-html/etiquetas_movidas-1.png" width="672" /></p>
<p>¿Servirá también para el caso de Oaxaca?</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb312-1" data-line-number="1"><span class="co"># eval =  por tiempo de compilación.</span></a>
<a class="sourceLine" id="cb312-2" data-line-number="2">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb312-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span> (AÑO<span class="op">==</span><span class="st">&quot;2015&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ENT <span class="op">==</span><span class="st">&quot;Oaxaca&quot;</span>) <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb312-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>ANALF, <span class="dt">y=</span>SPRIM)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb312-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_text_repel</span>(<span class="kw">aes</span>(<span class="dt">label=</span>MUN), <span class="dt">size=</span><span class="dv">3</span>) <span class="op">+</span><span class="st">  </span><span class="co">#También puedo ajusta el tamaño del texto. </span></a>
<a class="sourceLine" id="cb312-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">color=</span><span class="st">&quot;red&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb312-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Dispersión de Población Analfabeta y Población sin eduación primaria por municipio en Oaxaca&quot;</span>, </a>
<a class="sourceLine" id="cb312-8" data-line-number="8">       <span class="dt">caption=</span><span class="st">&quot;Elaborado por Jason Pollock con datos de CONAPO 2015&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb312-9" data-line-number="9"><span class="st">  </span><span class="kw">theme_minimal</span>()  </a></code></pre></div>
<p>No mucho, aunque manipulando los colores podríamos ofrecerlo en <a href="www.kurimanzutto.com/">Kurimanzutto</a> y generar un ingreso extra.</p>
</div>
<div id="etiqueta-selectivo." class="section level4">
<h4><span class="header-section-number">4.12.3.2</span> Etiqueta selectivo.</h4>
<p>Una alternativa es seleccionar sólo algunos casos, cosa que podemos hacer señalando directamente qué observaciones queremos etiquetar o automáticamente a través de una condición.
Este procedimiento no está contemplado en <code>ggplot2</code>, así que requiere de algo de ingenio y bastantes líneas de código. En pocas palabras debemos generar una colunma en un data.frame que incluya los nombres de variables que nos interesan y convierta a los demás en casos perdidos <code>NA</code>. La función <code>ifelse()</code> es de gran ayuda para casos binarios con una sola condición, los que cumplan esa condición mantendrán su valor original, a los que no se les asignará <code>NA</code>.</p>
<p>La sintaxis básica de <code>ifelse ()</code> es:</p>
<blockquote>
<p><code>ifelse(condicion, sí, no)</code></p>
</blockquote>
<p>Donde <strong>condición</strong> es una condición lógica que debe ser evaluada.Por ejemplo <code>edad &gt;= 18</code> regresa <code>TRUE</code> para todas filas en las que la columna edad tiene un valor mayor o igual a 18 y <code>FALSE</code> para todos los demás. Con variables categóricas podemos usar <code>ENT==&quot;Oaxaca&quot;</code> para evaluar igualdad con un sólo valor o <code>ENT %in% c(&quot;Oaxaca&quot;, &quot;Chiapas&quot;)</code> para evaluar pertenecia a un conjunto.<br />
<strong>sí</strong> es el valor que asignaremos cuando se cumple la condición. Puede ser un valor constante que establecemos directamente. Para el caso de la edad podría ser “Mayor de edad” como valor a asignar cuando edad es mayor o igual a 18. También podemos asignar un valor dinámicamente, tomado de una columna de nuestro data.frame. Lo hacemos poniendo el nombre de esa en lugar donde está <code>sí</code> sin utilizar comillas. R se encarga automáticamente de ubicar el valor en la fila correcta.<br />
<strong>no</strong> es el valor que asignaremos cuando no se cumple la condición, es decir, cuando la evaluación de condición nos regresa <code>FALSE</code>.</p>
<p>Tomemos como ejemplo la hipótesis según la cuál llevar el nombre del Benemérito de las Américas tiene un efecto sobre la relación analfabetismo y población sin educación primaria. En México hay varios municipios llamados Benito Juárez, así que los etiquetaremos agregando la Entidad a la que pertenece cada uno. Luego los mostraremos en un gráfico de dispersión de estas dos variables a nivel nacional para 2015.</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb313-1" data-line-number="1">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb313-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span> (AÑO<span class="op">==</span><span class="st">&quot;2015&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ENT<span class="op">!=</span><span class="st">&quot;Nacional&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb313-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">MUNENT=</span><span class="kw">paste</span>(MUN, ENT, <span class="dt">sep=</span><span class="st">&quot; </span><span class="ch">\n</span><span class="st"> &quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#Creo MUNENT que concatena MUN y ENT, separa un salto de línea. Estas serán las etiquetas.  </span></a>
<a class="sourceLine" id="cb313-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span> (<span class="dt">MUNENT=</span><span class="kw">ifelse</span>(MUN<span class="op">==</span><span class="st">&quot;Benito Juárez&quot;</span>, MUNENT, <span class="ot">NA</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#Paso a NA a todos los municipios que NO se llaman BJ usando la sintaxis de ifelse().</span></a>
<a class="sourceLine" id="cb313-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>ANALF, <span class="dt">y=</span>PO2SM,<span class="dt">label=</span>MUNENT)) <span class="op">+</span><span class="st"> </span><span class="co">#Agrego la variable de etiquetado con el argumento label.</span></a>
<a class="sourceLine" id="cb313-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb313-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_smooth</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb313-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_label</span>(<span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span><span class="st">  </span><span class="co">#Agrego etiquetas pequeñas. geom_label agrega un cuadro blanco alrededor del texo. </span></a>
<a class="sourceLine" id="cb313-9" data-line-number="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Los municipios Benito Juárez no son casos atípicos&quot;</span>,</a>
<a class="sourceLine" id="cb313-10" data-line-number="10">       <span class="dt">subtitle=</span><span class="st">&quot;Las capitales quizás&quot;</span>,</a>
<a class="sourceLine" id="cb313-11" data-line-number="11">       <span class="dt">x=</span><span class="st">&quot;% Población de 15 años o más analfabeta&quot;</span>, </a>
<a class="sourceLine" id="cb313-12" data-line-number="12">       <span class="dt">y=</span> <span class="st">&quot;% Población ocupada con ingreso de hasta 2 salarios mínimos&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb313-13" data-line-number="13"><span class="st">  </span><span class="kw">theme_minimal</span>() </a></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;gam&#39;</code></pre>
<pre><code>## Warning: Removed 2450 rows containing missing values (geom_label).</code></pre>
<p><img src="libRo_files/figure-html/dispersion_etiquetas-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="extensiones-a-ggplot2" class="section level2">
<h2><span class="header-section-number">4.13</span> Extensiones a <code>ggplot2::</code></h2>
<p>A partir de la versón 2.0 <code>ggplot2::</code> abrió la posibilidad de extención de la funcionalidad de la librería generando nuevos estándares y métodos. En pocos meses emergieron nuevos librerías con elementos geométricos, transformaciones de datos, paneles, etc. La ventaja de este sistema de extensiones es que los gráficos que producen siguen siendo objetos de ggplot, por lo que podemos modificarlos usando la misma interfaz de ggplot. Por ejemploo, podemos aplicar un estilo visual personalizado, agregar títulos, modificar colores, etc.
Estas extensiones se dividen en dos tipos, las que agregan elementos geométricos, coordenadas o métodos para paneles que podemos agregar gráficos que generamos de la manera usual y flexible de ggplot y aquellos que facilitan generar algún tipo de gráfico especial con una sintaxis simplificada pero menos flexible. Aquí nos enfocaremos en los el primer tipo, aunque incluiremos algunos gráficos especializados muy útiles y complicados de hacer de otro modo.
Dado que el sistema de extensiones es relativamente nuevo y la comunidad open source se caracteriza por la evolución permanente no es posible estar continuamente actualizado en un documento estático como este. Recomiendo visitar el sitio<a href="#fn23" class="footnote-ref" id="fnref23"><sup>23</sup></a>(<a href="https://www.ggplot2-exts.org/" class="uri">https://www.ggplot2-exts.org/</a>) para ver una galería actualizada de extensiones.</p>
</div>
<div id="etiquetas" class="section level2">
<h2><span class="header-section-number">4.14</span> Etiquetas</h2>
<p>Ya hemos visto como funciona ggReppel en la sección <a href="graficos.html#etiquetado-con-control-de-superposicion">Etiquetado con control de superposición</a>. Es una extensión que implementa un algoritmo que impide o minimiza la superposición de etiquetas e implementa dos nuevos objetos geométricos: <code>geom_text_reppel</code> y <code>geom_label_reppel</code>.
La extensión <code>ggpmisc()</code> incluye los <code>stat_peaks()</code> y <code>stat_valley()</code> para identificar y etiquetar valores máximos y mínimos en series de tiempo.</p>
<div id="grafico-de-dispersion-con-histogramas-marginales." class="section level3">
<h3><span class="header-section-number">4.14.1</span> Gráfico de dispersión con histogramas marginales.</h3>
<p>Cuando presentamos un gráfico de dispersión con muchos la superposición puede dificutar la visualización de la densidad de puntos en ciertas áreas del gráfico. Es el mismo problema de la sobreposición, pero en este caso de la sobreposición de puntos. Si en las mismas coordenadas tenemos 100 puntos y en otra 1 la sobreposición hará que visualmente los gráficos sean iguales, cuando su interpretación es muy diferente. Una posibilidad es agregar un histograma en los márgenes del gráfico que representen las frecuencias de esas variables.
El librería <code>ggextra::</code> grafica histogramas, curvas de densidad o gráficos de caja. La sintaxis es algo diferente a la sintaxis básica de <code>ggplot2::</code>. Primero debemos contruir el gráfico de dispersión y asignarle un nombre. Luego pasar ese nombre como primer argumento a la función <code>ggMarginal()</code> y especificar el tipo de gráfico que queremos usar como apoyo, un histograma (type=“histogram”), una curva de densidad (type=“density”) o un gráfico de caja (type=“boxplot”).</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb316-1" data-line-number="1">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb316-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(AÑO<span class="op">==</span><span class="st">&quot;2015&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ENT<span class="op">!=</span><span class="st">&quot;Nacional&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#%$% lm(PO2SM~ANALF) %&gt;% summary()</span></a>
<a class="sourceLine" id="cb316-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span> (<span class="kw">aes</span>(<span class="dt">x=</span>PO2SM, <span class="dt">y=</span>SPRIM)) <span class="op">+</span></a>
<a class="sourceLine" id="cb316-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb316-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb316-6" data-line-number="6"><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb316-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Educación y mercado de trabajo&quot;</span>,</a>
<a class="sourceLine" id="cb316-8" data-line-number="8">       <span class="dt">x=</span><span class="st">&quot;% Población ocupada con ingreso de hasta 2 salarios mínimos&quot;</span>, </a>
<a class="sourceLine" id="cb316-9" data-line-number="9">       <span class="dt">y=</span><span class="st">&quot;% Población de 15 años o más sin primaria completa&quot;</span>,</a>
<a class="sourceLine" id="cb316-10" data-line-number="10">       <span class="dt">caption=</span><span class="st">&quot;Datos CONAPO 2015&quot;</span>) -&gt;<span class="st"> </span>g</a>
<a class="sourceLine" id="cb316-11" data-line-number="11"><span class="kw">ggMarginal</span>(g, <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;histogram&quot;</span>))</a></code></pre></div>
<p><img src="libRo_files/figure-html/disperci%C3%B3n_histograma_marginal-1.png" width="672" /></p>
<p>##Extensiones mágicas.</p>
</div>
<div id="graficos-de-proporciones-jerarquicas." class="section level3">
<h3><span class="header-section-number">4.14.2</span> Gráficos de proporciones jerárquicas.</h3>
<p>Con frecuencia la información que nos interesa se encuentra en un orden jerárquico: tenemos contenedores más amplios y luego información agregada. Para dar cuenta simultaneamente de estas dos dimensiones de la información son útiles los gráfico mapas de áboles jerárquicos o treemaps. El núcleo de estos gráficos es el algoritmo que distribuye a cada recuadro en el espacio y la función <code>treemapify()</code> del paquete homónimo implementa uno excelente que produce un data.frame con toda la información necesaria. La función <code>ggplotify()</code> del mismo paquete luego produce el gráfico con una sintaxis muy simple. Simplemente le pasamos el output de <code>treemapify()</code> y ajustamos algunos parámetros como el tamaño y de observaciones y de grupos. Como el objeto que produce es la clase “ggplot” luego podemos seguir ajustándolo con parámetros adicionales de esta librería como títulos, paletas de colores, etc.</p>
<p>La sintaxis básica de <code>treemapify()</code> es:</p>
<blockquote>
<p>treemapify(data=“”, area=“”, fill=“”, group=“”, label=“”)</p>
</blockquote>
<p>Dado el gran número de parámetros es conveniente ubicarlos después del sigmo <code>=</code> para evitar confusiones.</p>
<p>Dónde <code>data</code> es un data.frame con los datos en bruto. Todas las columnas o variables siguientes deben pertenecer a este data.frame y debemos introducirlas entre comillas.
<code>area</code> es una variable numérica que mapeará los tamaños de los rectángulos. A mayor valor de esta variable mayor tamaño del rectángulo.
<code>fill</code> es una variable numérica o categórica que controlará el color de los rectángulos.
<code>group</code> es una variable categórica que controla el agrupamiento, es decir, la jerarquía de los datos.
<code>label</code> es una variable con las etiquetas (opcional, sólo útil en gráficos con pocos datos)</p>
<p>En el siguiente ejemplo visualizaremos el la población de cada municipio en México en 2015, agrupadas por Entidad Federativa y coloreadas por Grado de Marginación. No incluiremos etiquetas para los ya que para 2457 municipios serán ilegibles y ajustaremos varios parámetros para hacer mejorar la calidad de la salida gráfica.</p>
<div id="treemap" class="section level4">
<h4><span class="header-section-number">4.14.2.1</span> Treemap</h4>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb317-1" data-line-number="1">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb317-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(AÑO<span class="op">==</span><span class="st">&quot;2015&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ENT<span class="op">!=</span><span class="st">&quot;Nacional&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb317-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ENT=</span><span class="kw">str_wrap</span>(ENT, <span class="dv">15</span>)) <span class="op">%&gt;%</span><span class="st">               </span><span class="co">#Agrego saltos de líneas a las etiquetas de grupo.</span></a>
<a class="sourceLine" id="cb317-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ENT=</span><span class="kw">as.factor</span>(ENT)) <span class="op">%&gt;%</span><span class="st">              </span><span class="co">#treemapify no convierte cadenas a factores automáticamente</span></a>
<a class="sourceLine" id="cb317-5" data-line-number="5"><span class="st">  </span><span class="kw">treemapify</span>(                                 <span class="co">#Abro la función </span></a>
<a class="sourceLine" id="cb317-6" data-line-number="6">             <span class="dt">area=</span><span class="st">&quot;POB_TOT&quot;</span>,                  <span class="co">#Mapeo área a población total del municipio </span></a>
<a class="sourceLine" id="cb317-7" data-line-number="7">             <span class="dt">subgroup2=</span><span class="st">&quot;GM&quot;</span>,                       <span class="co">#Los colores al grado de marginación</span></a>
<a class="sourceLine" id="cb317-8" data-line-number="8">             <span class="dt">subgroup =</span><span class="st">&quot;ENT&quot;</span>                      <span class="co">#Agrupados por entidad federativa</span></a>
<a class="sourceLine" id="cb317-9" data-line-number="9">             ) <span class="op">%&gt;%</span><span class="st">                            </span><span class="co">#Paso el data.frame resultante a ggplotify</span></a>
<a class="sourceLine" id="cb317-10" data-line-number="10"><span class="st">  </span><span class="kw">ggplotify</span>(                                  <span class="co">#Abro la función</span></a>
<a class="sourceLine" id="cb317-11" data-line-number="11">            <span class="dt">group.label.colour =</span> <span class="st">&quot;black&quot;</span>,     <span class="co">#Etiquetas ede grupo negras</span></a>
<a class="sourceLine" id="cb317-12" data-line-number="12">            <span class="dt">group.label.size.fixed =</span> <span class="dv">4</span>) <span class="op">+</span><span class="st">     </span><span class="co">#Tamaño fijo 4 pts. Por defecto proporcional al tamaño de grupo. </span></a>
<a class="sourceLine" id="cb317-13" data-line-number="13"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(                 <span class="co">#Controlo manualmente los colores.</span></a>
<a class="sourceLine" id="cb317-14" data-line-number="14">    <span class="st">&quot;green4&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;red4&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="co">#Paleta &quot;semáforo&quot;.</span></a>
<a class="sourceLine" id="cb317-15" data-line-number="15"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="op">+</span><span class="st">            </span><span class="co">#Ubico la leyenda abajo. </span></a>
<a class="sourceLine" id="cb317-16" data-line-number="16"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Distribución de población en Municipios y Estados según grado de marginación&quot;, </span></a>
<a class="sourceLine" id="cb317-17" data-line-number="17"><span class="st">       caption=&quot;</span>Datos CONAPO <span class="dv">2015</span><span class="st">&quot;)</span></a></code></pre></div>
</div>
</div>
<div id="im-feeling-lucky" class="section level3">
<h3><span class="header-section-number">4.14.3</span> I’m feeling lucky…</h3>
<p>En la práctica del análisis exploratorio puede valer la pena dejar nuestro CPU adivine el gráfico que necesitamos y haga los ajustes para obtener un resultado decente. <code>plotluck()</code> requiere una especificación un poco más precisa (usa notación de formulas), tiene algunos problemas con las escalas de los ejes y límites a la cantidad de objetos que se pueden graficar. Además dificilmente podamos ajustarlos a los requisitos de una publicación, en ese caso lo mejor es empezar desde el principio con ggplot y crear un gráfico a medida. Sin embargo produce gráficos modernos muy prácticos para la exploración y todo con una sintaxis muy corta y clara.</p>
<p>Sintaxis de fórmulas para plotluck()</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb318-1" data-line-number="1"><span class="kw">tribble</span>(</a>
<a class="sourceLine" id="cb318-2" data-line-number="2">  <span class="op">~</span>Formula        , <span class="op">~</span>Significado                     , <span class="op">~</span><span class="st">`</span><span class="dt">Tipos de gráficos según el tipo de variables</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb318-3" data-line-number="3"><span class="st">&quot;y~1&quot;</span>             ,<span class="st">&quot;Distribución de una variable&quot;</span>  ,<span class="st">&quot;Densidad, histograma, dispersión, barras, otros&quot;</span>,</a>
<a class="sourceLine" id="cb318-4" data-line-number="4"><span class="st">&quot;y~x&quot;</span>             ,<span class="st">&quot;Una variable independiente&quot;</span>    ,<span class="st">&quot;Dispersión, hexágonos, violín, boxplot, otros&quot;</span>,</a>
<a class="sourceLine" id="cb318-5" data-line-number="5"><span class="st">&quot;y~x+z&quot;</span>         ,<span class="st">&quot;Dos variables independientes&quot;</span>  ,<span class="st">&quot;Mosaico&quot;</span>,</a>
<a class="sourceLine" id="cb318-6" data-line-number="6"><span class="st">&quot;y~|z o y~x|z&quot;</span> ,<span class="st">&quot;Una variable condicional&quot;</span>      ,<span class="st">&quot;Los anteriores con colores o paneles&quot;</span>,</a>
<a class="sourceLine" id="cb318-7" data-line-number="7"><span class="st">&quot;y~1|x+z&quot;</span>       ,<span class="st">&quot;Dos variables condicionales&quot;</span>   ,<span class="st">&quot;Con paneles&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable</span>(., <span class="dt">caption=</span><span class="st">&quot;Sintaxis de formulas en R&quot;</span>)</a></code></pre></div>
<table>
<caption><span id="tab:plotluck">Table 4.1: </span>Sintaxis de formulas en R</caption>
<thead>
<tr class="header">
<th align="left">Formula</th>
<th align="left">Significado</th>
<th align="left">Tipos de gráficos según el tipo de variables</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">y~1</td>
<td align="left">Distribución de una variable</td>
<td align="left">Densidad, histograma, dispersión, barras, otros</td>
</tr>
<tr class="even">
<td align="left">y~x</td>
<td align="left">Una variable independiente</td>
<td align="left">Dispersión, hexágonos, violín, boxplot, otros</td>
</tr>
<tr class="odd">
<td align="left">y~x+z</td>
<td align="left">Dos variables independientes</td>
<td align="left">Mosaico</td>
</tr>
<tr class="even">
<td align="left">y~|z o y~x|z</td>
<td align="left">Una variable condicional</td>
<td align="left">Los anteriores con colores o paneles</td>
</tr>
<tr class="odd">
<td align="left">y~1|x+z</td>
<td align="left">Dos variables condicionales</td>
<td align="left">Con paneles</td>
</tr>
</tbody>
</table>
<p>Donde reemplazamos y, x o z por nombres de columna de un data.frame que pasamos como primer argumento a la función o que pasamos directamente con <code>%&gt;%</code>. El argumento <code>weigths=</code> acepta una columan numérica que funciona como un ponderador. En nuestra base de datos es de gran utilidad para hacer conteos por población en lugar de hacerlos por número de municipios.</p>
<p>Algunos ejemplos en serie:</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb319-1" data-line-number="1">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb319-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(AÑO<span class="op">==</span><span class="st">&quot;2015&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ENT <span class="op">!=</span><span class="st">&quot;Nacional&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb319-3" data-line-number="3"><span class="st">  </span><span class="kw">plotluck</span>(GM<span class="op">~</span>ENT) <span class="co">#Nro de municipios por grado de marginación por por Entidades.</span></a></code></pre></div>
<pre><code>## Factor variable ENT has too many levels (32), truncating to 30</code></pre>
<p><img src="libRo_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb321-1" data-line-number="1">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb321-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(AÑO<span class="op">==</span><span class="st">&quot;2015&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ENT <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Oaxaca&quot;</span>, <span class="st">&quot;Nuevo León&quot;, &quot;</span>Tamaulipas<span class="st">&quot;, &quot;</span>Campeche<span class="st">&quot;, &quot;</span>Tlaxcala<span class="st">&quot;)) %&gt;% </span></a>
<a class="sourceLine" id="cb321-3" data-line-number="3"><span class="st">  plotluck(GM~ENT, weights=POB_TOT) #Población en municipios por GM. Mosaico pq son menos categorías. </span></a></code></pre></div>
<p><img src="libRo_files/figure-html/unnamed-chunk-51-2.png" width="672" /></p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb322-1" data-line-number="1">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb322-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(AÑO<span class="op">==</span><span class="st">&quot;2015&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ENT <span class="op">!=</span><span class="st">&quot;Nacional&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb322-3" data-line-number="3"><span class="st">  </span><span class="kw">plotluck</span>(PO2SM<span class="op">~</span>ANALF)   <span class="co">#Dos contínuas: dispersión.</span></a></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;gam&#39;</code></pre>
<p><img src="libRo_files/figure-html/unnamed-chunk-51-3.png" width="672" /></p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb324-1" data-line-number="1">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb324-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(AÑO<span class="op">==</span><span class="st">&quot;2015&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ENT <span class="op">!=</span><span class="st">&quot;Nacional&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb324-3" data-line-number="3"><span class="st">  </span><span class="kw">plotluck</span>(IM<span class="op">~</span>OVSDE<span class="op">+</span>PO2SM) <span class="co">#Tres contínuas: dispersión con código de color y tamaño. </span></a></code></pre></div>
<p><img src="libRo_files/figure-html/unnamed-chunk-51-4.png" width="672" /></p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb325-1" data-line-number="1">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb325-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(AÑO<span class="op">==</span><span class="st">&quot;2015&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ENT <span class="op">!=</span><span class="st">&quot;Nacional&quot;</span>) <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb325-3" data-line-number="3"><span class="st">  </span><span class="kw">plotluck</span>(ANALF<span class="op">~</span>PO2SM<span class="op">|</span>GM) <span class="co">#Relación entre ANALF y PO2SM condicional al grado de marginación. </span></a></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39;</code></pre>
<p><img src="libRo_files/figure-html/unnamed-chunk-51-5.png" width="672" /></p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb327-1" data-line-number="1">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb327-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(AÑO<span class="op">==</span><span class="st">&quot;2015&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ENT <span class="op">!=</span><span class="st">&quot;Nacional&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb327-3" data-line-number="3"><span class="st">  </span><span class="kw">plotluck</span>(ENT<span class="op">~</span><span class="dv">1</span><span class="op">|</span>GM, <span class="dt">weights=</span>POB_TOT) <span class="op">+</span><span class="st">   </span><span class="co">#Población en Municipios por ENT, condicional a GM.</span></a>
<a class="sourceLine" id="cb327-4" data-line-number="4"><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">90</span>))   </a></code></pre></div>
<p><img src="libRo_files/figure-html/unnamed-chunk-51-6.png" width="672" /></p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb328-1" data-line-number="1">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb328-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(AÑO<span class="op">==</span><span class="st">&quot;2015&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ENT <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Chiapas&quot;</span>, <span class="st">&quot;Oaxaca&quot;</span>, <span class="st">&quot;Guerrero&quot;</span>, <span class="st">&quot;Campeche&quot;</span>, <span class="st">&quot;Yucatan&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb328-3" data-line-number="3"><span class="st">  </span><span class="kw">plotluck</span>(ENT<span class="op">~</span><span class="dv">1</span><span class="op">|</span>GM, <span class="dt">weights=</span>POB_TOT) <span class="op">+</span><span class="st">    </span><span class="co">#Población en municipios ENT, condicional a GM. weights=ponderador.</span></a>
<a class="sourceLine" id="cb328-4" data-line-number="4"><span class="st">  </span><span class="kw">labs</span>(                                    <span class="co">#Agregamos elementos con sintaxis de ggplot. </span></a>
<a class="sourceLine" id="cb328-5" data-line-number="5">       <span class="dt">title=</span><span class="st">&quot;Población en Chiapas, Oaxca y Guerrero Municipios por GM&quot;</span>, </a>
<a class="sourceLine" id="cb328-6" data-line-number="6">       <span class="dt">subtitle=</span><span class="st">&quot;Comparar con la tabla más abajo&quot;</span>, </a>
<a class="sourceLine" id="cb328-7" data-line-number="7">       <span class="dt">caption=</span><span class="st">&quot;Datos CONAPO 2015&quot;</span>, </a>
<a class="sourceLine" id="cb328-8" data-line-number="8">       <span class="dt">y=</span><span class="st">&quot;Población Total&quot;</span>,</a>
<a class="sourceLine" id="cb328-9" data-line-number="9">       <span class="dt">x=</span><span class="st">&quot;Entidad Federativa&quot;</span>)</a></code></pre></div>
<p><img src="libRo_files/figure-html/unnamed-chunk-51-7.png" width="672" /></p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb329-1" data-line-number="1">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb329-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(AÑO<span class="op">==</span><span class="st">&quot;2015&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ENT <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Chiapas&quot;</span>, <span class="st">&quot;Oaxaca&quot;</span>, <span class="st">&quot;Guerrero&quot;</span>, <span class="st">&quot;Campeche&quot;</span>, <span class="st">&quot;Yucatan&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb329-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(GM, ENT) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">summarise</span> (<span class="dt">pobla=</span><span class="kw">sum</span>(POB_TOT)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable</span>(.,<span class="dt">caption=</span><span class="st">&quot;Población en Chiapas, Oaxca y Guerrero Municipios por Grado de Marginación&quot;)</span></a></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-51">Table 4.2: </span>Población en Chiapas, Oaxca y Guerrero Municipios por Grado de Marginación</caption>
<thead>
<tr class="header">
<th align="left">GM</th>
<th align="left">ENT</th>
<th align="right">pobla</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Alto</td>
<td align="left">Campeche</td>
<td align="right">121374</td>
</tr>
<tr class="even">
<td align="left">Alto</td>
<td align="left">Chiapas</td>
<td align="right">2149095</td>
</tr>
<tr class="odd">
<td align="left">Alto</td>
<td align="left">Guerrero</td>
<td align="right">979467</td>
</tr>
<tr class="even">
<td align="left">Alto</td>
<td align="left">Oaxaca</td>
<td align="right">1425510</td>
</tr>
<tr class="odd">
<td align="left">Bajo</td>
<td align="left">Chiapas</td>
<td align="right">602851</td>
</tr>
<tr class="even">
<td align="left">Bajo</td>
<td align="left">Guerrero</td>
<td align="right">1373545</td>
</tr>
<tr class="odd">
<td align="left">Bajo</td>
<td align="left">Oaxaca</td>
<td align="right">850783</td>
</tr>
<tr class="even">
<td align="left">Medio</td>
<td align="left">Campeche</td>
<td align="right">247229</td>
</tr>
<tr class="odd">
<td align="left">Medio</td>
<td align="left">Chiapas</td>
<td align="right">540529</td>
</tr>
<tr class="even">
<td align="left">Medio</td>
<td align="left">Guerrero</td>
<td align="right">274687</td>
</tr>
<tr class="odd">
<td align="left">Medio</td>
<td align="left">Oaxaca</td>
<td align="right">536085</td>
</tr>
<tr class="even">
<td align="left">Muy alto</td>
<td align="left">Chiapas</td>
<td align="right">1326723</td>
</tr>
<tr class="odd">
<td align="left">Muy alto</td>
<td align="left">Guerrero</td>
<td align="right">905552</td>
</tr>
<tr class="even">
<td align="left">Muy alto</td>
<td align="left">Oaxaca</td>
<td align="right">646789</td>
</tr>
<tr class="odd">
<td align="left">Muy bajo</td>
<td align="left">Campeche</td>
<td align="right">531328</td>
</tr>
<tr class="even">
<td align="left">Muy bajo</td>
<td align="left">Chiapas</td>
<td align="right">598710</td>
</tr>
<tr class="odd">
<td align="left">Muy bajo</td>
<td align="left">Oaxaca</td>
<td align="right">508722</td>
</tr>
</tbody>
</table>
</div>
<div id="relaciones-multivariadas." class="section level3">
<h3><span class="header-section-number">4.14.4</span> Relaciones multivariadas.</h3>
<div id="grafico-de-pares-generalizado." class="section level4">
<h4><span class="header-section-number">4.14.4.1</span> Gráfico de pares generalizado.</h4>
<p>Dar cuenta de las relaciones entre múltiples variables es un paso fundamental en el análisis multivariado. <code>ggAlly()</code> incluye una función que a la que pasamos múltiples variables y nos regresa una matríz de gráficos con los cruces de múltopes variables. Para cada combinación de variables selecciona el gráficoa adecuado y además incluye estadísticos como el coeficiente de correlación. Aunque podemos cargar un gran número de variables debemos tener en cuenta que la cantidad de paneles aumenta exponencialmente. La misma restricción aplica para las variables categóricas con muchas categorías.</p>
<p>Dada la naturalez exploratoria de estos gráficos es mejor mantener la sintaxis simple. Selecciones con <code>select()</code> las variables cuyas relaciones le interesan y paselas a <code>ggpairs()</code> sin otro argumento. Pase más tiempo viendo los datos y menos tiempo viendo el código.</p>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb330-1" data-line-number="1">base_marginacion <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb330-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(AÑO<span class="op">==</span><span class="st">&quot;2015&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ENT<span class="op">!=</span><span class="st">&quot;Nacional&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb330-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(GM, SPRIM, OVSAE, PO2SM, IM ) <span class="op">%&gt;%</span><span class="st">   </span><span class="co">#Selecciono las variables. </span></a>
<a class="sourceLine" id="cb330-4" data-line-number="4"><span class="st">  </span><span class="kw">ggpairs</span>() <span class="op">+</span><span class="st">                                </span><span class="co">#Toda la magia ocurre aquí!</span></a>
<a class="sourceLine" id="cb330-5" data-line-number="5"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Exploración multivariada del Índice de Marginación&quot;, </span></a>
<a class="sourceLine" id="cb330-6" data-line-number="6"><span class="st">       subtitle=&quot;</span><span class="dv">1</span> línea de código R<span class="st">&quot;, </span></a>
<a class="sourceLine" id="cb330-7" data-line-number="7"><span class="st">       caption=&quot;</span>Datos CONAPO <span class="dv">2015</span><span class="st">&quot;) + </span></a>
<a class="sourceLine" id="cb330-8" data-line-number="8"><span class="st">  theme_bw()</span></a></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="libRo_files/figure-html/parejas-1.png" width="672" /></p>

</div>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="19">
<li id="fn19"><p>En R es el nombre que reciben las variables categóricas<a href="graficos.html#fnref19" class="footnote-back">↩</a></p></li>
<li id="fn20"><p>En Rstudio pruebe seleccionar texto con el mouse mientras sostiene <code>alt</code>. !Sorpresa!<a href="graficos.html#fnref20" class="footnote-back">↩</a></p></li>
<li id="fn21"><p>Lista de colores en [<a href="http://sape.inf.usi.ch/sites/default/files/ggplot2-colour-names.png" class="uri">http://sape.inf.usi.ch/sites/default/files/ggplot2-colour-names.png</a>]<a href="graficos.html#fnref21" class="footnote-back">↩</a></p></li>
<li id="fn22"><p>Dado que lo hacemos dentro de una cadena de dplyr no tiene efectos colaterales, es decir, no modifica los datos en el entorno global. Por lo tanto no afecta otro código que pueda depender de las categorías de esa variable, por ejemplo funciones como <code>filter()</code>, <code>subset()</code> o similares. Por este motivo recomiendo enfáticamente usar <code>dplyr::</code> para manipular datos, el paradigma de programación funcional en el que se basa puede ser más complicado al principio, pero agradeceremos la inmutabilidad de los datos más adelante.<a href="graficos.html#fnref22" class="footnote-back">↩</a></p></li>
<li id="fn23"><p>ggplot2extensions<a href="graficos.html#fnref23" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="manejo.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="analisis-de-datos-categoricos.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["libRo.pdf", "libRo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
